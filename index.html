<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Whiteout Survival Planner</title>
<style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #f1c40f;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #1a2a3a;
            --success-color: #27ae60;
            --info-color: #3498db;
        }
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        body {
            background-color: #f5f5f5;
            color: #333;
            line-height: 1.6;
            font-size: 16px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 10px;
        }
        header {
            background-color: var(--primary-color);
            color: white;
            padding: 15px 0;
            text-align: center;
            margin-bottom: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        header h1 {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }
        header p {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        nav {
            background-color: var(--dark-color);
            border-radius: 8px;
            margin-bottom: 15px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        nav ul {
            display: flex;
            list-style: none;
            justify-content: flex-start;
            flex-wrap: nowrap;
            padding: 5px;
            white-space: nowrap;
        }
        nav ul li {
            padding: 10px 15px;
            position: relative;
            flex-shrink: 0;
        }
        nav ul li a {
            color: white;
            text-decoration: none;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.3s;
            display: flex;
            align-items: center;
        }
        nav ul li a i {
            margin-right: 5px;
            font-size: 1rem;
        }
        nav ul li a:hover {
            color: var(--secondary-color);
        }
        nav ul li.active a {
            color: var(--secondary-color);
        }
        nav ul li.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 25%;
            width: 50%;
            height: 3px;
            background-color: var(--secondary-color);
            border-radius: 3px 3px 0 0;
        }
        .calculator-section {
            background-color: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            display: none;
            animation: fadeIn 0.5s ease;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .calculator-section.active {
            display: block;
        }
        h2 {
            margin-bottom: 15px;
            color: var(--primary-color);
            padding-bottom: 8px;
            border-bottom: 2px solid var(--secondary-color);
            font-size: 1.3rem;
        }
        .calculator-grid {
            display: block;
            margin-bottom: 15px;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: var(--dark-color);
            font-size: 0.95rem;
        }
        select, input {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 0.95rem;
            background-color: #f9f9f9;
            transition: all 0.3s;
        }
        select:focus, input:focus {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 3px rgba(241, 196, 15, 0.2);
        }
        button {
            background-color: var(--secondary-color);
            color: var(--dark-color);
            border: none;
            padding: 12px 20px;
            font-size: 1rem;
            font-weight: 600;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            margin-bottom: 10px;
        }
        button i {
            margin-right: 5px;
        }
        button:hover {
            background-color: #f39c12;
            transform: translateY(-2px);
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.15);
        }
        button:active {
            transform: translateY(0);
        }
        .result {
            margin-top: 20px;
            padding: 15px;
            background-color: #e8f8f5;
            border-radius: 8px;
            display: none;
            border-left: 4px solid var(--success-color);
        }
        .result h3 {
            color: var(--success-color);
            margin-bottom: 10px;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
        }
        .result h3 i {
            margin-right: 8px;
        }
        .result p {
            margin-bottom: 8px;
            font-size: 0.95rem;
        }
        .result span {
            font-weight: 600;
            color: var(--dark-color);
        }
        .requirements-table, .tutorial-section {
            margin-top: 20px;
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        .requirements-table h3, .tutorial-section h3 {
            margin-bottom: 10px;
            color: var(--primary-color);
            font-size: 1.1rem;
            display: flex;
            align-items: center;
        }
        .requirements-table h3 i, .tutorial-section h3 i {
            margin-right: 8px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            min-width: 600px;
            font-size: 0.85rem;
        }
        th, td {
            padding: 8px 10px;
            text-align: center;
            border: 1px solid #ddd;
        }
        th {
            background-color: var(--primary-color);
            color: white;
            font-weight: 600;
        }
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        tr:hover {
            background-color: #eaeaea;
        }
        .note {
            margin-top: 10px;
            font-size: 0.85rem;
            color: #666;
            font-style: italic;
        }
        .coming-soon {
            text-align: center;
            padding: 20px 10px;
        }
        .coming-soon i {
            font-size: 2rem;
            color: var(--secondary-color);
            margin-bottom: 10px;
        }
        .coming-soon h3 {
            font-size: 1.2rem;
            color: var(--primary-color);
            margin-bottom: 10px;
        }
        /* Tooltip styles */
        .tooltip {
            position: relative;
            display: inline-block;
            margin-left: 5px;
            cursor: help;
        }
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 180px;
            background-color: var(--dark-color);
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -90px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.8rem;
            font-weight: normal;
        }
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        .gear-block {
            background-color: #f9f9f9;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 12px;
        }
        select:disabled {
            background-color: #eee;
            color: #888;
            cursor: not-allowed;
        }
        #upgrade-steps table {
            margin-top: 10px;
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
        }
        #upgrade-steps th, #upgrade-steps td {
            padding: 8px;
            text-align: center;
            border: 1px solid #ddd;
        }
        #upgrade-steps th {
            background-color: var(--primary-color);
            color: white;
            font-size: 0.9rem;
        }
        .gear-level-selector {
            display: grid;
    grid-template-columns: 1fr 1fr auto;
    gap: 15px;
    align-items: center;
        }
        .gear-preview {
            text-align: center;
            margin-top: 10px;
        }
        .gear-preview img {
            width: 60px;
            height: 60px;
            object-fit: contain;
            border-radius: 10px;
        }
        .gear-header {
            background-color: var(--primary-color);
            color: white;
            text-align: left;
            padding-left: 10px !important;
            font-size: 0.95rem;
        }
        #calculate-all-gears:disabled {
            opacity: 0.7;
            cursor: not-allowed;
        }
        #upgrade-steps-gears td {
            text-align: center;
            font-size: 0.85rem;
        }
        #upgrade-steps-gears td:empty:before {
            content: '-';
            color: #999;
        }
        #upgrade-steps-gears {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
            font-size: 0.85rem;
        }
        #upgrade-steps-gears th, 
        #upgrade-steps-gears td {
            padding: 8px 10px;
            border: 1px solid #ddd;
            text-align: center;
        }
        #upgrade-steps-gears th {
            background-color: var(--primary-color);
            color: white;
            font-weight: bold;
            font-size: 0.9rem;
        }
        #upgrade-steps-gears .gear-header {
            background-color: var(--dark-color);
            text-align: left;
            padding-left: 10px;
        }
        #upgrade-steps-gears tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        /* --- CHIEF CHARMS STYLES --- */
        .charm-row {
            display: block;
            margin-bottom: 15px;
        }
        .charm-set {
            display: grid;
    grid-template-columns: 1fr 1fr 1fr auto;
    gap: 15px;
    align-items: center;
        }
        .form-group {
            margin-bottom: 12px;
        }
        #charms-result table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
            font-size: 0.85rem;
        }
        #charms-result th,
        #charms-result td {
            padding: 8px 10px;
            text-align: center;
            border: 1px solid #ddd;
        }
        #charms-result th {
            background-color: var(--primary-color);
            color: white;
            font-weight: 600;
            font-size: 0.9rem;
        }
        #charms-result tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        .tutorial-section {
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px dashed #ddd;
        }
        .tutorial-section h4 {
            color: var(--primary-color);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            font-size: 1rem;
        }
        .tutorial-section h4:before {
            content: '';
            display: inline-block;
            width: 6px;
            height: 6px;
            background-color: var(--secondary-color);
            margin-right: 8px;
        }
        .tutorial-section ol, .tutorial-section ul {
            margin-left: 20px;
            margin-bottom: 12px;
        }
        .tutorial-section li {
            margin-bottom: 6px;
            font-size: 0.9rem;
        }
        
        /* Responsive adjustments */
        @media (min-width: 1075px) {
            .container {
                padding: 20px;
            }
            header {
                padding: 20px 0;
            }
            header h1 {
                font-size: 2rem;
            }
            nav ul {
                justify-content: center;
            }
            .calculator-grid {
                display: grid;
                grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                gap: 20px;
            }
            .charm-row {
                display: flex;
                flex-wrap: wrap;
                gap: 15px;
            }
            .charm-set {
                flex: 1;
                min-width: 200px;
            }
            .gear-level-selector {
                display: grid;
                grid-template-columns: 1fr 1fr 80px;
                gap: 10px;
            }
        }
        .map-planner-container {
            background-color: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .map-planner-header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--secondary-color);
        }
        .map-planner-header h2 {
            color: var(--primary-color);
            font-size: 1.5rem;
            margin-bottom: 5px;
        }
        .map-planner-header p {
            color: #666;
            font-size: 0.9rem;
        }
        .map-planner-content {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        @media (min-width: 992px) {
            .map-planner-content {
                flex-direction: row;
            }
        }
        .map-planner-grid-container {
            flex: 1;
            min-width: 0;
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        .map-planner-toolbar {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 10px;
            padding: 10px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        @media (max-width: 768px) {
            .map-planner-toolbar {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        .map-planner-toolbar-btn {
            padding: 12px;
            border: none;
            border-radius: 6px;
            background: linear-gradient(to bottom, #f8f9fa, #e9ecef);
            color: var(--dark-color);
            font-weight: 600;
            cursor: pointer;
            font-size: 0.85rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 6px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            transition: all 0.2s;
            height: 60px;
            text-align: center;
            width: 100%;
        }
        @media (max-width: 768px) {
            .map-planner-toolbar-btn {
                min-width: 0;
            }
        }
        .map-planner-toolbar-btn i {
            font-size: 1rem;
        }
        .map-planner-toolbar-btn:hover {
            background: linear-gradient(to bottom, #e9ecef, #dee2e6);
            transform: translateY(-1px);
            box-shadow: 0 2px 5px rgba(0,0,0,0.15);
        }
        .map-planner-toolbar-btn:active {
            transform: translateY(0);
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        .map-planner-toolbar-btn.active {
            background: linear-gradient(to right, var(--secondary-color), #f39c12);
            color: white;
            box-shadow: 0 0 0 2px rgba(241, 196, 15, 0.3);
        }
        .map-planner-toolbar-btn.primary {
            background: linear-gradient(to right, #3498db, #2980b9);
            color: white;
        }
        .map-planner-toolbar-btn.danger {
            background: linear-gradient(to right, #e74c3c, #c0392b);
            color: white;
        }
        .map-planner-toolbar-btn.success {
            background: linear-gradient(to right, #2ecc71, #27ae60);
            color: white;
        }
        .map-planner-toolbar-btn.secondary {
            background: linear-gradient(to right, #7f8c8d, #95a5a6);
            color: white;
        }
        .map-planner-grid-wrapper {
            position: relative;
            overflow: auto;
            border: 2px solid #34495e;
            border-radius: 8px;
            background-color: #2c3e50;
            height: 400px;
            width: 100%;
            -webkit-overflow-scrolling: touch;
        }
        .map-planner-zoom-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            padding: 10px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .map-planner-zoom-btn {
            padding: 10px 16px;
            background: linear-gradient(to bottom, #f8f9fa, #e9ecef);
            border: 1px solid #ddd;
            color: var(--dark-color);
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 6px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            transition: all 0.2s;
        }
        .map-planner-zoom-btn:hover {
            background: linear-gradient(to bottom, #e9ecef, #dee2e6);
        }
        .map-planner-zoom-btn i {
            font-size: 0.9rem;
        }
        .map-planner-grid-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            background: rgba(0, 0, 0, 0.03);
            border-radius: 8px;
            border: 1px solid #eee;
            padding: 15px;
        }
        .map-planner-grid-info-item {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .map-planner-grid-info-label {
            color: #7f8c8d;
            font-weight: normal;
            font-size: 0.8rem;
            margin-bottom: 3px;
        }
        .map-planner-grid-info-value {
            font-weight: bold;
            color: var(--primary-color);
            font-size: 1rem;
        }
        .map-planner-layout-controls {
            background-color: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .map-planner-layout-buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin: 10px 0;
        }
        .map-planner-selection-info {
            padding: 15px;
            background: rgba(0, 0, 0, 0.03);
            border-radius: 8px;
            border: 1px solid #eee;
            min-height: 120px;
            max-height: 120px;
            overflow-y: auto;
            font-size: 0.9rem;
        }
        .map-planner-notice {
            background-color: #fff3cd;
            color: #856404;
            padding: 10px 15px;
            border-radius: 6px;
            font-size: 0.85rem;
            border-left: 4px solid #ffeeba;
            margin-top: 15px;
        }
        .map-planner-controls {
            width: 100%;
            background-color: white;
            border-radius: 8px;
            padding: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            flex: 0 0 320px;
        }
        @media (min-width: 992px) {
            .map-planner-controls {
                width: 320px;
            }
        }
        .map-planner-grid {
            display: grid;
            background-color: #2c3e50;
            position: relative;
            transform-origin: 0 0;
            transition: transform 0.2s ease;
            --cell-size: 25px;
            margin: 0;
            padding: 0;
        }
        .map-planner-control-group {
            margin-bottom: 15px;
            background: rgba(0,0,0,0.03);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #eee;
        }
        .map-planner-control-group h3 {
            color: var(--primary-color);
            font-size: 1.1rem;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid #eee;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .map-planner-control-group h3 i {
            color: var(--secondary-color);
        }
        .map-planner-form-group {
            margin-bottom: 12px;
        }
        .map-planner-form-group label {
            display: block;
            margin-bottom: 6px;
            font-weight: 600;
            color: var(--dark-color);
            font-size: 0.9rem;
        }
        .map-planner-form-group input[type="number"],
        .map-planner-form-group input[type="text"],
        .map-planner-form-group select {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 0.9rem;
            background-color: #f9f9f9;
            transition: all 0.3s;
        }
        .map-planner-form-group input[type="number"]:focus,
        .map-planner-form-group input[type="text"]:focus,
        .map-planner-form-group select:focus {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 3px rgba(241, 196, 15, 0.2);
        }
        .map-planner-color-options {
            display: flex;
            gap: 8px;
            margin-top: 8px;
            flex-wrap: wrap;
        }
        .map-planner-color-option {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid transparent;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }
        .map-planner-color-option.selected {
            border-color: var(--dark-color);
            transform: scale(1.1);
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        .map-planner-color-option.selected i {
            display: block;
        }
        .map-planner-color-option i {
            display: none;
            font-size: 0.8rem;
        }
        .map-planner-custom-color-container {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 8px;
        }
        .map-planner-custom-color-label {
            white-space: nowrap;
            font-size: 0.9rem;
            font-weight: 600;
        }
        .map-planner-custom-color-input {
            width: 60px;
            height: 28px;
            padding: 0;
            border: 2px solid #ddd;
            border-radius: 6px;
            cursor: pointer;
        }
        .map-planner-multi-select-info {
            margin-top: 8px;
            padding: 8px;
            background-color: #fff8e1;
            border-left: 3px solid var(--secondary-color);
            border-radius: 4px;
            color: var(--dark-color);
            font-size: 0.85rem;
        }
        .map-planner-stats-panel {
            margin-top: 12px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.03);
            border-radius: 8px;
            border: 1px solid #eee;
            font-size: 0.9rem;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
        }
        .map-planner-stats-panel p {
            margin: 0;
            display: flex;
            flex-direction: column;
        }
        .map-planner-stats-panel .label {
            color: #7f8c8d;
            font-weight: normal;
            font-size: 0.8rem;
            margin-bottom: 3px;
        }
        .map-planner-stats-panel span {
            font-weight: bold;
            color: var(--primary-color);
            font-size: 1rem;
        }
        .map-planner-grid-cell {
            background-color: #34495e;
            position: relative;
            border: 1px solid rgba(255,255,255,0.1);
            margin: 0;
            padding: 0;
            transition: background-color 0.2s;
        }
        .map-planner-grid-cell.occupied {
            background-color: rgba(255, 255, 255, 0.05);
        }
        .map-planner-grid-object {
            position: absolute;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            user-select: none;
            border: 1px solid rgba(255,255,255,0.3);
            z-index: 2;
            box-shadow: 0 0 0 1px rgba(0,0,0,0.3), 
                        0 0 0 2px rgba(255,255,255,0.1),
                        inset 0 0 10px rgba(0,0,0,0.2);
            margin: 0;
            padding: 0;
            font-size: 0.8rem;
            transition: all 0.2s;
            cursor: move;
        }
        .map-planner-grid-object.placing {
            pointer-events: none;
            opacity: 0.7;
            z-index: 1;
        }
        .map-planner-grid-object.selected {
            border: 2px solid var(--secondary-color);
            z-index: 3;
            box-shadow: 0 0 0 1px rgba(0,0,0,0.5), 
                        0 0 0 2px rgba(255,255,255,0.2),
                        inset 0 0 15px rgba(0,0,0,0.3);
        }
        .map-planner-grid-object.dragging {
            opacity: 0.9;
            z-index: 4;
            transition: none;
        }
        .map-planner-grid-object.dragging.valid {
            border-color: #27ae60;
        }
        .map-planner-grid-object.dragging.invalid {
            border-color: #e74c3c;
        }
        .map-planner-object-blue { background: #3498db; }
        .map-planner-object-red { background: #e74c3c; }
        .map-planner-object-green { background: #2ecc71; }
        .map-planner-object-purple { background: #9b59b6; }
        .map-planner-object-orange { background: #e67e22; }
        .map-planner-object-custom { background: #3498db; }

        /* Status message styles */
        .map-planner-status {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px 20px;
            border-radius: 5px;
            z-index: 1000;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
        }
        .map-planner-status.show {
            opacity: 1;
        }
         .small-button {
        background-color: var(--secondary-color);
        color: var(--dark-color);
        border: none;
        padding: 8px 12px;
        font-size: 0.85rem;
        font-weight: 600;
        border-radius: 6px;
        cursor: pointer;
        transition: all 0.3s;
        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        display: inline-flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 0;
    }
    .small-button i {
        margin-right: 5px;
        font-size: 0.9rem;
    }
    .small-button:hover {
        background-color: #f39c12;
        transform: translateY(-1px);
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.15);
    }
    .requirements-table {
  display: none;
  margin-top: 20px;
  background-color: #f9f9f9;
  padding: 15px;
  border-radius: 8px;
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
}
  .result {
            background-color: #e8f4fc;
            border-left: 4px solid var(--secondary-color);
            padding: 20px;
            border-radius: 0 8px 8px 0;
            margin-top: 20px;
            display: none;
            /* Improved scrolling for content if needed */
            overflow-x: auto;
        }

        .result.active {
            display: block;
        }

        .result h3 {
            color: var(--primary-color);
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .result p {
            margin-bottom: 8px;
            font-size: 0.95rem;
        }

        .result span {
            font-weight: bold;
            color: var(--dark-color);
        }

        .building-block {
            background-color: #f9f9f9;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 12px;
        }

        .building-block h4 {
            margin-top: 0;
            margin-bottom: 8px;
        }

        .building-level-selector {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            align-items: center;
        }

        .note {
            background-color: #fff3cd;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border-left: 4px solid var(--warning-color);
        }

        .note h4 {
            color: var(--warning-color);
            margin-bottom: 10px;
        }

        footer {
            text-align: center;
            padding: 20px;
            background-color: var(--primary-color);
            color: white;
            border-radius: 8px;
            margin-top: 30px;
        }

        footer a {
            color: var(--secondary-color);
            text-decoration: none;
        }

        footer a:hover {
            text-decoration: underline;
        }

        /* Results Table Styles - Prevent stretching and improve readability */
        .results-table-container {
            /* This container handles the horizontal scrolling */
            overflow-x: auto;
            max-width: 100%;
            margin-top: 15px;
            /* Add a border to make the scrollable area more apparent */
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .results-table {
            width: 100%;
            /* Prevent table from overflowing its container */
            max-width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem; /* Slightly smaller font */
            /* Fixed layout helps control column widths */
            table-layout: auto; /* Changed to auto to allow content-based sizing while still fitting in container */
            min-width: 800px; /* Ensures table has a base width to trigger scrolling if needed */
        }

        .results-table th,
        .results-table td {
            padding: 8px; /* Reduced padding */
            text-align: center;
            border: 1px solid #ddd;
            /* Allow content to wrap within cells */
            word-wrap: break-word;
            white-space: normal; /* Allow text to wrap */
        }

        .results-table th {
            background-color: var(--primary-color);
            color: white;
            /* Make header sticky if inside a scrolling container */
            position: sticky;
            top: 0;
        }

         /* Specific column widths - Adjust as needed */
        .col-building-name { width: 12%; text-align: left; }
        .col-building-prereq { width: 12%; font-size: 0.7rem; color: #7f8c8d; text-align: left; padding-top: 0; padding-bottom: 0; }
        .col-level { width: 8%; }
        .col-meat { width: 10%; }
        .col-wood { width: 10%; }
        .col-coal { width: 10%; }
        .col-iron { width: 10%; }
        .col-fc { width: 10%; }
        .col-refined { width: 10%; }
        .col-time { width: 12%; }
        .col-power { width: 10%; }
        .col-prereq { width: 15%; font-size: 0.75rem; } /* Smaller font for prereq list */


        /* Row styling for Prerequisites vs Selected */
        .results-table tbody tr.prereq-row {
            background-color: var(--prereq-row-bg); /* Light red */
        }

        .results-table tbody tr.selected-row {
            background-color: var(--selected-row-bg); /* Light green */
        }


        /* Responsive adjustments */
        @media (max-width: 768px) {
            .tabs {
                flex-direction: column;
            }

            .tab-button {
                width: 100%;
                margin-bottom: 5px;
            }

            .calculator-grid {
                grid-template-columns: 1fr;
            }

            /* On smaller screens, reduce font size and padding further */
            .results-table {
                font-size: 0.75rem;
            }
            .results-table th,
            .results-table td {
                padding: 6px 4px;
            }
            .col-prereq {
                font-size: 0.7rem;
            }
        }
        /* --- New CSS for Building Calculator Features --- */

/* Style the new construction bonus section */


/* Style the time reduction summary in results */
.time-reduction-summary {
    background-color: #e8f5e9; /* Light green background */
    padding: 10px;
    border-radius: 5px;
    margin-top: 10px;
    border: 1px dashed #4caf50; /* Green dashed border */
    font-size: 0.9rem;
}

.time-reduction-summary p {
    margin: 5px 0;
    display: flex;
    justify-content: space-between;
}

.time-reduction-summary span {
    font-weight: bold;
}

/* Improve table scrollability and row styling */
.results-table-container {
    overflow-x: auto; /* Enable horizontal scrolling */
    max-width: 100%;
    margin-top: 15px;
    border: 1px solid #ddd;
    border-radius: 4px;
    /* Add max-height and vertical scroll if needed for very long tables */
    /* max-height: 400px; */ 
    /* overflow-y: auto; */
}

.results-table {
    width: 100%;
    min-width: 1200px; /* Force table to be wider, triggering horizontal scroll */
    border-collapse: collapse;
    font-size: 0.85rem;
    table-layout: auto; /* Allow columns to size based on content */
}

.results-table th,
.results-table td {
    padding: 8px;
    text-align: center;
    border: 1px solid #ddd;
    word-wrap: break-word;
    white-space: nowrap; /* Prevent text wrapping in cells for better table fit */
}

/* Specific column widths for better control */
.col-building-name { width: 15%; text-align: left; }
.col-building-prereq-flag { width: 8%; font-size: 0.7rem; color: #7f8c8d; text-align: center; padding-top: 0; padding-bottom: 0; }
.col-level { width: 8%; }
.col-meat { width: 10%; }
.col-wood { width: 10%; }
.col-coal { width: 10%; }
.col-iron { width: 10%; }
.col-fc { width: 10%; }
.col-refined { width: 10%; }
.col-time { width: 12%; }
.col-power { width: 10%; }
.col-prereq { width: 15%; font-size: 0.75rem; }

/* Row styling for Prerequisites vs Selected */
.results-table tbody tr.prereq-row {
    background-color: #ffebee; /* Light red */
}

.results-table tbody tr.selected-row {
    background-color: #e8f5e9; /* Light green */
}
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-snowflake"></i> Whiteout Survival Planner</h1>
            <p style="padding: 10px;">Plan and calculate upgrades needed for your hero and base upgrades</p>
        </header>
        <nav>
            <ul>
                <li class="active"><a href="#" data-section="introduction"><i class="fas fa-info"></i> Introduction</a></li>
                <li><a href="#" data-section="hero-shards"><i class="fas fa-star"></i> Hero Shards</a></li>
                <li><a href="#" data-section="chief-gears"><i class="fas fa-cogs"></i> Chief Gears</a></li>
                <li><a href="#" data-section="chief-charms"><i class="fas fa-gem"></i> Chief Charms</a></li>
                <li><a href="#" data-section="troops-train"><i class="fas fa-users"></i> Troop Calculator</a></li>
                <li><a href="#" data-section="building-cost"><i class="fas fa-building"></i>Building Cost Calculator</a></li>
                <li><a href="#" data-section="map-planner"><i class="fas fa-map"></i> Map Planner</a></li>
            </ul>
        </nav>
        <section id="introduction" class="calculator-section active">
    <h2><i class="fas fa-info-circle"></i> Welcome to Whiteout Survival Planner</h2>
    
    <div class="calculator-grid">
        <div>
            <h3 style="color: var(--secondary-color); margin-bottom: 15px;">About This Tool</h3>
            <p>This planner helps you optimize your Whiteout Survival gameplay with four powerful calculators:</p>
            <ol style="margin-left: 20px; margin-bottom: 20px;">
                <li><strong>Hero Shards Calculator</strong> - Plan your hero upgrades</li>
                <li><strong>Chief Gears Calculator</strong> - Track gear upgrade costs</li>
                <li><strong>Chief Charms Calculator</strong> - Manage charm resources</li>
                <li><strong>Troops Calculator</strong> - Calculate resources and time taken for troops</li>
                <li><strong>Map Planner</strong> - Design your base layout</li>
            </ol>
            
            <div style="background-color: #e8f4f8; padding: 10px; border-radius: 10px;">
                <p>Use the navigation bar above to switch between tools. All calculations are performed in real-time!</p>
            </div>
        </div>
        
        <div>
    <h3 style="color: var(--secondary-color); margin-bottom: 15px;">Mobile Users: Use Desktop View</h3>
    <p><strong>Purpose:</strong> Some tools (like the Map Planner) require mouse and keyboard inputs which may not work well on mobile browsers.</p>
    <p><strong>How to use:</strong></p>
    <ol style="margin-left: 20px; margin-bottom: 20px;">
        <li>Tap the <strong>browser menu</strong> (usually three dots in the top/right corner)</li>
        <li>Select <strong>"Request desktop site"</strong> or <strong>"Desktop version"</strong></li>
        <li>Reload the page to load the full desktop version of this planner</li>
    </ol>
    <div style="background-color: #e8f4f8; padding: 10px; border-radius: 10px;">
    <p>
    For best experience, use this planner on desktop or enable "Desktop Site" on mobile.
    </p>
    </div>

</div>
    </div>
    
    
    <div class="tutorial-sec">
        <h3><i class="fas fa-graduation-cap"></i>Tutorials</h3>
        
        <div class="tutorial-section">
            <h4>1. Hero Shards Calculator</h4>
            <p><strong>Purpose:</strong> Calculate exactly how many shards you need to upgrade your heroes.</p>
            <p><strong>How to use:</strong></p>
            <ol>
                <li>Select your hero's current star level and tier</li>
                <li>Choose your target star level and tier</li>
                <li>(Optional) Enter how many shards you already have</li>
                <li>Click "Calculate Required Shards"</li>
            </ol>
            <p>The results will show total shards needed and a detailed breakdown of requirements for each star level.</p>
        </div>
        
        <div class="tutorial-section">
            <h4>2. Chief Gears Calculator</h4>
            <p><strong>Purpose:</strong> Plan resource requirements for upgrading all 6 chief gears.</p>
            <p><strong>How to use:</strong></p>
            <ol>
                <li>For each gear, select current and target levels</li>
                <li>(Optional) Enter your current resources</li>
                <li>Click "Calculate Total Resource Requirements"</li>
            </ol>
            <p>View total materials needed and a step-by-step upgrade path for each gear.</p>
        </div>
        
        <div class="tutorial-section">
            <h4>3. Chief Charms Calculator</h4>
            <p><strong>Purpose:</strong> Track charm upgrades across all gear pieces.</p>
            <p><strong>How to use:</strong></p>
            <ol>
                <li>For each charm slot (3 per gear), set current and target levels</li>
                <li>Click "Calculate Resource Requirements"</li>
            </ol>
            <p>Get totals for Charm Guides, Designs, and Jewel Secrets needed for your upgrades.</p>
        </div>
        
        <div class="tutorial-section">
    <h4>4. Troop Calculator</h4>
    <p><strong>Purpose:</strong> Calculate the resources, time, and training efficiency for your troops.</p>
    <p><strong>How to use:</strong></p>
    <ol>
        <li><strong>Select Troop Type:</strong> Choose Infantry, Lancers, or Marksman.</li>
        <li><strong>Set Troop Tier:</strong> Select the tier of the troop you want to train.</li>
        <li><strong>Enter Quantity:</strong> Input the number of troops you wish to train.</li>
        <li><strong>Adjust Bonuses (Optional):</strong>
            <ul>
                <li>Set Training Time Reduction % (e.g., from skills/officers).</li>
                <li>Specify Additional Speed Bonuses (e.g., Vice President, Minister of Education).</li>
                <li>Enter Speedup Time (in minutes) you plan to use.</li>
            </ul>
        </li>
        <li><strong>Calculate:</strong> Click the "Calculate Training Requirements" button.</li>
    </ol>
    <p><strong>Results:</strong></p>
    <ul>
        <li>View total resources required (Meat, Wood, Coal, Iron, Power).</li>
        <li>See base training time and time with bonuses applied.</li>
        <li>Check how many troops can be trained instantly with your speedups.</li>
        <li>Review the detailed resource table for all troop tiers.</li>
    </ul>
</div>

        <div class="tutorial-section">
            <h4>5. Map Planner</h4>
            <p><strong>Purpose:</strong> Design and optimize your base layout before building in-game.</p>
            <p><strong>How to use:</strong></p>
            <ol>
                <li><strong>Place Objects:</strong> Click to add buildings of any size</li>
                <li><strong>Customize:</strong> Adjust width/height, colors, and labels</li>
                <li><strong>Edit:</strong> Select objects to move/delete them</li>
                <li><strong>Multi-select:</strong> Hold Shift to select multiple objects</li>
                <li><strong>Download:</strong> Save your layout as an image</li>
            </ol>
            <p>Key Features:</p>
            <ul>
                <li>Zoom in/out to see details</li>
                <li>Real-time utilization statistics</li>
                <li>Color-coding for different building types</li>
                <li>Custom grid sizes (up to 1000x1000)</li>
                <li>Save/Load multiple layouts</li>
                <li>Drag & Drop placement with collision detection</li>
            </ul>
        </div>
    </div>
    
    <div class="note" style="background-color: #f8f9fa; padding: 15px; border-radius: 8px;">
        <h4 style="color: var(--primary-color); margin-bottom: 10px;">Need Help?</h4>
        <p>Hover over <i class="fas fa-question-circle" style="color: var(--accent-color);"></i> icons for tooltips. For mobile users, note that multi-selection requires holding Shift (may not work on touch devices).</p>
        <p style="margin-top: 10px; font-weight: bold;">Bookmark this page to save your plans!</p>
    </div>
    <div class="note" style="background-color: #f8f9fa; padding: 15px; border-radius: 8px; margin-top: 20px;">
    <h4 style="color: var(--primary-color); margin-bottom: 10px;">Contact</h4>
    <div style="display: flex; gap: 20px; align-items: center;">
        <div>
            <i class="fas fa-envelope"></i> Email: thepenguinfluffy@gmail.com
        </div>
    </div>
</div>
</section>

        <!-- Hero Shards Calculator -->
        <section id="hero-shards" class="calculator-section">
            <h2><i class="fas fa-star"></i> Hero Shards Calculator</h2>
            <div class="calculator-grid">
                <div>
                    <div class="form-group">
                        <label for="current-star">Current Star Level</label>
                        <select id="current-star">
                            <option value="0">0 Stars</option>
                            <option value="1">1 Star</option>
                            <option value="2">2 Stars</option>
                            <option value="3">3 Stars</option>
                            <option value="4">4 Stars</option>
                            <option value="5">5 Stars (Max)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="current-tier">Current Tier</label>
                        <select id="current-tier">
                            <option value="0">Tier 0</option>
                        </select>
                    </div>
                </div>
                <div>
                    <div class="form-group">
                        <label for="target-star">Target Star Level</label>
                        <select id="target-star">
                            <option value="0">0 Stars</option>
                            <option value="1">1 Star</option>
                            <option value="2">2 Stars</option>
                            <option value="3">3 Stars</option>
                            <option value="4">4 Stars</option>
                            <option value="5" selected>5 Stars (Max)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="target-tier">Target Tier</label>
                        <select id="target-tier">
                            <option value="0">Tier 0</option>
                            <option value="1">Tier 1</option>
                            <option value="2">Tier 2</option>
                            <option value="3">Tier 3</option>
                            <option value="4">Tier 4</option>
                            <option value="5">Tier 5</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="form-group">
                <label for="current-shards">
                    Current Shards Owned (optional)
                    <span class="tooltip">
                        <i class="fas fa-question-circle"></i>
                        <span class="tooltiptext">Enter the number of shards you currently have to calculate how many more you need</span>
                    </span>
                </label>
                <input type="number" id="current-shards" min="0" value="0" placeholder="Enter shards you already have">
            </div>
            <button id="calculate-shards">
                <i class="fas fa-calculator"></i> Calculate Required Shards
            </button>
            <div id="shards-result" class="result">
                <h3><i class="fas fa-clipboard-check"></i> Calculation Results</h3>
                <p>Total Shards Required: <span id="total-shards">0</span></p>
                <p>After Deducting Owned Shards: <span id="final-shards">0</span></p>
            </div>
            <!-- Add this inside the hero-shards section, right after the existing result div -->
<!-- Replace the existing upgrade-steps div with this -->
<div id="upgrade-steps" class="result" style="display: none; overflow-x: scroll;">
    <h3><i class="fas fa-list-ol"></i> Upgrade Steps Breakdown</h3>
    <table id="steps-table" >
        <thead>
            <tr>
                <th>From â†’ To</th>
                <th>Tier 1</th>
                <th>Tier 2</th>
                <th>Tier 3</th>
                <th>Tier 4</th>
                <th>Tier 5</th>
                <th>Promote</th>
                <th>Total</th>
            </tr>
        </thead>
        <tbody id="steps-body">
            <!-- Will be populated by JavaScript -->
        </tbody>
    </table>
</div>

<button onclick="showhide(this)" >
        Show All Requirements
    </button>
            <div class="requirements-table" style="overflow-x: scroll;">
    <h3><i class="fas fa-table"></i> Shard Requirements per Star Level</h3>
    <table>
        <thead>
            <tr>
                <th>Star Transition</th>
                <th>Tier 1</th>
                <th>Tier 2</th>
                <th>Tier 3</th>
                <th>Tier 4</th>
                <th>Tier 5</th>
                <th>Tier 6</th>
                <th>Total per Star</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>0 â†’ 1st Star</td>
                <td>1</td>
                <td>1</td>
                <td>2</td>
                <td>2</td>
                <td>2</td>
                <td>2</td>
                <td>10</td>
            </tr>
            <tr>
                <td>1st â†’ 2nd Star</td>
                <td>5</td>
                <td>5</td>
                <td>5</td>
                <td>5</td>
                <td>5</td>
                <td>15</td>
                <td>40</td>
            </tr>
            <tr>
                <td>2nd â†’ 3rd Star</td>
                <td>15</td>
                <td>15</td>
                <td>15</td>
                <td>15</td>
                <td>15</td>
                <td>40</td>
                <td>115</td>
            </tr>
            <tr>
                <td>3rd â†’ 4th Star</td>
                <td>40</td>
                <td>40</td>
                <td>40</td>
                <td>40</td>
                <td>40</td>
                <td>100</td>
                <td>300</td>
            </tr>
            <tr>
                <td>4th â†’ 5th Star</td>
                <td>100</td>
                <td>100</td>
                <td>100</td>
                <td>100</td>
                <td>100</td>
                <td>100</td>
                <td>600</td>
            </tr>
        </tbody>
    </table>
    <p class="note" style="color: green; font-weight: bold;">Note: Each star has 6 tiers. Completing all 6 tiers advances the hero to the next star level. 5 stars is the maximum level.</p>
    <p class="note" style="color: red; font-weight: bold;">Heroes need some shards to unlock as well and it varies to different heroes. (Example: Jessie needs 40 shards to unlock so her total shards required to max her out will be 1065+40=1105 whereas Jasser requires only 10 shards to unlock so total shards required for him will be 1065+10=1075)</p>
</div>
        </section>

        <!-- Chief Gears Calculator -->
<section id="chief-gears" class="calculator-section" style="overflow-x: hidden;">
    <h2><i class="fas fa-helmet-battle"></i> Chief Gears Calculator</h2>

     <p style="margin-bottom: 10px;">Select current and target levels for each of the 6 gears below:</p>
     <div style="display: flex; gap: 10px; margin-bottom: 15px;">
    <button id="select-all-current-gears" class="small-button">
        <i class="fas fa-check-circle"></i> Set All Current
    </button>
    <button id="select-all-target-gears" class="small-button">
        <i class="fas fa-arrow-circle-up"></i> Set All Target
    </button>
</div>
    <div id="gears-container"></div>

    <!-- Current Resource Inputs -->
    <div class="form-group">
    <label for="owned-alloy">
        Current Hardened Alloy Owned (optional)
        <span class="tooltip">
            <i class="fas fa-question-circle"></i>
            <span class="tooltiptext">Enter the amount of Hardened Alloy you currently have to calculate how much more you need</span>
        </span>
    </label>
    <input type="number" id="owned-alloy" min="0" value="0" placeholder="Enter current alloy">
</div>
<div class="form-group">
    <label for="owned-solution">
        Current Polishing Solution Owned (optional)
        <span class="tooltip">
            <i class="fas fa-question-circle"></i>
            <span class="tooltiptext">Enter the amount of Polishing Solution you currently have to calculate how much more you need</span>
        </span>
    </label>
    <input type="number" id="owned-solution" min="0" value="0" placeholder="Enter current polishing solution">
</div>
<div class="form-group">
    <label for="owned-design">
        Current Design Plans Owned (optional)
        <span class="tooltip">
            <i class="fas fa-question-circle"></i>
            <span class="tooltiptext">Enter the amount of Design Plans you currently have to calculate how much more you need</span>
        </span>
    </label>
    <input type="number" id="owned-design" min="0" value="0" placeholder="Enter current design plans">
</div>
<div class="form-group">
    <label for="owned-amber">
        Current Lunar Amber Owned (optional)
        <span class="tooltip">
            <i class="fas fa-question-circle"></i>
            <span class="tooltiptext">Enter the amount of Lunar Amber you currently have to calculate how much more you need</span>
        </span>
    </label>
    <input type="number" id="owned-amber" min="0" value="0" placeholder="Enter current lunar amber">
</div>

   

    <button id="calculate-all-gears">
        <i class="fas fa-calculator"></i> Calculate Total Resource Requirements
    </button>

    <!-- Result Summary -->
    <div id="gear-result" class="result">
        <h3><i class="fas fa-clipboard-check"></i> Total Resource Requirements</h3>
        <p>Total Hardened Alloy: <span id="alloy-needed">0</span></p>
        <p>Total Polishing Solution: <span id="solution-needed">0</span></p>
        <p>Total Design Plans: <span id="design-needed">0</span></p>
        <p>Total Lunar Amber: <span id="amber-needed">0</span></p>
        <hr />
        <p>After Deducting Owned Resources:</p>
        <p>Hardened Alloy Needed: <span id="final-alloy">0</span></p>
        <p>Polishing Solution Needed: <span id="final-solution">0</span></p>
        <p>Design Plans Needed: <span id="final-design">0</span></p>
        <p>Lunar Amber Needed: <span id="final-amber">0</span></p>
    </div>

   <!-- Upgrade Steps Table -->
<div id="upgrade-steps-gears" style="display: none;">
    <h3><i class="fas fa-list-ol"></i> Gear Upgrade Breakdown</h3>
    <table>
        <thead>
            <tr>
                <th>Gear Name</th>
                <th>From Level</th>
                <th>To Level</th>
                <th>Hardened Alloy</th>
                <th>Polishing Solution</th>
                <th>Design Plans</th>
                <th>Lunar Amber</th>
            </tr>
        </thead>
        <tbody id="steps-body-gears"></tbody>
    </table>
</div>

<button onclick="showhide(this)" style="margin-top: 10px;"> 
        Show All Requirements
    </button>
<div class="requirements-table" style="overflow-x: scroll;">
    <h3><i class="fas fa-table"></i> Gear Upgrade Resource Requirements</h3>
    <table>
        <thead>
            <tr>
                <th>Gear Level</th>
                <th>Hardened Alloy</th>
                <th>Polishing Solution</th>
                <th>Design Plans</th>
                <th>Lunar Amber</th>
            </tr>
        </thead>
        <tbody>
            <tr><td>Green Lvl 0</td><td>1,500</td><td>15</td><td>0</td><td>0</td></tr>
            <tr><td>Green Lvl 1</td><td>3,800</td><td>40</td><td>0</td><td>0</td></tr>
            <tr><td>Blue Lvl 0</td><td>7,000</td><td>70</td><td>0</td><td>0</td></tr>
            <tr><td>Blue Lvl 1</td><td>9,700</td><td>95</td><td>0</td><td>0</td></tr>
            <tr><td>Blue Lvl 2</td><td>0</td><td>0</td><td>45</td><td>0</td></tr>
            <tr><td>Blue Lvl 3</td><td>0</td><td>0</td><td>50</td><td>0</td></tr>
            <tr><td>Purple Lvl 0</td><td>0</td><td>0</td><td>60</td><td>0</td></tr>
            <tr><td>Purple Lvl 1</td><td>0</td><td>0</td><td>70</td><td>0</td></tr>
            <tr><td>Purple Lvl 2</td><td>6,500</td><td>65</td><td>40</td><td>0</td></tr>
            <tr><td>Purple Lvl 3</td><td>8,000</td><td>80</td><td>50</td><td>0</td></tr>
            <tr><td>Purple T1 Lvl 0</td><td>10,000</td><td>95</td><td>60</td><td>0</td></tr>
            <tr><td>Purple T1 Lvl 1</td><td>11,000</td><td>110</td><td>70</td><td>0</td></tr>
            <tr><td>Purple T1 Lvl 2</td><td>13,000</td><td>130</td><td>85</td><td>0</td></tr>
            <tr><td>Purple T1 Lvl 3</td><td>15,000</td><td>160</td><td>100</td><td>0</td></tr>
            <tr><td>Gold Lvl 0</td><td>22,000</td><td>220</td><td>40</td><td>0</td></tr>
            <tr><td>Gold Lvl 1</td><td>23,000</td><td>230</td><td>40</td><td>0</td></tr>
            <tr><td>Gold Lvl 2</td><td>25,000</td><td>250</td><td>45</td><td>0</td></tr>
            <tr><td>Gold Lvl 3</td><td>26,000</td><td>260</td><td>45</td><td>0</td></tr>
            <tr><td>Gold T1 Lvl 0</td><td>28,000</td><td>280</td><td>45</td><td>0</td></tr>
            <tr><td>Gold T1 Lvl 1</td><td>30,000</td><td>300</td><td>55</td><td>0</td></tr>
            <tr><td>Gold T1 Lvl 2</td><td>32,000</td><td>320</td><td>55</td><td>0</td></tr>
            <tr><td>Gold T1 Lvl 3</td><td>35,000</td><td>340</td><td>55</td><td>0</td></tr>
            <tr><td>Gold T2 Lvl 0</td><td>38,000</td><td>390</td><td>55</td><td>0</td></tr>
            <tr><td>Gold T2 Lvl 1</td><td>43,000</td><td>430</td><td>75</td><td>0</td></tr>
            <tr><td>Gold T2 Lvl 2</td><td>45,000</td><td>460</td><td>80</td><td>0</td></tr>
            <tr><td>Gold T2 Lvl 3</td><td>48,000</td><td>500</td><td>85</td><td>0</td></tr>
            <tr><td>Pink Lvl 0</td><td>50,000</td><td>530</td><td>85</td><td>10</td></tr>
            <tr><td>Pink Lvl 1</td><td>52,000</td><td>560</td><td>90</td><td>10</td></tr>
            <tr><td>Pink Lvl 2</td><td>54,000</td><td>590</td><td>95</td><td>10</td></tr>
            <tr><td>Pink Lvl 3</td><td>56,000</td><td>620</td><td>100</td><td>10</td></tr>
            <tr><td>Pink T1 Lvl 0</td><td>59,000</td><td>670</td><td>110</td><td>15</td></tr>
            <tr><td>Pink T1 Lvl 1</td><td>61,000</td><td>700</td><td>115</td><td>15</td></tr>
            <tr><td>Pink T1 Lvl 2</td><td>63,000</td><td>730</td><td>120</td><td>15</td></tr>
            <tr><td>Pink T1 Lvl 3</td><td>65,000</td><td>760</td><td>125</td><td>15</td></tr>
            <tr><td>Pink T2 Lvl 0</td><td>68,000</td><td>810</td><td>135</td><td>20</td></tr>
            <tr><td>Pink T2 Lvl 1</td><td>70,000</td><td>840</td><td>140</td><td>20</td></tr>
            <tr><td>Pink T2 Lvl 2</td><td>72,000</td><td>870</td><td>145</td><td>20</td></tr>
            <tr><td>Pink T2 Lvl 3</td><td>74,000</td><td>900</td><td>150</td><td>20</td></tr>
            <tr><td>Pink T3 Lvl 0</td><td>77,000</td><td>950</td><td>160</td><td>25</td></tr>
            <tr><td>Pink T3 Lvl 1</td><td>80,000</td><td>990</td><td>165</td><td>25</td></tr>
            <tr><td>Pink T3 Lvl 2</td><td>83,000</td><td>1,030</td><td>170</td><td>25</td></tr>
            <tr><td>Pink T3 Lvl 3</td><td>86,000</td><td>1,070</td><td>180</td><td>25</td></tr>
        </tbody>
    </table>
    <p class="note" style="color: green; font-weight: bold;">
        Note: Each gear has multiple levels across different rarities. The resources listed are cumulative per upgrade.
    </p>
</div>

</section>
<!-- Chief Charms Calculator -->
<section id="chief-charms" class="calculator-section" style="overflow-x: hidden;">
    <h2><i class="fas fa-gem"></i> Chief Charms Calculator</h2>


    <p style="margin-bottom: 10px;">Select current and target levels for each of the 6 gears below:</p>

<div style="display: flex; gap: 10px; margin-bottom: 15px;">
    <button id="select-all-current-charms" class="small-button">
        <i class="fas fa-check-circle"></i> Set All Current
    </button>
    <button id="select-all-target-charms" class="small-button">
        <i class="fas fa-arrow-circle-up"></i> Set All Target
    </button>
</div>
    
    <div id="charms-container"></div>
    
    <!-- Current Resource Inputs -->
    <div class="form-group">
        <label for="owned-guides">
            Current Charm Guides Owned (optional)
            <span class="tooltip">
                <i class="fas fa-question-circle"></i>
                <span class="tooltiptext">Enter the number of Charm Guides you currently have to calculate how many more you need</span>
            </span>
        </label>
        <input type="number" id="owned-guides" min="0" value="0" placeholder="Enter current Charm Guides">
    </div>
    <div class="form-group">
        <label for="owned-charm-designs">
            Current Charm Designs Owned (optional)
            <span class="tooltip">
                <i class="fas fa-question-circle"></i>
                <span class="tooltiptext">Enter the number of Charm Designs you currently have to calculate how many more you need</span>
            </span>
        </label>
        <input type="number" id="owned-charm-designs" min="0" value="0" placeholder="Enter current Charm Designs">
    </div>
    <div class="form-group">
        <label for="owned-jewel-secrets">
            Current Jewel Secrets Owned (optional)
            <span class="tooltip">
                <i class="fas fa-question-circle"></i>
                <span class="tooltiptext">Enter the number of Jewel Secrets you currently have to calculate how many more you need</span>
            </span>
        </label>
        <input type="number" id="owned-jewel-secrets" min="0" value="0" placeholder="Enter current Jewel Secrets">
    </div>
    
    <button id="calculate-charms">
        <i class="fas fa-calculator"></i> Calculate Resource Requirements
    </button>
    
    <div id="charms-result" class="result" style="display: none;">
        <h3><i class="fas fa-clipboard-check"></i> Calculation Results</h3>
        <p>Total Charm Guides Needed: <span id="total-guides">0</span></p>
        <p>Total Charm Designs Needed: <span id="total-designs">0</span></p>
        <p>Total Jewel Secrets Needed: <span id="total-secrets">0</span></p>
        <hr>
        <p>After Deducting Owned Resources:</p>
        <p>Charm Guides Needed: <span id="final-guides">0</span></p>
        <p>Charm Designs Needed: <span id="final-designs">0</span></p>
        <p>Jewel Secrets Needed: <span id="final-secrets">0</span></p>
        
        <h3 style="margin-top: 20px;"><i class="fas fa-list-ol"></i> Upgrade Breakdown</h3>
        <div style="overflow-x: auto;">
            <table>
                <thead>
                    <tr>
                        <th>Gear</th>
                        <th>Charm</th>
                        <th>From Level</th>
                        <th>To Level</th>
                        <th>Charm Guides</th>
                        <th>Charm Designs</th>
                        <th>Jewel Secrets</th>
                    </tr>
                </thead>
                <tbody id="steps-body-charms"></tbody>
            </table>
        </div>
    </div>

    <button onclick="showhide(this)" style="margin-top: 10px;">
        Show All Requirements
    </button>
    <div class="requirements-table" style="overflow-x: scroll;">
        <h3><i class="fas fa-table"></i> Charm Upgrade Requirements</h3>
        <table>
            <thead>
                <tr>
                    <th>Charm Level</th>
                    <th>Charm Guides</th>
                    <th>Charm Designs</th>
                    <th>Jewel Secrets</th>
                </tr>
            </thead>
            <tbody>
                <tr><td>Level 1 â†’ 2</td><td>40</td><td>15</td><td>-</td></tr>
                <tr><td>Level 2 â†’ 3</td><td>60</td><td>40</td><td>-</td></tr>
                <tr><td>Level 3 â†’ 4</td><td>80</td><td>100</td><td>-</td></tr>
                <tr><td>Level 4 â†’ 5</td><td>100</td><td>200</td><td>-</td></tr>
                <tr><td>Level 5 â†’ 6</td><td>120</td><td>300</td><td>-</td></tr>
                <tr><td>Level 6 â†’ 7</td><td>140</td><td>400</td><td>-</td></tr>
                <tr><td>Level 7 â†’ 8</td><td>200</td><td>400</td><td>-</td></tr>
                <tr><td>Level 8 â†’ 9</td><td>300</td><td>400</td><td>-</td></tr>
                <tr><td>Level 9 â†’ 10</td><td>420</td><td>420</td><td>-</td></tr>
                <tr><td>Level 10 â†’ 11</td><td>560</td><td>420</td><td>-</td></tr>
                <tr><td>Level 11 â†’ 12</td><td>580</td><td>450</td><td>15</td></tr>
                <tr><td>Level 12 â†’ 13</td><td>580</td><td>450</td><td>30</td></tr>
                <tr><td>Level 13 â†’ 14</td><td>600</td><td>500</td><td>45</td></tr>
                <tr><td>Level 14 â†’ 15</td><td>600</td><td>500</td><td>70</td></tr>
                <tr><td>Level 15 â†’ 16</td><td>650</td><td>550</td><td>100</td></tr>
            </tbody>
        </table>
        <p class="note" style="color: green; font-weight: bold;">
            Note: Jewel Secrets are required only from Level 12 onward. All other upgrades use Charm Guides and Charm Designs.
        </p>
    </div>
</section>

        
<!-- Troops Calculator -->
<section id="troops-train" class="calculator-section">
    <h2><i class="fas fa-users"></i> Troop Calculator</h2>
    
    <div class="calculator-grid">
        <div>
            <div class="form-group">
                <label for="troop-type">Troop Type</label>
                <select id="troop-type">
                    <option value="infantry">Infantry</option>
                    <option value="lancers">Lancers</option>
                    <option value="marksman">Marksman</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="troop-tier">Troop Tier <span class="tooltip">
            <i class="fas fa-question-circle"></i>
            <span class="tooltiptext">The T10 option is for T10 and FC troops. Every calculation will be right, except for the power, since T10 and FC troops take the same amount of resources but give different power</span>
        </span></label>
                <select id="troop-tier">
                    <option value="11">T11</option>
                    <option value="10">T10</option>
                    <option value="9">T9</option>
                    <option value="8">T8</option>
                    <option value="7">T7</option>
                    <option value="6">T6</option>
                    <option value="5">T5</option>
                    <option value="4">T4</option>
                    <option value="3">T3</option>
                    <option value="2">T2</option>
                    <option value="1">T1</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="troop-count">Number of Troops</label>
                <input type="number" id="troop-count" min="1" value="1000">
            </div>
        </div>
        
        <div>
            <div class="form-group">
                <label for="speedups">Speedups Available (minutes)</label>
                <input type="number" id="speedups" min="0" value="0">
            </div>
            
            <div class="form-group">
                <label for="training-bonus">Training Speed Bonus (%)<span class="tooltip">
            <i class="fas fa-question-circle"></i>
            <span class="tooltiptext">Go to your Power -> Scroll down to the Military section -> Training Speed</span>
        </span></label>
                <input type="number" id="training-bonus" min="0" max="500" value="0">
            </div>
            
            <div class="form-group">
                <label>Additional Speed Bonuses</label>
                <div class="checkbox-group">
                    <label><input type="checkbox" id="vice-president" style="width: 20px;"> Vice President (+10%)</label>
                    <label><input type="checkbox" id="minister-education" style="width: 20px;"> Minister of Education (+50%)</label>
                    <label><input type="checkbox" id="mobilize" style="width: 20px;"> Mobilize (+30%) (President's Skill)</label>
                </div>
                <p style="color: red; font-size: small; font-weight: bolder; font-style: italic;">NOTE: If these bonuses are already active in the game then you don't have to check them because they're already included in the Training Speed Bonus (%)</p>
            </div>
        </div>
    </div>
    
    <div id="troops-result" class="result" style="display: block;">
        <h3><i class="fas fa-clipboard-check"></i> Calculation Results</h3>
        
        <div class="calculator-grid">
            <div>
                <h4>Resources Required</h4>
                <p>Meat: <span id="meat-required">0</span></p>
                <p>Wood: <span id="wood-required">0</span></p>
                <p>Coal: <span id="coal-required">0</span></p>
                <p>Iron: <span id="iron-required">0</span></p>
                <p>Total Power: <span id="power-total">0</span></p>
            </div>
            
            <div>
                <h4>Training Times</h4>
                <p>Per Troop: <span id="time-per-troop">0s</span></p>
                <p>Base Total: <span id="base-time-total">0s</span></p>
                <p>With Bonus: <span id="time-with-bonus">0s</span></p>
            </div>
            
            <div>
                <h4>With Speedups (No Bonus)<span class="tooltip">
            <i class="fas fa-question-circle"></i>
            <span class="tooltiptext">How many troops you can train with how many more speedups you will need with no bonus active (for nerds)</span>
        </span></h4>
                <p>Remaining Time: <span id="time-after-speedups-no-bonus">0s</span></p>
                <p>Troops Trainable: <span id="troops-speedups-no-bonus">0</span></p>
            </div>
            
            <div>
                <h4>With Speedups (With Bonus)<span class="tooltip">
            <i class="fas fa-question-circle"></i>
            <span class="tooltiptext">How many troops you can train with how many more speedups you will need</span>
        </span></h4>
                <p>Remaining Time: <span id="time-after-speedups-with-bonus">0s</span></p>
                <p>Troops Trainable: <span id="troops-speedups-with-bonus">0</span></p>
            </div>
        </div>
        
    </div>
    
    <button onclick="showhide(this)" style="margin-top: 10px;">
        Show All Requirements
    </button>
    <div class="requirements-table" style="overflow-x: scroll;">
        <h3><i class="fas fa-table"></i> Troop Statistics by Tier</h3>
        <table>
            <thead>
                <tr>
                    <th>Tier</th>
                    <th>Training Time</th>
                    <th>Meat</th>
                    <th>Wood</th>
                    <th>Coal</th>
                    <th>Iron</th>
                    <th>Power</th>
                </tr>
            </thead>
            <tbody id="troop-stats-table">
                <!-- Will be populated by JavaScript -->
            </tbody>
        </table>
    </div>
</section>


 <!-- Building Cost Calculator Section -->
        <section id="building-cost" class="calculator-section active">
            <h2><i class="fas fa-building"></i> Building Cost Calculator</h2>


                    <div class="form-group">
                        <label for="building-mode">Calculation Mode</label>
                        <select id="building-mode">
                            <option value="with">With Prerequisites</option>
                            <option value="without" selected>Without Prerequisites</option>
                        </select>
                    </div>

                    

                    <div class="form-group">
                        <label>Select Buildings & Target Levels</label>
                        <div id="building-inputs" class="calculator-grid">
                            <!-- Building inputs will be generated here by JavaScript -->
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Owned Resources (Optional)</label>
                        <div class="calculator-grid">
                            <div>
                                <label for="owned-meat">Meat</label>
                                <input type="number" id="owned-meat" min="0" value="0">
                            </div>
                            <div>
                                <label for="owned-wood">Wood</label>
                                <input type="number" id="owned-wood" min="0" value="0">
                            </div>
                            <div>
                                <label for="owned-coal">Coal</label>
                                <input type="number" id="owned-coal" min="0" value="0">
                            </div>
                            <div>
                                <label for="owned-iron">Iron</label>
                                <input type="number" id="owned-iron" min="0" value="0">
                            </div>
                            <div>
                                <label for="owned-fire-crystals">Fire Crystals</label>
                                <input type="number" id="owned-fire-crystals" min="0" value="0">
                            </div>
                            <div>
                                <label for="owned-refined-fire-crystals">Refined Fire Crystals</label>
                                <input type="number" id="owned-refined-fire-crystals" min="0" value="0">
                            </div>
                        </div>
                    </div>

                    <!-- Add this new section inside the calculator-grid div, after the Construction Time Reduction Bonuses section -->
<div class="form-group">
    <label for="building-speedups">Speedups Available (minutes)</label>
    <input type="number" id="building-speedups" min="0" value="0" placeholder="e.g., 120">
</div>

                    <!-- Add this new section inside the calculator-grid div, after the Owned Resources section -->
<div class="form-group">
    <label>Construction Time Reduction Bonuses</label>
    <div class="calculator-grid">
        <div>
        <div>
            <label for="construction-speed">Construction Speed (%)</label>
            <input type="number" id="construction-speed" min="0" value="0" placeholder="e.g., 50">
        </div>
        
        <div>
            <label for="hyena-pet">Hyena Pet Skill (%)</label>
            <select id="hyena-pet">
                <option value="0" selected>None</option>
                <option value="5">5%</option>
                <option value="7">7%</option>
                <option value="9">9%</option>
                <option value="12">12%</option>
                <option value="15">15%</option>
            </select>
        </div>
        </div>
        <div class="checkbox-group">
            <label>Additional Bonuses</label>
                <label></label><input type="checkbox" id="double-time-chief" style="width: 20px; font-weight: bolder;">Double Time Chief (20%)</label>
                <label></label><input type="checkbox" id="vice-president" style="width: 20px; font-weight: bolder;">Vice President (10%)</label>
                <label></label><input type="checkbox" id="mercantilism" style="width: 20px; font-weight: bolder;">Mercantilism (10%)</label>
        </div>
    </div>
</div>
                    <button id="calculate-buildings" class="calculate-btn">
                        <i class="fas fa-calculator"></i> Calculate Total Resource Requirements
                    </button>


                <div style="overflow-x: hidden;">
                    <!-- Result Summary -->
                    <div id="building-result" class="result" >
                        <h3><i class="fas fa-clipboard-check"></i> Total Resource Requirements</h3>
                        <div id="building-resources-summary">
                            <!-- Resources summary will be populated here -->
                        </div>
                        <hr />
                        <h3><i class="fas fa-list-ol"></i> Upgrade Path</h3>
                        <div id="building-upgrade-path" >
                            <!-- Upgrade path details will be populated here -->
                        </div>
                    </div>
                </div>
        </section>

        <!-- Map Planner Section -->
        <section id="map-planner" class="calculator-section">
            <div class="map-planner-container">
                <div class="map-planner-header">
                    <h2><i class="fas fa-map-marked-alt"></i> Base Map Planner</h2>
                    <p>Design and optimize your base layout before building in-game</p>
                </div>
                
                <div class="map-planner-content">
                    <div class="map-planner-grid-container">
                        <div class="map-planner-toolbar">
                            <button class="map-planner-toolbar-btn" id="map-place-btn">
                                <i class="fas fa-plus-circle"></i>
                                <span>Place</span>
                            </button>
                            <button class="map-planner-toolbar-btn" id="map-place-single-btn">
                                <i class="fas fa-plus-square"></i>
                                <span>Single</span>
                            </button>
                            <button class="map-planner-toolbar-btn danger" id="map-delete-btn">
                                <i class="fas fa-trash-alt"></i>
                                <span>Delete</span>
                            </button>
                            <button class="map-planner-toolbar-btn secondary" id="map-clear-btn">
                                <i class="fas fa-broom"></i>
                                <span>Clear</span>
                            </button>
                            <button class="map-planner-toolbar-btn success" id="map-download-btn">
                                <i class="fas fa-download"></i>
                                <span>Export</span>
                            </button>
                            <button class="map-planner-toolbar-btn secondary" id="map-multi-select-btn">
                                <i class="fas fa-object-group"></i>
                                <span>Multi-Select</span>
                            </button>
                        </div>
                        
                        <div class="map-planner-grid-wrapper" id="map-grid-wrapper">
                            <div class="map-planner-grid" id="map-grid"></div>
                        </div>
                        
                        <div class="map-planner-zoom-controls">
                            <button class="map-planner-zoom-btn" id="map-zoom-in-btn">
                                <i class="fas fa-search-plus"></i> Zoom In
                            </button>
                            <button class="map-planner-zoom-btn" id="map-zoom-out-btn">
                                <i class="fas fa-search-minus"></i> Zoom Out
                            </button>
                            <button class="map-planner-zoom-btn" id="map-zoom-reset-btn">
                                <i class="fas fa-search"></i> Reset
                            </button>
                        </div>
                        
                        <div class="map-planner-grid-info">
                            <div class="map-planner-grid-info-item">
                                <span class="map-planner-grid-info-label">Total Objects</span>
                                <span class="map-planner-grid-info-value" id="map-total-objects">0</span>
                            </div>
                            <div class="map-planner-grid-info-item">
                                <span class="map-planner-grid-info-label">Grid Size</span>
                                <span class="map-planner-grid-info-value" id="map-grid-size">26Ã—16</span>
                            </div>
                            <div class="map-planner-grid-info-item">
                                <span class="map-planner-grid-info-label">Utilization</span>
                                <span class="map-planner-grid-info-value" id="map-grid-utilization">0%</span>
                            </div>
                        </div>
                        
                        <div class="map-planner-layout-controls">
                            
                            <div class="map-planner-control-group">
                                <h3><i class="fas fa-border-style"></i> Grid Settings</h3>
                                <div class="map-planner-form-group">
                                    <label for="map-grid-cols"><i class="fas fa-columns"></i> Columns</label>
                                    <input type="number" id="map-grid-cols" min="15" max="1000" value="26">
                                </div>
                                <div class="map-planner-form-group">
                                    <label for="map-grid-rows"><i class="fas fa-stream"></i> Rows</label>
                                    <input type="number" id="map-grid-rows" min="15" max="1000" value="16">
                                </div>
                                <div class="map-planner-layout-buttons">
                                    <button class="map-planner-toolbar-btn primary" id="map-update-grid-btn">
                                        <i class="fas fa-sync-alt"></i> Update Grid
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="map-planner-notice">
                            <i class="fas fa-info-circle"></i> For best experience, use desktop view and enable multi-touch gestures on mobile devices.
                        </div>
                    </div>
                    
                    <div class="map-planner-controls">
                        <div class="map-planner-control-group">
                            <h3><i class="fas fa-cube"></i> Object Settings</h3>
                            <div class="map-planner-form-group">
                                <label for="map-obj-width"><i class="fas fa-arrows-alt-h"></i> Width (cells)</label>
                                <input type="number" id="map-obj-width" min="1" max="1000" value="2">
                            </div>
                            <div class="map-planner-form-group">
                                <label for="map-obj-height"><i class="fas fa-arrows-alt-v"></i> Height (cells)</label>
                                <input type="number" id="map-obj-height" min="1" max="1000" value="2">
                            </div>
                            <div class="map-planner-form-group">
                                <label><i class="fas fa-palette"></i> Color</label>
                                <div class="map-planner-color-options">
                                    <div class="map-planner-color-option selected" style="background: #3498db;" data-color="blue">
                                        <i class="fas fa-check"></i>
                                    </div>
                                    <div class="map-planner-color-option" style="background: #e74c3c;" data-color="red">
                                        <i class="fas fa-check"></i>
                                    </div>
                                    <div class="map-planner-color-option" style="background: #2ecc71;" data-color="green">
                                        <i class="fas fa-check"></i>
                                    </div>
                                    <div class="map-planner-color-option" style="background: #9b59b6;" data-color="purple">
                                        <i class="fas fa-check"></i>
                                    </div>
                                    <div class="map-planner-color-option" style="background: #e67e22;" data-color="orange">
                                        <i class="fas fa-check"></i>
                                    </div>
                                </div>
                                <div class="map-planner-custom-color-container">
                                    <span class="map-planner-custom-color-label">Custom:</span>
                                    <div class="map-planner-color-option" style="background: #3498db;" data-color="custom">
                                        <i class="fas fa-check"></i>
                                    </div>
                                    <input type="color" class="map-planner-custom-color-input" id="map-custom-color-input" value="#3498db">
                                </div>
                            </div>
                            <div class="map-planner-form-group">
                                <label for="map-obj-label"><i class="fas fa-tag"></i> Label (optional)</label>
                                <input type="text" id="map-obj-label" placeholder="E.g. Barracks, Hospital">
                            </div>
                        </div>
                        <div class="map-planner-control-group">
                                <h3><i class="fas fa-mouse-pointer"></i> Current Selection</h3>
                                <div class="map-planner-selection-info" id="map-selection-info">
                                    No object selected. Click on an object to select it.
                                </div>
                                <div class="map-planner-multi-select-info" id="map-multi-select-info" style="display: none;">
                                    <i class="fas fa-info-circle"></i> Multi-select mode: Hold Shift to select multiple objects
                                </div>
                            </div>
                        <div class="map-planner-control-group">
                            <h3><i class="fas fa-save"></i> Save/Load Layout</h3>
                            <div class="map-planner-form-group">
                                <label for="map-layout-name"><i class="fas fa-file-signature"></i> Layout Name</label>
                                <input type="text" id="map-layout-name" placeholder="Enter layout name">
                            </div>
                            <div class="map-planner-form-group">
                                <label for="map-load-layout"><i class="fas fa-folder-open"></i> Load Layout</label>
                                <select id="map-load-layout">
                                    <option value="">Select a saved layout</option>
                                </select>
                            </div>
                            <div class="map-planner-layout-buttons">
                                <button class="map-planner-toolbar-btn primary" id="map-save-layout-btn">
                                    <i class="fas fa-save"></i> Save
                                </button>
                                <button class="map-planner-toolbar-btn" id="map-load-layout-btn">
                                    <i class="fas fa-folder-open"></i> Load
                                </button>
                                <button class="map-planner-toolbar-btn danger" id="map-delete-layout-btn">
                                    <i class="fas fa-trash-alt"></i> Delete
                                </button>
                            </div>
                            <div class="map-planner-form-group">
                                <label for="map-import-layouts"><i class="fas fa-file-import"></i> Import Layouts</label>
                                <input type="file" id="map-import-layouts" accept=".json">
                            </div>
                            <div class="map-planner-layout-buttons">
                                <button class="map-planner-toolbar-btn success" id="map-export-layouts-btn">
                                    <i class="fas fa-file-export"></i> Export
                                </button>
                                <button class="map-planner-toolbar-btn" id="map-import-layouts-btn">
                                    <i class="fas fa-file-import"></i> Import
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
<button id="back-to-top" style="position: fixed; bottom: 20px; right: 20px; display: none; width: 50px; height: 50px; background-color: #f1c40f; color: white; border: none; border-radius: 50%; font-size: 20px; cursor: pointer; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); transition: all 0.3s;">^</button>
    <!-- Status message element -->
    <div class="map-planner-status" id="map-status-message"></div>
    <script>
        // Navigation between calculators
        document.querySelectorAll('nav a').forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                document.querySelectorAll('nav li').forEach(item => item.classList.remove('active'));
                e.target.parentElement.classList.add('active');
                const sectionId = e.target.getAttribute('data-section');
                document.querySelectorAll('.calculator-section').forEach(section => section.classList.remove('active'));
                document.getElementById(sectionId).classList.add('active');
            });
        });
        

        // Shard Transition Map
        const shardTransitions = {
            "0_0_to_0_1": 1,
            "0_1_to_0_2": 1,
            "0_2_to_0_3": 2,
            "0_3_to_0_4": 2,
            "0_4_to_0_5": 2,
            "0_5_to_1_0": 2,

            "1_0_to_1_1": 5,
            "1_1_to_1_2": 5,
            "1_2_to_1_3": 5,
            "1_3_to_1_4": 5,
            "1_4_to_1_5": 5,
            "1_5_to_2_0": 15,

            "2_0_to_2_1": 15,
            "2_1_to_2_2": 15,
            "2_2_to_2_3": 15,
            "2_3_to_2_4": 15,
            "2_4_to_2_5": 15,
            "2_5_to_3_0": 40,

            "3_0_to_3_1": 40,
            "3_1_to_3_2": 40,
            "3_2_to_3_3": 40,
            "3_3_to_3_4": 40,
            "3_4_to_3_5": 40,
            "3_5_to_4_0": 100,

            "4_0_to_4_1": 100,
            "4_1_to_4_2": 100,
            "4_2_to_4_3": 100,
            "4_3_to_4_4": 100,
            "4_4_to_4_5": 100,
            "4_5_to_5_0": 100
        };

        // Update tier options based on star selection
        // Update tier options based on star selection
function updateTierOptions(starSelectId, tierSelectId, isCurrent = false) {
    const starSelect = document.getElementById(starSelectId);
    const tierSelect = document.getElementById(tierSelectId);
    const currentStar = parseInt(starSelect.value);
    const savedTier = tierSelect.value;
    tierSelect.innerHTML = '';
    if (currentStar === 5) {
        // Disable tier selection for 5-star heroes
        const option = document.createElement('option');
        option.textContent = 'Max (No Tiers)';
        option.disabled = true;
        tierSelect.appendChild(option);
        tierSelect.value = '0'; // Reset value but keep it disabled
    } else {
        for (let i = 0; i <= 5; i++) {
            const option = document.createElement('option');
            option.value = i;
            option.textContent = `Tier ${i}`;
            tierSelect.appendChild(option);
        }
        tierSelect.value = savedTier || (isCurrent ? '0' : '5');
    }
}
const backToTopButton = document.getElementById('back-to-top');

    window.addEventListener('scroll', () => {
        if (window.pageYOffset > 300) {
            backToTopButton.style.display = 'block';
        } else {
            backToTopButton.style.display = 'none';
        }
    });

    backToTopButton.addEventListener('click', () => {
        window.scrollTo({ top: 0, behavior: 'smooth' });
    });
function calculateShards() {
    const currentStar = parseInt(document.getElementById('current-star').value);
    const currentTier = parseInt(document.getElementById('current-tier').value);
    const targetStar = parseInt(document.getElementById('target-star').value);
    const targetTier = parseInt(document.getElementById('target-tier').value);
    const currentShards = parseInt(document.getElementById('current-shards').value) || 0;

    // Reset results
    document.getElementById('shards-result').style.display = 'none';
    document.getElementById('upgrade-steps').style.display = 'none';
    document.getElementById('steps-body').innerHTML = '';

    // Validate input
    if (currentStar > targetStar || 
        (currentStar === targetStar && currentTier > targetTier)) {
        alert('Target level must be higher than current level!');
        return;
    }

    // Special case: already at max level
    if (currentStar === 5 && targetStar === 5) {
        document.getElementById('total-shards').textContent = 0;
        document.getElementById('final-shards').textContent = Math.max(0, 0 - currentShards);
        document.getElementById('shards-result').style.display = 'block';
        return;
    }

    let totalShards = 0;
    let cs = currentStar, ct = currentTier;
    let stepsHTML = '';
    let starRows = {};

    // Initialize star rows
    for (let star = currentStar; star <= targetStar; star++) {
        starRows[star] = {
            tiers: [0, 0, 0, 0, 0],
            promote: 0,
            total: 0
        };
    }

    while (!(cs === targetStar && ct === targetTier)) {
        if (cs === 5) break;

        if (ct < 5 && (cs < targetStar || ct < targetTier)) {
            // Tier upgrade
            const stepKey = `${cs}_${ct}_to_${cs}_${ct + 1}`;
            const stepCost = shardTransitions[stepKey] || 0;
            starRows[cs].tiers[ct] = (starRows[cs].tiers[ct] || 0) + stepCost;
            starRows[cs].total += stepCost;
            totalShards += stepCost;
            ct++;
        } else if (cs < targetStar) {
            // Star promotion
            const stepKey = `${cs}_5_to_${cs + 1}_0`;
            const stepCost = shardTransitions[stepKey] || 0;
            starRows[cs].promote = stepCost;
            starRows[cs].total += stepCost;
            totalShards += stepCost;
            cs++;
            ct = 0;
        } else {
            break;
        }
    }

    // Build the table rows
    for (let star = currentStar; star < targetStar; star++) {  // Changed <= to < to exclude targetStar
    if (starRows[star] && starRows[star].total > 0) {      // Added check for total > 0
        const row = starRows[star];
        stepsHTML += `
            <tr>
                <td>${star}â˜… â†’ ${star+1}â˜…</td>
                <td>${row.tiers[0] || '-'}</td>
                <td>${row.tiers[1] || '-'}</td>
                <td>${row.tiers[2] || '-'}</td>
                <td>${row.tiers[3] || '-'}</td>
                <td>${row.tiers[4] || '-'}</td>
                <td>${row.promote || '-'}</td>
                <td>${row.total}</td>
            </tr>`;
    }
}
    const finalShards = Math.max(0, totalShards - currentShards);
    document.getElementById('total-shards').textContent = totalShards;
    document.getElementById('final-shards').textContent = finalShards;
    document.getElementById('steps-body').innerHTML = stepsHTML;
    
    // Show results
    document.getElementById('shards-result').style.display = 'block';
    if (stepsHTML) {
        document.getElementById('upgrade-steps').style.display = 'block';
    }
}
        // Gear Resources Data
        const gearResources = {
            "green_0": { alloy: 1500, solution: 15, design: 0, amber: 0 },
            "green_1": { alloy: 3800, solution: 40, design: 0, amber: 0 },
            "blue_0": { alloy: 7000, solution: 70, design: 0, amber: 0 },
            "blue_1": { alloy: 9700, solution: 95, design: 0, amber: 0 },
            "blue_2": { alloy: 0, solution: 0, design: 45, amber: 0 },
            "blue_3": { alloy: 0, solution: 0, design: 50, amber: 0 },
            "purple_0": { alloy: 0, solution: 0, design: 60, amber: 0 },
            "purple_1": { alloy: 0, solution: 0, design: 70, amber: 0 },
            "purple_2": { alloy: 6500, solution: 65, design: 40, amber: 0 },
            "purple_3": { alloy: 8000, solution: 80, design: 50, amber: 0 },
            "purple_t1_0": { alloy: 10000, solution: 95, design: 60, amber: 0 },
            "purple_t1_1": { alloy: 11000, solution: 110, design: 70, amber: 0 },
            "purple_t1_2": { alloy: 13000, solution: 130, design: 85, amber: 0 },
            "purple_t1_3": { alloy: 15000, solution: 160, design: 100, amber: 0 },
            "gold_0": { alloy: 22000, solution: 220, design: 40, amber: 0 },
            "gold_1": { alloy: 23000, solution: 230, design: 40, amber: 0 },
            "gold_2": { alloy: 25000, solution: 250, design: 45, amber: 0 },
            "gold_3": { alloy: 26000, solution: 260, design: 45, amber: 0 },
            "gold_t1_0": { alloy: 28000, solution: 280, design: 45, amber: 0 },
            "gold_t1_1": { alloy: 30000, solution: 300, design: 55, amber: 0 },
            "gold_t1_2": { alloy: 32000, solution: 320, design: 55, amber: 0 },
            "gold_t1_3": { alloy: 35000, solution: 340, design: 55, amber: 0 },
            "gold_t2_0": { alloy: 38000, solution: 390, design: 55, amber: 0 },
            "gold_t2_1": { alloy: 43000, solution: 430, design: 75, amber: 0 },
            "gold_t2_2": { alloy: 45000, solution: 460, design: 80, amber: 0 },
            "gold_t2_3": { alloy: 48000, solution: 500, design: 85, amber: 0 },
            "pink_0": { alloy: 50000, solution: 530, design: 85, amber: 10 },
            "pink_1": { alloy: 52000, solution: 560, design: 90, amber: 10 },
            "pink_2": { alloy: 54000, solution: 590, design: 95, amber: 10 },
            "pink_3": { alloy: 56000, solution: 620, design: 100, amber: 10 },
            "pink_t1_0": { alloy: 59000, solution: 670, design: 110, amber: 15 },
            "pink_t1_1": { alloy: 61000, solution: 700, design: 115, amber: 15 },
            "pink_t1_2": { alloy: 63000, solution: 730, design: 120, amber: 15 },
            "pink_t1_3": { alloy: 65000, solution: 760, design: 125, amber: 15 },
            "pink_t2_0": { alloy: 68000, solution: 810, design: 135, amber: 20 },
            "pink_t2_1": { alloy: 70000, solution: 840, design: 140, amber: 20 },
            "pink_t2_2": { alloy: 72000, solution: 870, design: 145, amber: 20 },
            "pink_t2_3": { alloy: 74000, solution: 900, design: 150, amber: 20 },
            "pink_t3_0": { alloy: 77000, solution: 950, design: 160, amber: 25 },
            "pink_t3_1": { alloy: 80000, solution: 990, design: 165, amber: 25 },
            "pink_t3_2": { alloy: 83000, solution: 1030, design: 170, amber: 25 },
            "pink_t3_3": { alloy: 86000, solution: 1070, design: 180, amber: 25 }
        };

        const gearNames = [
            { value: "cap", label: "Cap (Lancer)" },
            { value: "watch", label: "Watch (Lancer)" },
            { value: "coat", label: "Coat (Infantry)" },
            { value: "pants", label: "Pants (Infantry)" },
            { value: "belt", label: "Belt (Marksman)" },
            { value: "staff", label: "Staff (Marksman)" }
        ];
        
       function createGearSelector(index) {
    const gearDiv = document.createElement("div");
    gearDiv.className = "gear-block";
    gearDiv.innerHTML = `
        <h4>${gearNames[index].label}</h4>
        <div class="gear-level-selector">
            <div class="form-group">
                <label>Current Level</label>
                <select class="current-level">
                    ${generateLevelOptions()}
                </select>
            </div>
            <div class="form-group">
                <label>Target Level</label>
                <select class="target-level">
                    ${generateLevelOptions()}
                </select>
            </div>
            <div class="gear-preview">
                <img src="icons/${gearNames[index].value}.png" alt="${gearNames[index].label}">
            </div>
        </div>
    `;
    return gearDiv;
}
function calculateGearUpgrade(current, target) {
    const levels = Object.keys(gearResources);
    const startIdx = levels.indexOf(current);
    const endIdx = levels.indexOf(target);
    
    let resources = {
        alloy: 0,
        solution: 0,
        design: 0,
        amber: 0,
        steps: []
    };
    
    for (let i = startIdx + 1; i <= endIdx; i++) {
        const res = gearResources[levels[i]];
        resources.alloy += res.alloy;
        resources.solution += res.solution;
        resources.design += res.design;
        resources.amber += res.amber;
        resources.steps.push({
            from: levels[i-1],
            to: levels[i],
            costs: res
        });
    }
    
    return resources;
}
function displayGearResults(total, owned, steps) {
    // Update summary totals
    document.getElementById("alloy-needed").textContent = total.alloy.toLocaleString();
    document.getElementById("solution-needed").textContent = total.solution.toLocaleString();
    document.getElementById("design-needed").textContent = total.design.toLocaleString();
    document.getElementById("amber-needed").textContent = total.amber.toLocaleString();

    // Calculate final needed
    document.getElementById("final-alloy").textContent = Math.max(0, total.alloy - owned.alloy).toLocaleString();
    document.getElementById("final-solution").textContent = Math.max(0, total.solution - owned.solution).toLocaleString();
    document.getElementById("final-design").textContent = Math.max(0, total.design - owned.design).toLocaleString();
    document.getElementById("final-amber").textContent = Math.max(0, total.amber - owned.amber).toLocaleString();

    // Build detailed steps table (without including the header again)
    let stepsHTML = `<tbody>`;
    steps.forEach(gearSteps => {
        gearSteps.steps.forEach((step, i) => {
            stepsHTML += `
                <tr>
                    ${i === 0 ? `<td rowspan="${gearSteps.steps.length}" class="gear-name">${gearSteps.name}</td>` : ''}
                    <td>${formatLevelName(step.from)}</td>
                    <td>${formatLevelName(step.to)}</td>
                    <td>${step.costs.alloy.toLocaleString()}</td>
                    <td>${step.costs.solution.toLocaleString()}</td>
                    <td>${step.costs.design ? step.costs.design.toLocaleString() : '-'}</td>
                    <td>${step.costs.amber ? step.costs.amber.toLocaleString() : '-'}</td>
                </tr>`;
        });
    });
    stepsHTML += `</tbody>`;
    
    // Replace only the tbody content
    document.getElementById("steps-body-gears").innerHTML = stepsHTML;

    // Show result sections
    document.getElementById("gear-result").style.display = "block";
    document.getElementById("upgrade-steps-gears").style.display = "block";
}

function formatLevelName(level) {
    return level.replace(/_/g, ' ').toUpperCase();
}
        function generateLevelOptions() {
            const levels = Object.keys(gearResources);
            let options = '';
            levels.forEach(level => {
                const label = level.replace(/_/g, ' ').toUpperCase();
                options += `<option value="${level}">${label}</option>`;
            });
            return options;
        }

// --- CHIEF CHARMS LOGIC ---
const charmGearNames = [
    { value: "cap", label: "Cap (Lancer)", charms: ["1", "2", "3"] },
    { value: "watch", label: "Watch (Lancer)", charms: ["1", "2", "3"] },
    { value: "coat", label: "Coat (Infantry)", charms: ["1", "2", "3"] },
    { value: "pants", label: "Pants (Infantry)", charms: ["1", "2", "3"] },
    { value: "belt", label: "Belt (Marksman)", charms: ["1", "2", "3"] },
    { value: "staff", label: "Staff (Marksman)", charms: ["1", "2", "3"] }
];

const charmLevels = [
    { level: 1, guides: 5, designs: 5, secrets: 0, power: 205700 },
    { level: 2, guides: 40, designs: 15, secrets: 0, power: 288000 },
    { level: 3, guides: 60, designs: 40, secrets: 0, power: 370000 },
    { level: 4, guides: 80, designs: 100, secrets: 0, power: 452000 },
    { level: 5, guides: 100, designs: 200, secrets: 0, power: 576000 },
    { level: 6, guides: 120, designs: 300, secrets: 0, power: 700000 },
    { level: 7, guides: 140, designs: 400, secrets: 0, power: 824000 },
    { level: 8, guides: 200, designs: 400, secrets: 0, power: 948000 },
    { level: 9, guides: 300, designs: 400, secrets: 0, power: 1072000 },
    { level: 10, guides: 420, designs: 420, secrets: 0, power: 1196000 },
    { level: 11, guides: 560, designs: 420, secrets: 0, power: 1320000 },
    { level: 12, guides: 580, designs: 450, secrets: 15, power: 0 },
    { level: 13, guides: 580, designs: 450, secrets: 30, power: 0 },
    { level: 14, guides: 600, designs: 500, secrets: 45, power: 0 },
    { level: 15, guides: 600, designs: 500, secrets: 70, power: 0 },
    { level: 16, guides: 650, designs: 550, secrets: 100, power: 0 }
];

function createCharmsSelector(gearIndex) {
    const gearDiv = document.createElement("div");
    gearDiv.className = "gear-group";
    const header = document.createElement("div");
    header.className = "gear-header";
    header.textContent = charmGearNames[gearIndex].label;
    gearDiv.appendChild(header);
    const charmRow = document.createElement("div");
    charmRow.className = "charm-row";
    charmGearNames[gearIndex].charms.forEach((charm, charmIndex) => {
        const charmSet = document.createElement("div");
        charmSet.className = "charm-set";
        const title = document.createElement("h4");
        title.textContent = `${charm} Charm`;
        charmSet.appendChild(title);

        // Current Level Selector
        const currentContainer = document.createElement("div");
        currentContainer.className = "form-group";
        const currentLabel = document.createElement("label");
        currentLabel.textContent = "Current Level";
        currentContainer.appendChild(currentLabel);
        const currentSelect = document.createElement("select");
        currentSelect.className = `current-level ${charmGearNames[gearIndex].value}-${charmIndex}`;
        charmLevels.forEach(level => {
            const option = document.createElement("option");
            option.value = level.level;
            option.textContent = `Level ${level.level}`;
            currentSelect.appendChild(option);
        });
        currentContainer.appendChild(currentSelect);
        charmSet.appendChild(currentContainer);

        // Target Level Selector
        const targetContainer = document.createElement("div");
        targetContainer.className = "form-group";
        const targetLabel = document.createElement("label");
        targetLabel.textContent = "Target Level";
        targetContainer.appendChild(targetLabel);
        const targetSelect = document.createElement("select");
        targetSelect.className = `target-level ${charmGearNames[gearIndex].value}-${charmIndex}`;
        charmLevels.forEach(level => {
            const option = document.createElement("option");
            option.value = level.level;
            option.textContent = `Level ${level.level}`;
            targetSelect.appendChild(option);
        });
        targetContainer.appendChild(targetSelect);
        charmSet.appendChild(targetContainer);

        charmRow.appendChild(charmSet);
    });
    gearDiv.appendChild(charmRow);
    return gearDiv;
}

function calculateCharms() {
    // Get owned resources
    const ownedGuides = parseInt(document.getElementById('owned-guides').value) || 0;
    const ownedDesigns = parseInt(document.getElementById('owned-charm-designs').value) || 0;
    const ownedSecrets = parseInt(document.getElementById('owned-jewel-secrets').value) || 0;

    let totalGuides = 0, totalDesigns = 0, totalSecrets = 0;
    let stepsHTML = "";
    
    charmGearNames.forEach((gear, gearIndex) => {
        gear.charms.forEach((charm, charmIndex) => {
            const currentSelect = document.querySelector(`select.current-level.${gear.value}-${charmIndex}`);
            const targetSelect = document.querySelector(`select.target-level.${gear.value}-${charmIndex}`);
            if (!currentSelect || !targetSelect) return;
            const currentLevel = parseInt(currentSelect.value);
            const targetLevel = parseInt(targetSelect.value);
            if (currentLevel >= targetLevel) return;

            const currentIdx = charmLevels.findIndex(l => l.level === currentLevel);
            const targetIdx = charmLevels.findIndex(l => l.level === targetLevel);
            if (currentIdx === -1 || targetIdx === -1 || currentIdx >= targetIdx) return;

            for (let i = currentIdx + 1; i <= targetIdx; i++) {
                totalGuides += charmLevels[i].guides;
                totalDesigns += charmLevels[i].designs;
                totalSecrets += charmLevels[i].secrets;
                stepsHTML += `
                    <tr>
                        <td>${gear.label}</td>
                        <td>${charm}</td>
                        <td>${charmLevels[i-1].level}</td>
                        <td>${charmLevels[i].level}</td>
                        <td>${charmLevels[i].guides}</td>
                        <td>${charmLevels[i].designs}</td>
                        <td>${charmLevels[i].secrets > 0 ? charmLevels[i].secrets : "-"}</td>
                    </tr>`;
            }
        });
    });

    // Calculate final needed after deducting owned
    const finalGuides = Math.max(0, totalGuides - ownedGuides);
    const finalDesigns = Math.max(0, totalDesigns - ownedDesigns);
    const finalSecrets = Math.max(0, totalSecrets - ownedSecrets);

    // Update results display
    document.getElementById("total-guides").textContent = totalGuides.toLocaleString();
    document.getElementById("total-designs").textContent = totalDesigns.toLocaleString();
    document.getElementById("total-secrets").textContent = totalSecrets.toLocaleString();
    document.getElementById("final-guides").textContent = finalGuides.toLocaleString();
    document.getElementById("final-designs").textContent = finalDesigns.toLocaleString();
    document.getElementById("final-secrets").textContent = finalSecrets.toLocaleString();
    document.getElementById("steps-body-charms").innerHTML = stepsHTML;
    document.getElementById("charms-result").style.display = "block";
}
// Troop data
const troopData = {
    infantry: {
        name: "Infantry",
        tiers: {
            1: { time: 12, meat: 36, wood: 27, coal: 7, iron: 2, power: 3 },
            2: { time: 17, meat: 58, wood: 44, coal: 10, iron: 3, power: 4 },
            3: { time: 24, meat: 92, wood: 69, coal: 17, iron: 4, power: 6 },
            4: { time: 32, meat: 120, wood: 90, coal: 21, iron: 5, power: 9 },
            5: { time: 44, meat: 156, wood: 117, coal: 27, iron: 6, power: 13 },
            6: { time: 60, meat: 186, wood: 140, coal: 33, iron: 7, power: 20 },
            7: { time: 83, meat: 279, wood: 210, coal: 49, iron: 11, power: 28 },
            8: { time: 113, meat: 558, wood: 419, coal: 98, iron: 21, power: 38 },
            9: { time: 131, meat: 1394, wood: 1046, coal: 244, iron: 51, power: 50 },
            10: { time: 152, meat: 2788, wood: 2091, coal: 488, iron: 102, power: 66 },
            11: { time: 180, meat: 6970, wood: 5228, coal: 1220, iron: 253, power: 80 }
        }
    },
    lancers: {
        name: "Lancers",
        tiers: {
            1: { time: 12, meat: 32, wood: 30, coal: 7, iron: 2, power: 3 },
            2: { time: 17, meat: 51, wood: 48, coal: 10, iron: 3, power: 4 },
            3: { time: 24, meat: 81, wood: 76, coal: 16, iron: 4, power: 6 },
            4: { time: 32, meat: 105, wood: 99, coal: 21, iron: 5, power: 9 },
            5: { time: 44, meat: 136, wood: 129, coal: 27, iron: 7, power: 13 },
            6: { time: 60, meat: 163, wood: 154, coal: 32, iron: 8, power: 20 },
            7: { time: 83, meat: 244, wood: 231, coal: 48, iron: 11, power: 28 },
            8: { time: 113, meat: 488, wood: 461, coal: 95, iron: 22, power: 38 },
            9: { time: 131, meat: 1220, wood: 1151, coal: 237, iron: 55, power: 50 },
            10: { time: 152, meat: 2440, wood: 2301, coal: 474, iron: 109, power: 66 },
            11: { time: 180, meat: 6099, wood: 5751, coal: 1185, iron: 271, power: 80 }
        }
    },
    marksman: {
        name: "Marksman",
        tiers: {
            1: { time: 12, meat: 23, wood: 34, coal: 6, iron: 2, power: 3 },
            2: { time: 17, meat: 36, wood: 54, coal: 9, iron: 4, power: 4 },
            3: { time: 24, meat: 58, wood: 86, coal: 15, iron: 5, power: 6 },
            4: { time: 32, meat: 75, wood: 111, coal: 19, iron: 6, power: 9 },
            5: { time: 44, meat: 97, wood: 144, coal: 24, iron: 8, power: 13 },
            6: { time: 60, meat: 117, wood: 173, coal: 29, iron: 10, power: 20 },
            7: { time: 83, meat: 175, wood: 258, coal: 44, iron: 14, power: 28 },
            8: { time: 113, meat: 349, wood: 516, coal: 87, iron: 28, power: 38 },
            9: { time: 131, meat: 872, wood: 1290, coal: 217, iron: 70, power: 50 },
            10: { time: 152, meat: 1740, wood: 2579, coal: 433, iron: 140, power: 66 },
            11: { time: 180, meat: 4357, wood: 6448, coal: 1081, iron: 349, power: 80 }
        }
    }
};

// Format seconds into human-readable time
function formatTime(seconds) {
    if (seconds < 60) {
        return `${seconds}s`;
    }
    
    const minutes = Math.floor(seconds / 60);
    const remainingSeconds = seconds % 60;
    
    if (minutes < 60) {
        return `${minutes}m ${remainingSeconds}s`;
    }
    
    const hours = Math.floor(minutes / 60);
    const remainingMinutes = minutes % 60;
    
    if (hours < 24) {
        return `${hours}h ${remainingMinutes}m ${remainingSeconds}s`;
    }
    
    const days = Math.floor(hours / 24);
    const remainingHours = hours % 24;
    
    return `${days}d ${remainingHours}h ${remainingMinutes}m ${remainingSeconds}s`;
}

function calculateTroops() {
    // Get input values
    const troopType = document.getElementById('troop-type').value;
    const tier = parseInt(document.getElementById('troop-tier').value);
    const count = parseInt(document.getElementById('troop-count').value) || 0;
    const speedups = parseInt(document.getElementById('speedups').value) || 0;
    const baseBonus = parseFloat(document.getElementById('training-bonus').value) || 0;
    
    // Additional speed bonuses
    const vicePresident = document.getElementById('vice-president').checked ? 10 : 0;
    const ministerEducation = document.getElementById('minister-education').checked ? 50 : 0;
    const mobilize = document.getElementById('mobilize').checked ? 30 : 0;
    const totalBonus = baseBonus + vicePresident + ministerEducation + mobilize;

    const troopStats = troopData[troopType].tiers[tier];
    if (!troopStats) return;

    // Calculate resources
    const meat = troopStats.meat * count;
    const wood = troopStats.wood * count;
    const coal = troopStats.coal * count;
    const iron = troopStats.iron * count;
    const power = troopStats.power * count;

    // Time calculations
    const timePerTroop = troopStats.time;
    const baseTotalTime = timePerTroop * count;
    
    // With bonus calculations
    const speedMultiplier = 1 + (totalBonus / 100);
    const timeWithBonus = Math.floor(baseTotalTime / speedMultiplier);
    const timePerTroopWithBonus = timePerTroop / speedMultiplier;

    // Speedups available (in seconds)
    const speedupSeconds = speedups * 60;

    // Troops trainable calculations
    const troopsWithSpeedupsNoBonus = Math.floor(speedupSeconds / timePerTroop);
    const troopsWithSpeedupsWithBonus = Math.floor(speedupSeconds / timePerTroopWithBonus);

    // Time after speedups
    const timeAfterSpeedupsNoBonus = Math.max(0, baseTotalTime - speedupSeconds);
    const timeAfterSpeedupsWithBonus = Math.max(0, timeWithBonus - speedupSeconds);

    // Update results display
    document.getElementById('meat-required').textContent = meat.toLocaleString();
    document.getElementById('wood-required').textContent = wood.toLocaleString();
    document.getElementById('coal-required').textContent = coal.toLocaleString();
    document.getElementById('iron-required').textContent = iron.toLocaleString();
    document.getElementById('power-total').textContent = power.toLocaleString();

    document.getElementById('time-per-troop').textContent = formatTime(timePerTroop);
    document.getElementById('base-time-total').textContent = formatTime(baseTotalTime);
    document.getElementById('time-with-bonus').textContent = formatTime(timeWithBonus);
    
    // New displays for speedup comparisons
    document.getElementById('time-after-speedups-no-bonus').textContent = formatTime(timeAfterSpeedupsNoBonus);
    document.getElementById('time-after-speedups-with-bonus').textContent = formatTime(timeAfterSpeedupsWithBonus);
    document.getElementById('troops-speedups-no-bonus').textContent = troopsWithSpeedupsNoBonus.toLocaleString();
    document.getElementById('troops-speedups-with-bonus').textContent = troopsWithSpeedupsWithBonus.toLocaleString();
}

// Populate troop stats table
function populateTroopStatsTable() {
    const tableBody = document.getElementById('troop-stats-table');
    tableBody.innerHTML = '';
    
    for (const [type, data] of Object.entries(troopData)) {
        // Add type header
        const headerRow = document.createElement('tr');
        const headerCell = document.createElement('td');
        headerCell.colSpan = 7;
        headerCell.textContent = data.name;
        headerCell.style.fontWeight = 'bold';
        headerCell.style.backgroundColor = '#f0f0f0';
        headerRow.appendChild(headerCell);
        tableBody.appendChild(headerRow);
        
        // Add tier rows
        for (let tier = 1; tier <= 11; tier++) {
            const stats = data.tiers[tier];
            if (!stats) continue;
            
            const row = document.createElement('tr');
            row.innerHTML = `
                <td>T${tier}</td>
                <td>${formatTime(stats.time)}</td>
                <td>${stats.meat}</td>
                <td>${stats.wood}</td>
                <td>${stats.coal}</td>
                <td>${stats.iron}</td>
                <td>${stats.power}</td>
            `;
            tableBody.appendChild(row);
        }
    }
}

// Event listeners for input changes
document.getElementById('troop-type').addEventListener('change', calculateTroops);
document.getElementById('troop-tier').addEventListener('change', calculateTroops);
document.getElementById('troop-count').addEventListener('input', calculateTroops);
document.getElementById('speedups').addEventListener('input', calculateTroops);
document.getElementById('training-bonus').addEventListener('input', calculateTroops);
document.getElementById('vice-president').addEventListener('change', calculateTroops);
document.getElementById('minister-education').addEventListener('change', calculateTroops);
document.getElementById('mobilize').addEventListener('change', calculateTroops);


function showhide(button) {
        // Find the next sibling `.hide` div after the clicked button
        const targetDiv = button.nextElementSibling;

        // Toggle the 'hide' class on the target div
        targetDiv.classList.toggle('requirements-table');

        // Update the button text based on the visibility of the div
        if (targetDiv.classList.contains('requirements-table')) {
            button.innerHTML = 'Show All Requirements'; // If hidden, set button text to "Show"
        } else {
            button.innerHTML = 'Hide'; // If visible, set button text to "Hide"
        }
    }
document.addEventListener('DOMContentLoaded', () => {
    // Gear select all functionality
    document.getElementById('select-all-current-gears').addEventListener('click', () => {
        const modal = document.createElement('div');
        modal.style.position = 'fixed';
        modal.style.top = '0';
        modal.style.left = '0';
        modal.style.width = '100%';
        modal.style.height = '100%';
        modal.style.backgroundColor = 'rgba(0,0,0,0.5)';
        modal.style.display = 'flex';
        modal.style.justifyContent = 'center';
        modal.style.alignItems = 'center';
        modal.style.zIndex = '1000';
        
        const modalContent = document.createElement('div');
        modalContent.style.backgroundColor = 'white';
        modalContent.style.padding = '20px';
        modalContent.style.borderRadius = '8px';
        modalContent.style.width = '300px';
        modalContent.style.maxWidth = '90%';
        
        modalContent.innerHTML = `
            <h3 style="margin-bottom: 15px;">Set All Current Gear Levels</h3>
            <select id="gear-current-level-select" class="form-control" style="width: 100%; margin-bottom: 15px;">
                ${generateLevelOptions()}
            </select>
            <div style="display: flex; justify-content: flex-end; gap: 10px;">
                <button id="cancel-gear-current" class="small-button" style="background-color: #e74c3c;">Cancel</button>
                <button id="apply-gear-current" class="small-button">Apply</button>
            </div>
        `;
        
        modal.appendChild(modalContent);
        document.body.appendChild(modal);
        
        document.getElementById('cancel-gear-current').addEventListener('click', () => {
            document.body.removeChild(modal);
        });
        
        document.getElementById('apply-gear-current').addEventListener('click', () => {
            const level = document.getElementById('gear-current-level-select').value;
            document.querySelectorAll('.gear-block .current-level').forEach(select => {
                select.value = level;
            });
            document.body.removeChild(modal);
        });
    });
    
    document.getElementById('select-all-target-gears').addEventListener('click', () => {
        const modal = document.createElement('div');
        modal.style.position = 'fixed';
        modal.style.top = '0';
        modal.style.left = '0';
        modal.style.width = '100%';
        modal.style.height = '100%';
        modal.style.backgroundColor = 'rgba(0,0,0,0.5)';
        modal.style.display = 'flex';
        modal.style.justifyContent = 'center';
        modal.style.alignItems = 'center';
        modal.style.zIndex = '1000';
        
        const modalContent = document.createElement('div');
        modalContent.style.backgroundColor = 'white';
        modalContent.style.padding = '20px';
        modalContent.style.borderRadius = '8px';
        modalContent.style.width = '300px';
        modalContent.style.maxWidth = '90%';
        
        modalContent.innerHTML = `
            <h3 style="margin-bottom: 15px;">Set All Target Gear Levels</h3>
            <select id="gear-target-level-select" class="form-control" style="width: 100%; margin-bottom: 15px;">
                ${generateLevelOptions()}
            </select>
            <div style="display: flex; justify-content: flex-end; gap: 10px;">
                <button id="cancel-gear-target" class="small-button" style="background-color: #e74c3c;">Cancel</button>
                <button id="apply-gear-target" class="small-button">Apply</button>
            </div>
        `;
        
        modal.appendChild(modalContent);
        document.body.appendChild(modal);
        
        document.getElementById('cancel-gear-target').addEventListener('click', () => {
            document.body.removeChild(modal);
        });
        
        document.getElementById('apply-gear-target').addEventListener('click', () => {
            const level = document.getElementById('gear-target-level-select').value;
            document.querySelectorAll('.gear-block .target-level').forEach(select => {
                select.value = level;
            });
            document.body.removeChild(modal);
        });
    });
    
    // Charms select all functionality
    document.getElementById('select-all-current-charms').addEventListener('click', () => {
        const modal = document.createElement('div');
        modal.style.position = 'fixed';
        modal.style.top = '0';
        modal.style.left = '0';
        modal.style.width = '100%';
        modal.style.height = '100%';
        modal.style.backgroundColor = 'rgba(0,0,0,0.5)';
        modal.style.display = 'flex';
        modal.style.justifyContent = 'center';
        modal.style.alignItems = 'center';
        modal.style.zIndex = '1000';
        
        const modalContent = document.createElement('div');
        modalContent.style.backgroundColor = 'white';
        modalContent.style.padding = '20px';
        modalContent.style.borderRadius = '8px';
        modalContent.style.width = '300px';
        modalContent.style.maxWidth = '90%';
        
        let options = '';
        charmLevels.forEach(level => {
            options += `<option value="${level.level}">Level ${level.level}</option>`;
        });
        
        modalContent.innerHTML = `
            <h3 style="margin-bottom: 15px;">Set All Current Charm Levels</h3>
            <select id="charm-current-level-select" class="form-control" style="width: 100%; margin-bottom: 15px;">
                ${options}
            </select>
            <div style="display: flex; justify-content: flex-end; gap: 10px;">
                <button id="cancel-charm-current" class="small-button" style="background-color: #e74c3c;">Cancel</button>
                <button id="apply-charm-current" class="small-button">Apply</button>
            </div>
        `;
        
        modal.appendChild(modalContent);
        document.body.appendChild(modal);
        
        document.getElementById('cancel-charm-current').addEventListener('click', () => {
            document.body.removeChild(modal);
        });
        
        document.getElementById('apply-charm-current').addEventListener('click', () => {
            const level = document.getElementById('charm-current-level-select').value;
            document.querySelectorAll('.charm-set .current-level').forEach(select => {
                select.value = level;
            });
            document.body.removeChild(modal);
        });
    });
    
    document.getElementById('select-all-target-charms').addEventListener('click', () => {
        const modal = document.createElement('div');
        modal.style.position = 'fixed';
        modal.style.top = '0';
        modal.style.left = '0';
        modal.style.width = '100%';
        modal.style.height = '100%';
        modal.style.backgroundColor = 'rgba(0,0,0,0.5)';
        modal.style.display = 'flex';
        modal.style.justifyContent = 'center';
        modal.style.alignItems = 'center';
        modal.style.zIndex = '1000';
        
        const modalContent = document.createElement('div');
        modalContent.style.backgroundColor = 'white';
        modalContent.style.padding = '20px';
        modalContent.style.borderRadius = '8px';
        modalContent.style.width = '300px';
        modalContent.style.maxWidth = '90%';
        
        let options = '';
        charmLevels.forEach(level => {
            options += `<option value="${level.level}">Level ${level.level}</option>`;
        });
        
        modalContent.innerHTML = `
            <h3 style="margin-bottom: 15px;">Set All Target Charm Levels</h3>
            <select id="charm-target-level-select" class="form-control" style="width: 100%; margin-bottom: 15px;">
                ${options}
            </select>
            <div style="display: flex; justify-content: flex-end; gap: 10px;">
                <button id="cancel-charm-target" class="small-button" style="background-color: #e74c3c;">Cancel</button>
                <button id="apply-charm-target" class="small-button">Apply</button>
            </div>
        `;
        
        modal.appendChild(modalContent);
        document.body.appendChild(modal);
        
        document.getElementById('cancel-charm-target').addEventListener('click', () => {
            document.body.removeChild(modal);
        });
        
        document.getElementById('apply-charm-target').addEventListener('click', () => {
            const level = document.getElementById('charm-target-level-select').value;
            document.querySelectorAll('.charm-set .target-level').forEach(select => {
                select.value = level;
            });
            document.body.removeChild(modal);
        });
    });
});
// --- MAP PLANNER LOGIC ---
document.addEventListener('DOMContentLoaded', () => {
            // Initialize elements
            const mapGridWrapper = document.getElementById('map-grid-wrapper');
            const mapGrid = document.getElementById('map-grid');
            const mapGridColsInput = document.getElementById('map-grid-cols');
            const mapGridRowsInput = document.getElementById('map-grid-rows');
            const mapUpdateGridBtn = document.getElementById('map-update-grid-btn');
            const mapObjWidthInput = document.getElementById('map-obj-width');
            const mapObjHeightInput = document.getElementById('map-obj-height');
            const mapObjLabelInput = document.getElementById('map-obj-label');
            const mapPlaceBtn = document.getElementById('map-place-btn');
            const mapPlaceSingleBtn = document.getElementById('map-place-single-btn');
            const mapDeleteBtn = document.getElementById('map-delete-btn');
            const mapClearBtn = document.getElementById('map-clear-btn');
            const mapDownloadBtn = document.getElementById('map-download-btn');
            const mapMultiSelectBtn = document.getElementById('map-multi-select-btn');
            const mapColorOptions = document.querySelectorAll('.map-planner-color-option');
            const mapCustomColorInput = document.getElementById('map-custom-color-input');
            const mapSelectionInfo = document.getElementById('map-selection-info');
            const mapMultiSelectInfo = document.getElementById('map-multi-select-info');
            const mapZoomInBtn = document.getElementById('map-zoom-in-btn');
            const mapZoomOutBtn = document.getElementById('map-zoom-out-btn');
            const mapZoomResetBtn = document.getElementById('map-zoom-reset-btn');
            const mapTotalObjectsSpan = document.getElementById('map-total-objects');
            const mapGridSizeSpan = document.getElementById('map-grid-size');
            const mapGridUtilizationSpan = document.getElementById('map-grid-utilization');
            const mapLayoutNameInput = document.getElementById('map-layout-name');
            const mapLoadLayoutSelect = document.getElementById('map-load-layout');
            const mapSaveLayoutBtn = document.getElementById('map-save-layout-btn');
            const mapLoadLayoutBtn = document.getElementById('map-load-layout-btn');
            const mapDeleteLayoutBtn = document.getElementById('map-delete-layout-btn');
            const mapExportLayoutsBtn = document.getElementById('map-export-layouts-btn');
            const mapImportLayoutsInput = document.getElementById('map-import-layouts');
            const mapImportLayoutsBtn = document.getElementById('map-import-layouts-btn');
            const mapStatusMessage = document.getElementById('map-status-message');

            // Constants
            const CELL_SIZE = 30;
            let gridCols = 26;
            let gridRows = 16;
            let objWidth = 2;
            let objHeight = 2;
            let selectedColor = 'blue';
            let customColor = '#3498db';
            let objects = [];
            let selectedObjects = [];
            let isPlacing = false;
            let isSinglePlacement = false;
            let isMultiSelect = false;
            let placingObject = null;
            let currentZoom = 1;
            let isDragging = false;
            let draggedObject = null;
            let dragStartRow = 0;
            let dragStartCol = 0;
            let dragRowOffset = 0;
            let dragColOffset = 0;

            // Initialize
            initializeMapGrid();
            setupMapEventListeners();
            updateSavedLayouts();

            function initializeMapGrid() {
                gridCols = parseInt(mapGridColsInput.value);
                gridRows = parseInt(mapGridRowsInput.value);

                mapGrid.style.gridTemplateColumns = `repeat(${gridCols}, ${CELL_SIZE}px)`;
                mapGrid.style.gridTemplateRows = `repeat(${gridRows}, ${CELL_SIZE}px)`;
                mapGrid.style.width = `${gridCols * CELL_SIZE}px`;
                mapGrid.style.height = `${gridRows * CELL_SIZE}px`;

                mapGridSizeSpan.textContent = `${gridCols}Ã—${gridRows}`;
                currentZoom = 1;
                mapGrid.style.transform = `scale(${currentZoom})`;

                mapGrid.innerHTML = '';
                for (let i = 0; i < gridRows; i++) {
                    for (let j = 0; j < gridCols; j++) {
                        const cell = document.createElement('div');
                        cell.classList.add('map-planner-grid-cell');
                        cell.dataset.row = i;
                        cell.dataset.col = j;
                        cell.style.margin = '0';
                        cell.style.padding = '0';
                        mapGrid.appendChild(cell);
                    }
                }
                mapGridWrapper.scrollTo(0, 0);
                centerMapGrid();
                updateMapStats();
            }

            function centerMapGrid() {
                mapGridWrapper.scrollTo(
                    (gridCols * CELL_SIZE * currentZoom - mapGridWrapper.clientWidth) / 2,
                    (gridRows * CELL_SIZE * currentZoom - mapGridWrapper.clientHeight) / 2
                );
            }

            function setupMapEventListeners() {
                // Grid configuration
                mapUpdateGridBtn.addEventListener('click', () => {
                    initializeMapGrid();
                    objects = [];
                    selectedObjects = [];
                    updateMapSelectionInfo();
                    updateMapStats();
                });

                // Object placement mode
                mapPlaceBtn.addEventListener('click', toggleMapPlacementMode);
                mapPlaceSingleBtn.addEventListener('click', toggleMapSinglePlacementMode);

                // Multi-select mode
                mapMultiSelectBtn.addEventListener('click', () => {
                    isMultiSelect = !isMultiSelect;
                    mapMultiSelectBtn.classList.toggle('active', isMultiSelect);
                    mapMultiSelectInfo.style.display = isMultiSelect ? 'block' : 'none';
                    if (!isMultiSelect && selectedObjects.length > 1) {
                        clearMapSelection();
                    }
                });

                // Color selection
                mapColorOptions.forEach(option => {
                    option.addEventListener('click', () => {
                        mapColorOptions.forEach(opt => opt.classList.remove('selected'));
                        option.classList.add('selected');
                        selectedColor = option.dataset.color;
                        if (selectedColor === 'custom') {
                            const customOption = document.querySelector('.map-planner-color-option[data-color="custom"]');
                            customOption.style.backgroundColor = customColor;
                        }
                        if (placingObject) {
                            updateMapPlacingObjectColor();
                        }
                        if (selectedObjects.length > 0) {
                            updateMapSelectedObjectsColor();
                        }
                    });
                });

                // Custom color input
                mapCustomColorInput.addEventListener('input', (e) => {
                    customColor = e.target.value;
                    if (selectedColor === 'custom') {
                        const customOption = document.querySelector('.map-planner-color-option[data-color="custom"]');
                        customOption.style.backgroundColor = customColor;
                        if (placingObject) {
                            updateMapPlacingObjectColor();
                        }
                        if (selectedObjects.length > 0) {
                            updateMapSelectedObjectsColor();
                        }
                    }
                });

                // Object deletion
                mapDeleteBtn.addEventListener('click', deleteMapSelectedObjects);

                // Clear all objects
                mapClearBtn.addEventListener('click', () => {
                    objects.forEach(obj => obj.element.remove());
                    objects = [];
                    selectedObjects = [];
                    updateMapSelectionInfo();
                    updateMapOccupiedCells();
                    updateMapStats();
                });

                // Download grid
                mapDownloadBtn.addEventListener('click', downloadMapFullGrid);

                // Zoom controls
                mapZoomInBtn.addEventListener('click', () => {
                    currentZoom = Math.min(currentZoom + 0.1, 2);
                    mapGrid.style.transform = `scale(${currentZoom})`;
                    centerMapGrid();
                });

                mapZoomOutBtn.addEventListener('click', () => {
                    currentZoom = Math.max(currentZoom - 0.1, 0.5);
                    mapGrid.style.transform = `scale(${currentZoom})`;
                    centerMapGrid();
                });

                mapZoomResetBtn.addEventListener('click', () => {
                    currentZoom = 1;
                    mapGrid.style.transform = `scale(${currentZoom})`;
                    centerMapGrid();
                });

                // Grid interaction
                mapGrid.addEventListener('mousedown', handleMapGridMouseDown);
                mapGrid.addEventListener('mousemove', handleMapGridMouseMove);
                document.addEventListener('mouseup', handleMapGridMouseUp);

                // Update placing object
                mapObjWidthInput.addEventListener('input', updateMapPlacingObject);
                mapObjHeightInput.addEventListener('input', updateMapPlacingObject);
                mapObjLabelInput.addEventListener('input', updateMapPlacingObject);

                // Save/Load/Delete layout
                mapSaveLayoutBtn.addEventListener('click', saveLayout);
                mapLoadLayoutBtn.addEventListener('click', loadLayout);
                mapDeleteLayoutBtn.addEventListener('click', deleteLayout);

                // Export/Import layouts
                mapExportLayoutsBtn.addEventListener('click', exportLayouts);
                mapImportLayoutsBtn.addEventListener('click', importLayouts);
            }

            function toggleMapPlacementMode() {
                if (isPlacing) {
                    isPlacing = false;
                    mapPlaceBtn.classList.remove('active');
                    if (placingObject) {
                        placingObject.remove();
                        placingObject = null;
                    }
                    return;
                }
                if (isSinglePlacement) {
                    isSinglePlacement = false;
                    mapPlaceSingleBtn.classList.remove('active');
                }
                isPlacing = true;
                mapPlaceBtn.classList.add('active');
                createMapPlacingObject();
            }

            function toggleMapSinglePlacementMode() {
                if (isSinglePlacement) {
                    isSinglePlacement = false;
                    mapPlaceSingleBtn.classList.remove('active');
                    if (placingObject) {
                        placingObject.remove();
                        placingObject = null;
                    }
                    return;
                }
                if (isPlacing) {
                    isPlacing = false;
                    mapPlaceBtn.classList.remove('active');
                }
                isSinglePlacement = true;
                mapPlaceSingleBtn.classList.add('active');
                createMapPlacingObject();
            }

            function updateMapPlacingObjectColor() {
                if (!placingObject) return;
                placingObject.className = 'map-planner-grid-object placing';
                placingObject.style.backgroundColor = '';
                if (selectedColor === 'custom') {
                    placingObject.style.backgroundColor = customColor;
                } else {
                    placingObject.classList.add(`map-planner-object-${selectedColor}`);
                }
            }

            function updateMapSelectedObjectsColor() {
                selectedObjects.forEach(object => {
                    object.className = 'map-planner-grid-object';
                    if (object.classList.contains('selected')) {
                        object.classList.add('selected');
                    }
                    object.style.backgroundColor = '';
                    const objData = objects.find(obj => obj.element === object);
                    if (objData) {
                        if (selectedColor === 'custom') {
                            object.style.backgroundColor = customColor;
                            objData.color = customColor;
                        } else {
                            object.classList.add(`map-planner-object-${selectedColor}`);
                            objData.color = selectedColor;
                        }
                    }
                });
            }

            function updateMapPlacingObject() {
                if (!placingObject) return;
                objWidth = parseInt(mapObjWidthInput.value);
                objHeight = parseInt(mapObjHeightInput.value);
                const label = mapObjLabelInput.value.trim() || `${objWidth}Ã—${objHeight}`;
                placingObject.textContent = label;
                const objectWidth = objWidth * CELL_SIZE;
                const objectHeight = objHeight * CELL_SIZE;
                placingObject.style.width = `${objectWidth}px`;
                placingObject.style.height = `${objectHeight}px`;
            }

            function handleMapGridMouseDown(e) {
                const cell = e.target.closest('.map-planner-grid-cell');
                const clickedObject = e.target.closest('.map-planner-grid-object');
                
                if ((isPlacing || isSinglePlacement) && cell) {
                    if (placingObject) {
                        placingObject.remove();
                    }
                    objWidth = parseInt(mapObjWidthInput.value);
                    objHeight = parseInt(mapObjHeightInput.value);
                    const row = parseInt(cell.dataset.row);
                    const col = parseInt(cell.dataset.col);
                    if (canPlaceMapObject(row, col, objWidth, objHeight)) {
                        placeMapNewObject(row, col, objWidth, objHeight);
                        if (isSinglePlacement) {
                            isSinglePlacement = false;
                            mapPlaceSingleBtn.classList.remove('active');
                            if (placingObject) {
                                placingObject.remove();
                                placingObject = null;
                            }
                        } else if (isPlacing) {
                            createMapPlacingObject();
                        }
                    } else if (isPlacing) {
                        createMapPlacingObject();
                    }
                    return;
                }
                
                if (clickedObject && !isPlacing && !isSinglePlacement) {
                    e.preventDefault();
                    if (!e.shiftKey || !isMultiSelect) {
                        clearMapSelection();
                    }
                    selectMapObject(clickedObject, !e.shiftKey);
                    
                    if (selectedObjects.length === 1 && !isMultiSelect) {
                        isDragging = true;
                        draggedObject = clickedObject;
                        const objData = objects.find(obj => obj.element === draggedObject);
                        
                        if (objData) {
                            // Calculate the offset within the object where the user clicked
                            const rect = draggedObject.getBoundingClientRect();
                            const x = (e.clientX - rect.left) / currentZoom;
                            const y = (e.clientY - rect.top) / currentZoom;
                            
                            // Calculate which cell within the object was clicked
                            dragColOffset = Math.floor(x / CELL_SIZE);
                            dragRowOffset = Math.floor(y / CELL_SIZE);
                            
                            // Store the original position
                            dragStartRow = objData.row;
                            dragStartCol = objData.col;
                            
                            draggedObject.classList.add('dragging');
                        }
                    }
                    return;
                }
                
                if (!isMultiSelect || !e.shiftKey) {
                    clearMapSelection();
                }
            }

            function handleMapGridMouseMove(e) {
                if (isPlacing || isSinglePlacement) {
                    if (!placingObject) return;
                    const rect = mapGrid.getBoundingClientRect();
                    const x = (e.clientX - rect.left) / currentZoom;
                    const y = (e.clientY - rect.top) / currentZoom;
                    const col = Math.floor(x / CELL_SIZE);
                    const row = Math.floor(y / CELL_SIZE);
                    const objectWidth = objWidth * CELL_SIZE;
                    const objectHeight = objHeight * CELL_SIZE;
                    const maxLeft = (gridCols - objWidth) * CELL_SIZE;
                    const maxTop = (gridRows - objHeight) * CELL_SIZE;
                    const left = Math.min(Math.max(col * CELL_SIZE, 0), maxLeft);
                    const top = Math.min(Math.max(row * CELL_SIZE, 0), maxTop);
                    placingObject.style.left = `${left}px`;
                    placingObject.style.top = `${top}px`;
                    return;
                }
                
                if (isDragging && draggedObject) {
                    const rect = mapGrid.getBoundingClientRect();
                    // Account for zoom when calculating position
                    const x = (e.clientX - rect.left) / currentZoom;
                    const y = (e.clientY - rect.top) / currentZoom;
                    
                    // Calculate the new position accounting for the offset and zoom
                    const col = Math.floor(x / CELL_SIZE) - dragColOffset;
                    const row = Math.floor(y / CELL_SIZE) - dragRowOffset;
                    
                    const objData = objects.find(obj => obj.element === draggedObject);
                    if (objData) {
                        const { width, height } = objData;
                        const maxLeft = (gridCols - width) * CELL_SIZE;
                        const maxTop = (gridRows - height) * CELL_SIZE;
                        const left = Math.min(Math.max(col * CELL_SIZE, 0), maxLeft);
                        const top = Math.min(Math.max(row * CELL_SIZE, 0), maxTop);
                        
                        draggedObject.style.left = `${left}px`;
                        draggedObject.style.top = `${top}px`;
                        
                        const isValid = canPlaceMapObject(row, col, width, height, draggedObject);
                        draggedObject.classList.toggle('valid', isValid);
                        draggedObject.classList.toggle('invalid', !isValid);
                    }
                }
            }

            function handleMapGridMouseUp(e) {
                if (isDragging && draggedObject) {
                    isDragging = false;
                    const objData = objects.find(obj => obj.element === draggedObject);
                    if (objData) {
                        const rect = mapGrid.getBoundingClientRect();
                        // Account for zoom when calculating final position
                        const x = (e.clientX - rect.left) / currentZoom;
                        const y = (e.clientY - rect.top) / currentZoom;
                        
                        // Calculate the new position accounting for the offset and zoom
                        const col = Math.floor(x / CELL_SIZE) - dragColOffset;
                        const row = Math.floor(y / CELL_SIZE) - dragRowOffset;
                        
                        const isValid = canPlaceMapObject(row, col, objData.width, objData.height, draggedObject);
                        draggedObject.classList.remove('dragging', 'valid', 'invalid');
                        
                        if (isValid) {
                            objData.row = row;
                            objData.col = col;
                            positionMapObject(draggedObject, row, col, objData.width, objData.height);
                            updateMapOccupiedCells();
                            updateMapSelectionInfo();
                            updateMapStats();
                        } else {
                            positionMapObject(draggedObject, dragStartRow, dragStartCol, objData.width, objData.height);
                        }
                    }
                    draggedObject = null;
                    dragRowOffset = 0;
                    dragColOffset = 0;
                }
            }

            function clearMapSelection() {
                selectedObjects.forEach(obj => obj.classList.remove('selected'));
                selectedObjects = [];
                updateMapSelectionInfo();
            }

            function selectMapObject(object, singleSelect = true) {
                if (singleSelect && selectedObjects.length > 0 && !selectedObjects.includes(object)) {
                    clearMapSelection();
                }
                if (!selectedObjects.includes(object)) {
                    selectedObjects.push(object);
                    object.classList.add('selected');
                    updateMapSelectionInfo();
                } else if (isMultiSelect) {
                    const index = selectedObjects.indexOf(object);
                    if (index !== -1) {
                        selectedObjects.splice(index, 1);
                        object.classList.remove('selected');
                        updateMapSelectionInfo();
                    }
                }
            }

            function updateMapSelectionInfo() {
                if (selectedObjects.length === 0) {
                    mapSelectionInfo.textContent = "No object selected";
                    return;
                }
                if (selectedObjects.length > 1) {
                    mapSelectionInfo.innerHTML = `
                        <strong>${selectedObjects.length} objects selected</strong><br>
                        Hold Shift to add/remove from selection
                    `;
                    return;
                }
                const object = selectedObjects[0];
                const objData = objects.find(obj => obj.element === object);
                if (objData) {
                    mapSelectionInfo.innerHTML = `
                        <strong>Selected Object:</strong><br>
                        Position: (${objData.col}, ${objData.row})<br>
                        Size: ${objData.width}Ã—${objData.height}<br>
                        Color: ${objData.color}<br>
                        ${objData.label ? `Label: ${objData.label}` : ''}
                    `;
                }
            }

            function createMapPlacingObject() {
                if (placingObject) {
                    placingObject.remove();
                }
                placingObject = document.createElement('div');
                placingObject.classList.add('map-planner-grid-object', 'placing');
                if (selectedColor === 'custom') {
                    placingObject.style.backgroundColor = customColor;
                } else {
                    placingObject.classList.add(`map-planner-object-${selectedColor}`);
                }
                const label = mapObjLabelInput.value.trim() || `${mapObjWidthInput.value}Ã—${mapObjHeightInput.value}`;
                placingObject.textContent = label;
                const objectWidth = objWidth * CELL_SIZE;
                const objectHeight = objHeight * CELL_SIZE;
                placingObject.style.width = `${objectWidth}px`;
                placingObject.style.height = `${objectHeight}px`;
                placingObject.style.left = `-${objectWidth}px`;
                placingObject.style.top = `-${objectHeight}px`;
                mapGrid.appendChild(placingObject);
            }

            function placeMapNewObject(row, col, width, height) {
                const object = document.createElement('div');
                object.classList.add('map-planner-grid-object');
                if (selectedColor === 'custom') {
                    object.style.backgroundColor = customColor;
                } else {
                    object.classList.add(`map-planner-object-${selectedColor}`);
                }
                const label = mapObjLabelInput.value.trim() || `${width}Ã—${height}`;
                object.textContent = label;
                const objData = {
                    element: object,
                    row,
                    col,
                    width,
                    height,
                    color: selectedColor === 'custom' ? customColor : selectedColor,
                    label
                };
                objects.push(objData);
                mapGrid.appendChild(object);
                positionMapObject(object, row, col, width, height);
                updateMapOccupiedCells();
                if (placingObject) {
                    placingObject.remove();
                    placingObject = null;
                    if (isPlacing) {
                        createMapPlacingObject();
                    }
                }
                clearMapSelection();
                selectMapObject(object);
                updateMapStats();
            }

            function positionMapObject(object, row, col, width, height) {
                const left = col * CELL_SIZE;
                const top = row * CELL_SIZE;
                const maxLeft = (gridCols - width) * CELL_SIZE;
                const maxTop = (gridRows - height) * CELL_SIZE;
                const clampedLeft = Math.min(left, maxLeft);
                const clampedTop = Math.min(top, maxTop);
                object.style.width = `${width * CELL_SIZE}px`;
                object.style.height = `${height * CELL_SIZE}px`;
                object.style.left = `${clampedLeft}px`;
                object.style.top = `${clampedTop}px`;
            }

            function updateMapOccupiedCells() {
                document.querySelectorAll('.map-planner-grid-cell.occupied').forEach(cell => {
                    cell.classList.remove('occupied');
                });
                objects.forEach(obj => {
                    for (let r = obj.row; r < obj.row + obj.height; r++) {
                        for (let c = obj.col; c < obj.col + obj.width; c++) {
                            const cell = mapGrid.querySelector(`.map-planner-grid-cell[data-row="${r}"][data-col="${c}"]`);
                            if (cell) cell.classList.add('occupied');
                        }
                    }
                });
            }

            function canPlaceMapObject(row, col, width, height, excludeObject = null) {
                if (row < 0 || col < 0 || row + height > gridRows || col + width > gridCols) {
                    return false;
                }
                for (let r = row; r < row + height; r++) {
                    for (let c = col; c < col + width; c++) {
                        const cell = mapGrid.querySelector(`.map-planner-grid-cell[data-row="${r}"][data-col="${c}"]`);
                        if (cell && cell.classList.contains('occupied')) {
                            let isExcluded = false;
                            if (excludeObject) {
                                const objData = objects.find(obj => obj.element === excludeObject);
                                if (objData && r >= objData.row && r < objData.row + objData.height &&
                                    c >= objData.col && c < objData.col + objData.width) {
                                    isExcluded = true;
                                }
                            }
                            if (!isExcluded) {
                                return false;
                            }
                        }
                    }
                }
                return true;
            }

            function deleteMapSelectedObjects() {
                if (selectedObjects.length === 0) return;
                selectedObjects.forEach(object => {
                    const index = objects.findIndex(obj => obj.element === object);
                    if (index !== -1) {
                        object.remove();
                        objects.splice(index, 1);
                    }
                });
                updateMapOccupiedCells();
                selectedObjects = [];
                updateMapSelectionInfo();
                updateMapStats();
            }

            function downloadMapFullGrid() {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                canvas.width = gridCols * CELL_SIZE;
                canvas.height = gridRows * CELL_SIZE;
                ctx.fillStyle = '#2c3e50';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                ctx.fillStyle = '#34495e';
                for (let i = 0; i < gridRows; i++) {
                    for (let j = 0; j < gridCols; j++) {
                        ctx.fillRect(j * CELL_SIZE, i * CELL_SIZE, CELL_SIZE - 1, CELL_SIZE - 1);
                    }
                }
                objects.forEach(obj => {
                    for (let r = obj.row; r < obj.row + obj.height; r++) {
                        for (let c = obj.col; c < obj.col + obj.width; c++) {
                            ctx.fillStyle = 'rgba(255, 255, 255, 0.05)';
                            ctx.fillRect(c * CELL_SIZE, r * CELL_SIZE, CELL_SIZE - 1, CELL_SIZE - 1);
                        }
                    }
                });
                objects.forEach(obj => {
                    const left = obj.col * CELL_SIZE;
                    const top = obj.row * CELL_SIZE;
                    const width = obj.width * CELL_SIZE;
                    const height = obj.height * CELL_SIZE;
                    const colorMap = {
                        'blue': '#3498db',
                        'red': '#e74c3c',
                        'green': '#2ecc71',
                        'purple': '#9b59b6',
                        'orange': '#e67e22'
                    };
                    ctx.fillStyle = obj.color.startsWith('#') ? obj.color : colorMap[obj.color] || '#3498db';
                    ctx.fillRect(left, top, width, height);
                    ctx.strokeStyle = 'rgba(255,255,255,0.3)';
                    ctx.lineWidth = 1;
                    ctx.strokeRect(left, top, width, height);
                    ctx.shadowColor = 'rgba(0,0,0,0.3)';
                    ctx.shadowBlur = 2;
                    ctx.shadowOffsetX = 0;
                    ctx.shadowOffsetY = 0;
                    if (obj.label) {
                        ctx.font = 'bold 12px Arial';
                        ctx.fillStyle = 'white';
                        ctx.textAlign = 'center';
                        ctx.textBaseline = 'middle';
                        ctx.shadowColor = 'rgba(0,0,0,0.8)';
                        ctx.shadowBlur = 2;
                        ctx.fillText(obj.label, left + width/2, top + height/2);
                        ctx.shadowColor = 'transparent';
                    }
                });
                const link = document.createElement('a');
                link.download = `grid-map-${new Date().toISOString().slice(0,10)}.png`;
                link.href = canvas.toDataURL('image/png');
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }

            function updateMapStats() {
                mapTotalObjectsSpan.textContent = objects.length;
                const totalCells = gridCols * gridRows;
                let occupiedCells = 0;
                objects.forEach(obj => {
                    occupiedCells += obj.width * obj.height;
                });
                const utilizationPercentage = totalCells > 0 ? Math.round((occupiedCells / totalCells) * 100) : 0;
                mapGridUtilizationSpan.textContent = `${utilizationPercentage}%`;
            }

            function showStatusMessage(message, duration = 3000) {
                mapStatusMessage.textContent = message;
                mapStatusMessage.classList.add('show');
                setTimeout(() => {
                    mapStatusMessage.classList.remove('show');
                }, duration);
            }

            function saveLayout() {
                const layoutName = mapLayoutNameInput.value.trim();
                if (!layoutName) {
                    showStatusMessage('Please enter a layout name.');
                    return;
                }
                const layoutData = {
                    gridCols,
                    gridRows,
                    objects: objects.map(obj => ({
                        row: obj.row,
                        col: obj.col,
                        width: obj.width,
                        height: obj.height,
                        color: obj.color,
                        label: obj.label
                    }))
                };
                let layouts;
                try {
                    layouts = JSON.parse(localStorage.getItem('mapLayouts') || '{}');
                } catch (e) {
                    showStatusMessage('Error accessing saved layouts. Please clear localStorage and try again.');
                    return;
                }
                layouts[layoutName] = layoutData;
                try {
                    localStorage.setItem('mapLayouts', JSON.stringify(layouts));
                } catch (e) {
                    showStatusMessage('Error saving layout: localStorage may be full or inaccessible.');
                    return;
                }
                mapLayoutNameInput.value = '';
                updateSavedLayouts();
                showStatusMessage(`Layout "${layoutName}" saved successfully!`);
            }

            function loadLayout() {
                const layoutName = mapLoadLayoutSelect.value;
                if (!layoutName) {
                    showStatusMessage('Please select a layout to load.');
                    return;
                }
                let layouts;
                try {
                    layouts = JSON.parse(localStorage.getItem('mapLayouts') || '{}');
                } catch (e) {
                    showStatusMessage('Error accessing saved layouts. Please clear localStorage and try again.');
                    return;
                }
                const layoutData = layouts[layoutName];
                if (!layoutData) {
                    showStatusMessage('Selected layout not found.');
                    return;
                }
                gridCols = layoutData.gridCols;
                gridRows = layoutData.gridRows;
                mapGridColsInput.value = gridCols;
                mapGridRowsInput.value = gridRows;
                initializeMapGrid();
                objects = [];
                selectedObjects = [];
                layoutData.objects.forEach(obj => {
                    const object = document.createElement('div');
                    object.classList.add('map-planner-grid-object');
                    if (obj.color.startsWith('#')) {
                        object.style.backgroundColor = obj.color;
                    } else {
                        object.classList.add(`map-planner-object-${obj.color}`);
                    }
                    object.textContent = obj.label || `${obj.width}Ã—${obj.height}`;
                    const objData = {
                        element: object,
                        row: obj.row,
                        col: obj.col,
                        width: obj.width,
                        height: obj.height,
                        color: obj.color,
                        label: obj.label
                    };
                    objects.push(objData);
                    mapGrid.appendChild(object);
                    positionMapObject(object, obj.row, obj.col, obj.width, obj.height);
                });
                updateMapOccupiedCells();
                updateMapStats();
                clearMapSelection();
                showStatusMessage(`Layout "${layoutName}" loaded successfully!`);
            }

            function deleteLayout() {
                const layoutName = mapLoadLayoutSelect.value;
                if (!layoutName) {
                    showStatusMessage('Please select a layout to delete.');
                    return;
                }
                let layouts;
                try {
                    layouts = JSON.parse(localStorage.getItem('mapLayouts') || '{}');
                } catch (e) {
                    showStatusMessage('Error accessing saved layouts. Please clear localStorage and try again.');
                    return;
                }
                if (layouts[layoutName]) {
                    delete layouts[layoutName];
                    try {
                        localStorage.setItem('mapLayouts', JSON.stringify(layouts));
                    } catch (e) {
                        showStatusMessage('Error deleting layout: localStorage may be full or inaccessible.');
                        return;
                    }
                    updateSavedLayouts();
                    showStatusMessage(`Layout "${layoutName}" deleted successfully!`);
                } else {
                    showStatusMessage('Selected layout not found.');
                }
            }

            function updateSavedLayouts() {
                let layouts;
                try {
                    layouts = JSON.parse(localStorage.getItem('mapLayouts') || '{}');
                } catch (e) {
                    showStatusMessage('Error accessing saved layouts. Please clear localStorage and try again.');
                    return;
                }
                mapLoadLayoutSelect.innerHTML = '<option value="">Select a saved layout</option>';
                Object.keys(layouts).forEach(name => {
                    const option = document.createElement('option');
                    option.value = name;
                    option.textContent = name;
                    mapLoadLayoutSelect.appendChild(option);
                });
            }

            function exportLayouts() {
                let layouts;
                try {
                    layouts = localStorage.getItem('mapLayouts') || '{}';
                    const parsedLayouts = JSON.parse(layouts);
                    if (Object.keys(parsedLayouts).length === 0) {
                        showStatusMessage('No layouts to export.');
                        return;
                    }
                    const sizeInBytes = new Blob([layouts]).size;
                    const maxSize = 5 * 1024 * 1024;
                    if (sizeInBytes > maxSize) {
                        showStatusMessage('Layout data is too large to export. Try deleting some layouts.');
                        return;
                    }
                    const blob = new Blob([layouts], { type: 'application/json' });
                    const url = URL.createObjectURL(blob);
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = `map-layouts-${new Date().toISOString().slice(0,10)}.json`;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    URL.revokeObjectURL(url);
                    showStatusMessage('Layouts exported successfully!');
                } catch (e) {
                    showStatusMessage('Error exporting layouts: Could not access saved layouts.');
                    console.error('Export error:', e);
                }
            }

            function importLayouts() {
                const file = mapImportLayoutsInput.files[0];
                if (!file) {
                    showStatusMessage('Please select a JSON file to import.');
                    return;
                }
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const importedData = JSON.parse(e.target.result);
                        if (!isValidLayouts(importedData)) {
                            showStatusMessage('Invalid layout file format.');
                            return;
                        }
                        let existingLayouts;
                        try {
                            existingLayouts = JSON.parse(localStorage.getItem('mapLayouts') || '{}');
                        } catch (e) {
                            showStatusMessage('Error accessing existing layouts. Please clear localStorage and try again.');
                            return;
                        }
                        const updatedLayouts = { ...existingLayouts, ...importedData };
                        try {
                            localStorage.setItem('mapLayouts', JSON.stringify(updatedLayouts));
                        } catch (e) {
                            showStatusMessage('Error saving imported layouts: localStorage may be full or inaccessible.');
                            return;
                        }
                        updateSavedLayouts();
                        mapImportLayoutsInput.value = '';
                        showStatusMessage('Layouts imported successfully!');
                    } catch (error) {
                        showStatusMessage('Error importing layouts: Invalid JSON file or corrupted data.');
                        console.error('Import error:', error);
                    }
                };
                reader.onerror = function() {
                    showStatusMessage('Error reading the file. Please try again.');
                };
                reader.readAsText(file);
            }

            function isValidLayouts(data) {
                if (typeof data !== 'object' || data === null) return false;
                return Object.values(data).every(layout => {
                    return (
                        layout &&
                        typeof layout.gridCols === 'number' &&
                        typeof layout.gridRows === 'number' &&
                        Array.isArray(layout.objects) &&
                        layout.objects.every(obj => (
                            typeof obj.row === 'number' &&
                            typeof obj.col === 'number' &&
                            typeof obj.width === 'number' &&
                            typeof obj.height === 'number' &&
                            typeof obj.color === 'string' &&
                            (typeof obj.label === 'string' || obj.label === undefined)
                        ))
                    );
                });
            }
        });


document.addEventListener('DOMContentLoaded', () => {
    // Initialize hero shards calculator
    updateTierOptions('current-star', 'current-tier', true);
    updateTierOptions('target-star', 'target-tier');
    
    document.getElementById('current-star').addEventListener('change', () => updateTierOptions('current-star', 'current-tier', true));
    document.getElementById('target-star').addEventListener('change', () => updateTierOptions('target-star', 'target-tier'));
    document.getElementById('calculate-shards').addEventListener('click', calculateShards);

    // Initialize chief gears calculator
    const gearContainer = document.getElementById("gears-container");
    for (let i = 0; i < 6; i++) {
        gearContainer.appendChild(createGearSelector(i));
    }

     document.getElementById("calculate-all-gears").addEventListener("click", async () => {
    const button = document.getElementById("calculate-all-gears");
    button.disabled = true;
    button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Calculating...';
    
    try {
        // Perform calculations
        const owned = {
            alloy: parseInt(document.getElementById("owned-alloy")?.value || 0),
            solution: parseInt(document.getElementById("owned-solution")?.value || 0),
            design: parseInt(document.getElementById("owned-design")?.value || 0),
            amber: parseInt(document.getElementById("owned-amber")?.value || 0)
        };
        
        let total = {
            alloy: 0,
            solution: 0,
            design: 0,
            amber: 0
        };
        
        let allSteps = [];
        
        document.querySelectorAll(".gear-block").forEach((block, index) => {
            const current = block.querySelector(".current-level").value;
            const target = block.querySelector(".target-level").value;
            
            if (current !== target) {
                const result = calculateGearUpgrade(current, target);
                total.alloy += result.alloy;
                total.solution += result.solution;
                total.design += result.design;
                total.amber += result.amber;
                
                allSteps.push({
                    name: gearNames[index].label,
                    steps: result.steps
                });
            }
        });
        
        displayGearResults(total, owned, allSteps);
        
    } catch (error) {
        alert("Error in calculation: " + error.message);
    } finally {
        button.disabled = false;
        button.innerHTML = '<i class="fas fa-calculator"></i> Calculate Total Resource Requirements';
    }
});


// Initialize troops calculator
populateTroopStatsTable();
calculateTroops();

// Add event listeners for live updates
const troopInputs = [
    'troop-type', 'troop-tier', 'troop-count', 
    'speedups', 'training-bonus'
];

troopInputs.forEach(id => {
    document.getElementById(id).addEventListener('input', calculateTroops);
});
    // Initialize charms calculator
    const charmsContainer = document.getElementById("charms-container");
    for (let i = 0; i < 6; i++) {
        charmsContainer.appendChild(createCharmsSelector(i));
    }
    document.getElementById("calculate-charms").addEventListener("click", calculateCharms);
});
 const buildingData = {
    furnace: {
        name: "Furnace",
        levels: {
            1: { cost: {}, time: "00:00:00", power: 2000, prereqs: [] },
            2: { cost: { wood: 180 }, time: "00:00:06", power: 3800, prereqs: [] },
            3: { cost: { wood: 805 }, time: "00:01:00", power: 6500, prereqs: [] },
            4: { cost: { wood: 1800, coal: 360 }, time: "00:03:00", power: 10100, prereqs: [] },
            5: { cost: { wood: 7600, coal: 1500 }, time: "00:10:00", power: 15500, prereqs: [] },
            6: { cost: { wood: 19000, coal: 3800, iron: 960 }, time: "00:30:00", power: 23600, prereqs: [] },
            7: { cost: { wood: 69000, coal: 13000, iron: 3400 }, time: "01:00:00", power: 35300, prereqs: [] },
            8: { 
                cost: { wood: 120000, coal: 25000, iron: 6300 }, 
                time: "02:30:00", 
                power: 47000, 
                prereqs: [{ building: "infantry_camp", level: 7 }] 
            },
            9: { 
                cost: { wood: 260000, coal: 52000, iron: 13000 }, 
                time: "04:30:00", 
                power: 58700, 
                prereqs: [
                    { building: "embassy", level: 8 },
                    { building: "infirmary", level: 1 }
                ] 
            },
            10: { 
                cost: { wood: 460000, coal: 92000, iron: 23000 }, 
                time: "06:00:00", 
                power: 75700, 
                prereqs: [
                    { building: "marksman_camp", level: 9 },
                    { building: "research_center", level: 10 }
                ] 
            },
            11: { 
                cost: { meat: 1300000, wood: 1300000, coal: 260000, iron: 65000 }, 
                time: "07:30:00", 
                power: 92700, 
                prereqs: [
                    { building: "embassy", level: 10 },
                    { building: "lancer_camp", level: 10 }
                ] 
            },
            12: { 
                cost: { meat: 1600000, wood: 1600000, coal: 330000, iron: 84000 }, 
                time: "09:00:00", 
                power: 109700, 
                prereqs: [
                    { building: "embassy", level: 11 },
                    { building: "command_center", level: 1 }
                ] 
            },
            13: { 
                cost: { meat: 2300000, wood: 2300000, coal: 470000, iron: 110000 }, 
                time: "11:00:00", 
                power: 138400, 
                prereqs: [
                    { building: "embassy", level: 12 },
                    { building: "infantry_camp", level: 12 }
                ] 
            },
            14: { 
                cost: { meat: 3100000, wood: 3100000, coal: 630000, iron: 150000 }, 
                time: "14:00:00", 
                power: 167100, 
                prereqs: [
                    { building: "embassy", level: 13 },
                    { building: "marksman_camp", level: 13 }
                ] 
            },
            15: { 
                cost: { meat: 4600000, wood: 4600000, coal: 930000, iron: 230000 }, 
                time: "18:00:00", 
                power: 195800, 
                prereqs: [
                    { building: "embassy", level: 14 },
                    { building: "lancer_camp", level: 14 }
                ] 
            },
            16: { 
                cost: { meat: 5900000, wood: 5900000, coal: 1100000, iron: 290000 }, 
                time: "1d 06:28:00", 
                power: 236200, 
                prereqs: [
                    { building: "embassy", level: 15 },
                    { building: "research_center", level: 15 }
                ] 
            },
            17: { 
                cost: { meat: 9300000, wood: 9300000, coal: 1800000, iron: 460000 }, 
                time: "1d 12:34:00", 
                power: 276600, 
                prereqs: [
                    { building: "embassy", level: 16 },
                    { building: "infantry_camp", level: 16 }
                ] 
            },
            18: { 
                cost: { meat: 12000000, wood: 12000000, coal: 2500000, iron: 620000 }, 
                time: "1d 19:53:00", 
                power: 317000, 
                prereqs: [
                    { building: "embassy", level: 17 },
                    { building: "marksman_camp", level: 17 }
                ] 
            },
            19: { 
                cost: { meat: 15000000, wood: 15000000, coal: 3100000, iron: 780000 }, 
                time: "2d 17:50:00", 
                power: 374400, 
                prereqs: [
                    { building: "embassy", level: 18 },
                    { building: "lancer_camp", level: 18 }
                ] 
            },
            20: { 
                cost: { meat: 21000000, wood: 21000000, coal: 4300000, iron: 1000000 }, 
                time: "3d 10:18:00", 
                power: 431800, 
                prereqs: [
                    { building: "embassy", level: 19 },
                    { building: "research_center", level: 19 }
                ] 
            },
            21: { 
                cost: { meat: 27000000, wood: 27000000, coal: 5400000, iron: 1300000 }, 
                time: "4d 10:59:00", 
                power: 489200, 
                prereqs: [
                    { building: "embassy", level: 20 },
                    { building: "infantry_camp", level: 20 }
                ] 
            },
            22: { 
                cost: { meat: 36000000, wood: 36000000, coal: 7200000, iron: 1800000 }, 
                time: "6d 16:29:00", 
                power: 575300, 
                prereqs: [
                    { building: "embassy", level: 21 },
                    { building: "marksman_camp", level: 21 }
                ] 
            },
            23: { 
                cost: { meat: 44000000, wood: 44000000, coal: 8900000, iron: 2200000 }, 
                time: "9d 08:40:00", 
                power: 661400, 
                prereqs: [
                    { building: "embassy", level: 22 },
                    { building: "lancer_camp", level: 22 }
                ] 
            },
            24: { 
                cost: { meat: 60000000, wood: 60000000, coal: 12000000, iron: 3000000 }, 
                time: "13d 02:33:00", 
                power: 747500, 
                prereqs: [
                    { building: "embassy", level: 23 },
                    { building: "research_center", level: 23 }
                ] 
            },
            25: { 
                cost: { meat: 81000000, wood: 81000000, coal: 16000000, iron: 4000000 }, 
                time: "18d 08:22:00", 
                power: 833600, 
                prereqs: [
                    { building: "embassy", level: 24 },
                    { building: "infantry_camp", level: 24 }
                ] 
            },
            26: { 
                cost: { meat: 100000000, wood: 100000000, coal: 21000000, iron: 5200000 }, 
                time: "21d 02:26:00", 
                power: 960100, 
                prereqs: [
                    { building: "embassy", level: 25 },
                    { building: "marksman_camp", level: 25 }
                ] 
            },
            27: { 
                cost: { meat: 140000000, wood: 140000000, coal: 24000000, iron: 7400000 }, 
                time: "25d 07:43:00", 
                power: 1086600, 
                prereqs: [
                    { building: "embassy", level: 26 },
                    { building: "lancer_camp", level: 26 }
                ] 
            },
            28: { 
                cost: { meat: 190000000, wood: 190000000, coal: 39000000, iron: 9900000 }, 
                time: "29d 02:52:00", 
                power: 1213100, 
                prereqs: [
                    { building: "embassy", level: 27 },
                    { building: "research_center", level: 27 }
                ] 
            },
            29: { 
                cost: { meat: 240000000, wood: 240000000, coal: 49000000, iron: 12000000 }, 
                time: "33d 11:42:00", 
                power: 1339600, 
                prereqs: [
                    { building: "embassy", level: 28 },
                    { building: "infantry_camp", level: 28 }
                ] 
            },
            30: { 
                cost: { meat: 300000000, wood: 300000000, coal: 60000000, iron: 15000000 }, 
                time: "40d 04:27:00", 
                power: 1523500, 
                prereqs: [
                    { building: "embassy", level: 29 },
                    { building: "marksman_camp", level: 29 }
                ] 
            },
            "30-1": { 
                cost: { meat: 67000000, wood: 67000000, coal: 13000000, iron: 3300000, fire_crystals: 132 }, 
                time: "7d 00:00:00", 
                power: 1580900, 
                prereqs: [
                    { building: "embassy", level: 30 },
                    { building: "research_center", level: 30 }
                ] 
            },
            "30-2": { 
                cost: { meat: 67000000, wood: 67000000, coal: 13000000, iron: 3300000, fire_crystals: 132 }, 
                time: "7d 00:00:00", 
                power: 1638300, 
                prereqs: [
                    { building: "embassy", level: 30 },
                    { building: "research_center", level: 30 }
                ] 
            },
            "30-3": { 
                cost: { meat: 67000000, wood: 67000000, coal: 13000000, iron: 3300000, fire_crystals: 132 }, 
                time: "7d 00:00:00", 
                power: 1695700, 
                prereqs: [
                    { building: "embassy", level: 30 },
                    { building: "research_center", level: 30 }
                ] 
            },
            "30-4": { 
                cost: { meat: 67000000, wood: 67000000, coal: 13000000, iron: 3300000, fire_crystals: 132 }, 
                time: "7d 00:00:00", 
                power: 1753100, 
                prereqs: [
                    { building: "embassy", level: 30 },
                    { building: "research_center", level: 30 }
                ] 
            },
            "FC1": { 
                cost: { meat: 67000000, wood: 67000000, coal: 13000000, iron: 3300000, fire_crystals: 132 }, 
                time: "7d 00:00:00", 
                power: 1810500, 
                prereqs: [
                    { building: "embassy", level: 30 },
                    { building: "research_center", level: 30 }
                ] 
            },
            "FC1-1": { 
                cost: { meat: 72000000, wood: 72000000, coal: 14000000, iron: 3600000, fire_crystals: 158 }, 
                time: "9d 00:00:00", 
                power: 1867900, 
                prereqs: [
                    { building: "embassy", level: "FC1" },
                    { building: "lancer_camp", level: "FC1" }
                ] 
            },
            "FC1-2": { 
                cost: { meat: 72000000, wood: 72000000, coal: 14000000, iron: 3600000, fire_crystals: 158 }, 
                time: "9d 00:00:00", 
                power: 1925300, 
                prereqs: [
                    { building: "embassy", level: "FC1" },
                    { building: "lancer_camp", level: "FC1" }
                ] 
            },
            "FC1-3": { 
                cost: { meat: 72000000, wood: 72000000, coal: 14000000, iron: 3600000, fire_crystals: 158 }, 
                time: "9d 00:00:00", 
                power: 1982700, 
                prereqs: [
                    { building: "embassy", level: "FC1" },
                    { building: "lancer_camp", level: "FC1" }
                ] 
            },
            "FC1-4": { 
                cost: { meat: 72000000, wood: 72000000, coal: 14000000, iron: 3600000, fire_crystals: 158 }, 
                time: "9d 00:00:00", 
                power: 2040100, 
                prereqs: [
                    { building: "embassy", level: "FC1" },
                    { building: "lancer_camp", level: "FC1" }
                ] 
            },
            "FC2": { 
                cost: { meat: 72000000, wood: 72000000, coal: 14000000, iron: 3600000, fire_crystals: 158 }, 
                time: "9d 00:00:00", 
                power: 2097500, 
                prereqs: [
                    { building: "embassy", level: "FC1" },
                    { building: "lancer_camp", level: "FC1" }
                ] 
            },
            
            "FC2-1": { 
                cost: { meat: 79000000, wood: 79000000, coal: 15000000, iron: 3900000, fire_crystals: 238 }, 
                time: "11d 00:00:00", 
                power: 2154900, 
                prereqs: [
                    { building: "embassy", level: "FC2" },
                    { building: "infantry_camp", level: "FC2" }
                ] 
            },
            "FC2-2": { 
                cost: { meat: 79000000, wood: 79000000, coal: 15000000, iron: 3900000, fire_crystals: 238 }, 
                time: "11d 00:00:00", 
                power: 2212300, 
                prereqs: [
                    { building: "embassy", level: "FC2" },
                    { building: "infantry_camp", level: "FC2" }
                ] 
            },
            "FC2-3": { 
                cost: { meat: 79000000, wood: 79000000, coal: 15000000, iron: 3900000, fire_crystals: 238 }, 
                time: "11d 00:00:00", 
                power: 2269700, 
                prereqs: [
                    { building: "embassy", level: "FC2" },
                    { building: "infantry_camp", level: "FC2" }
                ] 
            },
            "FC2-4": { 
                cost: { meat: 79000000, wood: 79000000, coal: 15000000, iron: 3900000, fire_crystals: 238 }, 
                time: "11d 00:00:00", 
                power: 2327100, 
                prereqs: [
                    { building: "embassy", level: "FC2" },
                    { building: "infantry_camp", level: "FC2" }
                ] 
            },
            "FC3": { 
                cost: { meat: 79000000, wood: 79000000, coal: 15000000, iron: 3900000, fire_crystals: 238 }, 
                time: "11d 00:00:00", 
                power: 2384500, 
                prereqs: [
                    { building: "embassy", level: "FC2" },
                    { building: "infantry_camp", level: "FC2" }
                ] 
            },
            "FC3-1": { 
                cost: { meat: 82000000, wood: 82000000, coal: 16000000, iron: 4100000, fire_crystals: 280 }, 
                time: "12d 00:00:00", 
                power: 2447700, 
                prereqs: [
                    { building: "embassy", level: "FC3" },
                    { building: "marksman_camp", level: "FC3" }
                ] 
            },
            "FC3-2": { 
                cost: { meat: 82000000, wood: 82000000, coal: 16000000, iron: 4100000, fire_crystals: 280 }, 
                time: "12d 00:00:00", 
                power: 2510900, 
                prereqs: [
                    { building: "embassy", level: "FC3" },
                    { building: "marksman_camp", level: "FC3" }
                ] 
            },
            "FC3-3": { 
                cost: { meat: 82000000, wood: 82000000, coal: 16000000, iron: 4100000, fire_crystals: 280 }, 
                time: "12d 00:00:00", 
                power: 2574100, 
                prereqs: [
                    { building: "embassy", level: "FC3" },
                    { building: "marksman_camp", level: "FC3" }
                ] 
            },
            "FC3-4": { 
                cost: { meat: 82000000, wood: 82000000, coal: 16000000, iron: 4100000, fire_crystals: 280 }, 
                time: "12d 00:00:00", 
                power: 2637300, 
                prereqs: [
                    { building: "embassy", level: "FC3" },
                    { building: "marksman_camp", level: "FC3" }
                ] 
            },
            "FC4": { 
                cost: { meat: 82000000, wood: 82000000, coal: 16000000, iron: 4100000, fire_crystals: 280 }, 
                time: "12d 00:00:00", 
                power: 2700500, 
                prereqs: [
                    { building: "embassy", level: "FC3" },
                    { building: "marksman_camp", level: "FC3" }
                ] 
            },
            "FC4-1": { 
                cost: { meat: 84000000, wood: 84000000, coal: 16000000, iron: 4200000, fire_crystals: 335 }, 
                time: "14d 00:00:00", 
                power: 2763700, 
                prereqs: [
                    { building: "embassy", level: "FC4" },
                    { building: "lancer_camp", level: "FC4" }
                ] 
            },
            "FC4-2": { 
                cost: { meat: 84000000, wood: 84000000, coal: 16000000, iron: 4200000, fire_crystals: 335 }, 
                time: "14d 00:00:00", 
                power: 2826900, 
                prereqs: [
                    { building: "embassy", level: "FC4" },
                    { building: "lancer_camp", level: "FC4" }
                ] 
            },
            "FC4-3": { 
                cost: { meat: 84000000, wood: 84000000, coal: 16000000, iron: 4200000, fire_crystals: 335 }, 
                time: "14d 00:00:00", 
                power: 2890100, 
                prereqs: [
                    { building: "embassy", level: "FC4" },
                    { building: "lancer_camp", level: "FC4" }
                ] 
            },
            "FC4-4": { 
                cost: { meat: 84000000, wood: 84000000, coal: 16000000, iron: 4200000, fire_crystals: 335 }, 
                time: "14d 00:00:00", 
                power: 2953300, 
                prereqs: [
                    { building: "embassy", level: "FC4" },
                    { building: "lancer_camp", level: "FC4" }
                ] 
            },
            "FC5": { 
                cost: { meat: 84000000, wood: 84000000, coal: 16000000, iron: 4200000, fire_crystals: 335 }, 
                time: "14d 00:00:00", 
                power: 3016500, 
                prereqs: [
                    { building: "embassy", level: "FC4" },
                    { building: "lancer_camp", level: "FC4" }
                ] 
            },
            "FC5-1": { 
                cost: { meat: 96000000, wood: 96000000, coal: 19000000, iron: 4800000, fire_crystals: 200, refined_fire_crystals: 10 }, 
                time: "15d 00:00:00", 
                power: 3084100, 
                prereqs: [
                    { building: "embassy", level: "FC5" },
                    { building: "infantry_camp", level: "FC5" }
                ] 
            },
            "FC5-2": { 
                cost: { meat: 96000000, wood: 96000000, coal: 19000000, iron: 4800000, fire_crystals: 200, refined_fire_crystals: 10 }, 
                time: "15d 00:00:00", 
                power: 3151700, 
                prereqs: [
                    { building: "embassy", level: "FC5" },
                    { building: "infantry_camp", level: "FC5" }
                ] 
            },
            "FC5-3": { 
                cost: { meat: 96000000, wood: 96000000, coal: 19000000, iron: 4800000, fire_crystals: 200, refined_fire_crystals: 10 }, 
                time: "15d 00:00:00", 
                power: 3219300, 
                prereqs: [
                    { building: "embassy", level: "FC5" },
                    { building: "infantry_camp", level: "FC5" }
                ] 
            },
            "FC5-4": { 
                cost: { meat: 96000000, wood: 96000000, coal: 19000000, iron: 4800000, fire_crystals: 200, refined_fire_crystals: 10 }, 
                time: "15d 00:00:00", 
                power: 3286900, 
                prereqs: [
                    { building: "embassy", level: "FC5" },
                    { building: "infantry_camp", level: "FC5" }
                ] 
            },
            "FC6": { 
                cost: { meat: 96000000, wood: 96000000, coal: 19000000, iron: 4800000, fire_crystals: 100, refined_fire_crystals: 20 }, 
                time: "15d 00:00:00", 
                power: 3354500, 
                prereqs: [
                    { building: "embassy", level: "FC5" },
                    { building: "infantry_camp", level: "FC5" }
                ] 
            },
            "FC6-1": { 
                cost: { meat: 100000000, wood: 100000000, coal: 21000000, iron: 5400000, fire_crystals: 240, refined_fire_crystals: 15 }, 
                time: "18d 00:00:00", 
                power: 3422100, 
                prereqs: [
                    { building: "embassy", level: "FC6" },
                    { building: "marksman_camp", level: "FC6" }
                ] 
            },
            "FC6-2": { 
                cost: { meat: 100000000, wood: 100000000, coal: 21000000, iron: 5400000, fire_crystals: 240, refined_fire_crystals: 15 }, 
                time: "18d 00:00:00", 
                power: 3489700, 
                prereqs: [
                    { building: "embassy", level: "FC6" },
                    { building: "marksman_camp", level: "FC6" }
                ] 
            },
            "FC6-3": { 
                cost: { meat: 100000000, wood: 100000000, coal: 21000000, iron: 5400000, fire_crystals: 240, refined_fire_crystals: 15 }, 
                time: "18d 00:00:00", 
                power: 3557300, 
                prereqs: [
                    { building: "embassy", level: "FC6" },
                    { building: "marksman_camp", level: "FC6" }
                ] 
            },
            "FC6-4": { 
                cost: { meat: 100000000, wood: 100000000, coal: 21000000, iron: 5400000, fire_crystals: 240, refined_fire_crystals: 15 }, 
                time: "18d 00:00:00", 
                power: 3624900, 
                prereqs: [
                    { building: "embassy", level: "FC6" },
                    { building: "marksman_camp", level: "FC6" }
                ] 
            },
            "FC7": { 
                cost: { meat: 100000000, wood: 100000000, coal: 21000000, iron: 5400000, fire_crystals: 120, refined_fire_crystals: 30 }, 
                time: "18d 00:00:00", 
                power: 3692500, 
                prereqs: [
                    { building: "embassy", level: "FC6" },
                    { building: "marksman_camp", level: "FC6" }
                ] 
            },
            "FC7-1": { 
                cost: { meat: 130000000, wood: 130000000, coal: 26000000, iron: 6600000, fire_crystals: 240, refined_fire_crystals: 20 }, 
                time: "20d 00:00:00", 
                power: 3760100, 
                prereqs: [
                    { building: "embassy", level: "FC7" },
                    { building: "lancer_camp", level: "FC7" }
                ] 
            },
            "FC7-2": { 
                cost: { meat: 130000000, wood: 130000000, coal: 26000000, iron: 6600000, fire_crystals: 240, refined_fire_crystals: 20 }, 
                time: "20d 00:00:00", 
                power: 3827700, 
                prereqs: [
                    { building: "embassy", level: "FC7" },
                    { building: "lancer_camp", level: "FC7" }
                ] 
            },
            "FC7-3": { 
                cost: { meat: 130000000, wood: 130000000, coal: 26000000, iron: 6600000, fire_crystals: 240, refined_fire_crystals: 20 }, 
                time: "20d 00:00:00", 
                power: 3895300, 
                prereqs: [
                    { building: "embassy", level: "FC7" },
                    { building: "lancer_camp", level: "FC7" }
                ] 
            },
            "FC7-4": { 
                cost: { meat: 130000000, wood: 130000000, coal: 26000000, iron: 6600000, fire_crystals: 240, refined_fire_crystals: 20 }, 
                time: "20d 00:00:00", 
                power: 3962900, 
                prereqs: [
                    { building: "embassy", level: "FC7" },
                    { building: "lancer_camp", level: "FC7" }
                ] 
            },
            "FC8": { 
                cost: { meat: 130000000, wood: 130000000, coal: 26000000, iron: 6600000, fire_crystals: 120, refined_fire_crystals: 40 }, 
                time: "20d 00:00:00", 
                power: 4030500, 
                prereqs: [
                    { building: "embassy", level: "FC7" },
                    { building: "lancer_camp", level: "FC7" }
                ] 
            },
            "FC8-1": { 
                cost: { meat: 140000000, wood: 140000000, coal: 29000000, iron: 7200000, fire_crystals: 280, refined_fire_crystals: 30 }, 
                time: "13d 00:00:00", 
                power: 4102900, 
                prereqs: [
                    { building: "embassy", level: "FC8" },
                    { building: "infantry_camp", level: "FC8" }
                ] 
            },
            "FC8-2": { 
                cost: { meat: 140000000, wood: 140000000, coal: 29000000, iron: 7200000, fire_crystals: 280, refined_fire_crystals: 30 }, 
                time: "13d 00:00:00", 
                power: 4175300, 
                prereqs: [
                    { building: "embassy", level: "FC8" },
                    { building: "infantry_camp", level: "FC8" }
                ] 
            },
            "FC8-3": { 
                cost: { meat: 140000000, wood: 140000000, coal: 29000000, iron: 7200000, fire_crystals: 280, refined_fire_crystals: 30 }, 
                time: "13d 00:00:00", 
                power: 4247700, 
                prereqs: [
                    { building: "embassy", level: "FC8" },
                    { building: "infantry_camp", level: "FC8" }
                ] 
            },
            "FC8-4": { 
                cost: { meat: 140000000, wood: 140000000, coal: 29000000, iron: 7200000, fire_crystals: 280, refined_fire_crystals: 30 }, 
                time: "13d 00:00:00", 
                power: 4320100, 
                prereqs: [
                    { building: "embassy", level: "FC8" },
                    { building: "infantry_camp", level: "FC8" }
                ] 
            },
            "FC9": { 
                cost: { meat: 140000000, wood: 140000000, coal: 29000000, iron: 7200000, fire_crystals: 140, refined_fire_crystals: 60 }, 
                time: "13d 00:00:00", 
                power: 4392500, 
                prereqs: [
                    { building: "embassy", level: "FC8" },
                    { building: "infantry_camp", level: "FC8" }
                ] 
            },
            "FC9-1": { 
                cost: { meat: 160000000, wood: 160000000, coal: 33000000, iron: 8400000, fire_crystals: 350, refined_fire_crystals: 70 }, 
                time: "20d 00:00:00", 
                power: 4464900, 
                prereqs: [
                    { building: "embassy", level: "FC9" },
                    { building: "marksman_camp", level: "FC9" }
                ] 
            },
            "FC9-2": { 
                cost: { meat: 160000000, wood: 160000000, coal: 33000000, iron: 8400000, fire_crystals: 350, refined_fire_crystals: 70 }, 
                time: "20d 00:00:00", 
                power: 4537300, 
                prereqs: [
                    { building: "embassy", level: "FC9" },
                    { building: "marksman_camp", level: "FC9" }
                ] 
            },
            "FC9-3": { 
                cost: { meat: 160000000, wood: 160000000, coal: 33000000, iron: 8400000, fire_crystals: 350, refined_fire_crystals: 70 }, 
                time: "20d 00:00:00", 
                power: 4609700, 
                prereqs: [
                    { building: "embassy", level: "FC9" },
                    { building: "marksman_camp", level: "FC9" }
                ] 
            },
            "FC9-4": { 
                cost: { meat: 160000000, wood: 160000000, coal: 33000000, iron: 8400000, fire_crystals: 350, refined_fire_crystals: 70 }, 
                time: "20d 00:00:00", 
                power: 4682100, 
                prereqs: [
                    { building: "embassy", level: "FC9" },
                    { building: "marksman_camp", level: "FC9" }
                ] 
            },
            "FC10": { 
                cost: { meat: 160000000, wood: 160000000, coal: 33000000, iron: 8400000, fire_crystals: 175, refined_fire_crystals: 140 }, 
                time: "20d 00:00:00", 
                power: 4754500, 
                prereqs: [
                    { building: "embassy", level: "FC9" },
                    { building: "marksman_camp", level: "FC9" }
                ] 
            }
        }
    },

    embassy: {
        name: "Embassy",
        levels: {
            1: { 
                cost: { wood: 60 }, 
                time: "00:00:02", 
                power: 440, 
                prereqs: [{ building: "furnace", level: 8 }] 
            },
            2: { 
                cost: { wood: 90 }, 
                time: "00:00:10", 
                power: 836, 
                prereqs: [{ building: "furnace", level: 8 }] 
            },
            3: { 
                cost: { wood: 400 }, 
                time: "00:01:00", 
                power: 1430, 
                prereqs: [{ building: "furnace", level: 8 }] 
            },
            4: { 
                cost: { wood: 900, coal: 180 }, 
                time: "00:02:00", 
                power: 2222, 
                prereqs: [{ building: "furnace", level: 8 }] 
            },
            5: { 
                cost: { wood: 3800, coal: 760 }, 
                time: "00:06:40", 
                power: 3410, 
                prereqs: [{ building: "furnace", level: 8 }] 
            },
            6: { 
                cost: { wood: 9600, coal: 1900, iron: 480 }, 
                time: "00:13:20", 
                power: 5192, 
                prereqs: [{ building: "furnace", level: 8 }] 
            },
            7: { 
                cost: { wood: 34000, coal: 6900, iron: 1700 }, 
                time: "00:25:00", 
                power: 7766, 
                prereqs: [{ building: "furnace", level: 8 }] 
            },
            8: { 
                cost: { wood: 63000, coal: 12000, iron: 3100 }, 
                time: "00:45:00", 
                power: 10340, 
                prereqs: [{ building: "furnace", level: 8 }] 
            },
            9: { 
                cost: { wood: 130000, coal: 26000, iron: 6500 }, 
                time: "02:00:00", 
                power: 12914, 
                prereqs: [{ building: "furnace", level: 9 }] 
            },
            10: { 
                cost: { wood: 230000, coal: 46000, iron: 11000 }, 
                time: "03:57:30", 
                power: 16654, 
                prereqs: [{ building: "furnace", level: 10 }] 
            },
            11: { 
                cost: { meat: 260000, wood: 260000, coal: 52000, iron: 13000 }, 
                time: "04:57:00", 
                power: 20394, 
                prereqs: [{ building: "furnace", level: 11 }] 
            },
            12: { 
                cost: { meat: 330000, wood: 330000, coal: 67000, iron: 16000 }, 
                time: "05:56:00", 
                power: 24134, 
                prereqs: [{ building: "furnace", level: 12 }] 
            },
            13: { 
                cost: { meat: 470000, wood: 470000, coal: 95000, iron: 23000 }, 
                time: "07:15:30", 
                power: 30448, 
                prereqs: [{ building: "furnace", level: 13 }] 
            },
            14: { 
                cost: { meat: 630000, wood: 630000, coal: 120000, iron: 31000 }, 
                time: "09:14:00", 
                power: 36762, 
                prereqs: [{ building: "furnace", level: 14 }] 
            },
            15: { 
                cost: { meat: 930000, wood: 930000, coal: 180000, iron: 46000 }, 
                time: "11:52:30", 
                power: 43076, 
                prereqs: [{ building: "furnace", level: 15 }] 
            },
            16: { 
                cost: { meat: 1100000, wood: 1100000, coal: 230000, iron: 59000 }, 
                time: "20:07:00", 
                power: 51964, 
                prereqs: [{ building: "furnace", level: 16 }] 
            },
            17: { 
                cost: { meat: 1800000, wood: 1800000, coal: 370000, iron: 93000 }, 
                time: "1d 00:08:00", 
                power: 60852, 
                prereqs: [{ building: "furnace", level: 17 }] 
            },
            18: { 
                cost: { meat: 2500000, wood: 2500000, coal: 500000, iron: 120000 }, 
                time: "1d 04:58:00", 
                power: 69740, 
                prereqs: [{ building: "furnace", level: 18 }] 
            },
            19: { 
                cost: { meat: 3100000, wood: 3100000, coal: 620000, iron: 150000 }, 
                time: "1d 19:27:00", 
                power: 82368, 
                prereqs: [{ building: "furnace", level: 19 }] 
            },
            20: { 
                cost: { meat: 4300000, wood: 4300000, coal: 860000, iron: 210000 }, 
                time: "2d 06:19:00", 
                power: 94996, 
                prereqs: [{ building: "furnace", level: 20 }] 
            },
            21: { 
                cost: { meat: 5400000, wood: 5400000, coal: 1000000, iron: 270000 }, 
                time: "2d 22:36:00", 
                power: 107624, 
                prereqs: [{ building: "furnace", level: 21 }] 
            },
            22: { 
                cost: { meat: 7200000, wood: 7200000, coal: 1400000, iron: 360000 }, 
                time: "4d 09:55:00", 
                power: 126566, 
                prereqs: [{ building: "furnace", level: 22 }] 
            },
            23: { 
                cost: { meat: 8900000, wood: 8900000, coal: 1700000, iron: 440000 }, 
                time: "6d 04:17:00", 
                power: 145508, 
                prereqs: [{ building: "furnace", level: 23 }] 
            },
            24: { 
                cost: { meat: 12000000, wood: 12000000, coal: 2400000, iron: 600000 }, 
                time: "8d 15:36:00", 
                power: 164450, 
                prereqs: [{ building: "furnace", level: 24 }] 
            },
            25: { 
                cost: { meat: 16000000, wood: 16000000, coal: 3200000, iron: 810000 }, 
                time: "12d 02:38:00", 
                power: 183392, 
                prereqs: [{ building: "furnace", level: 25 }] 
            },
            26: { 
                cost: { meat: 21000000, wood: 21000000, coal: 4200000, iron: 1000000 }, 
                time: "13d 22:14:00", 
                power: 211222, 
                prereqs: [{ building: "furnace", level: 26 }] 
            },
            27: { 
                cost: { meat: 29000000, wood: 29000000, coal: 5900000, iron: 1400000 }, 
                time: "16d 17:05:00", 
                power: 239052, 
                prereqs: [{ building: "furnace", level: 27 }] 
            },
            28: { 
                cost: { meat: 39000000, wood: 39000000, coal: 7900000, iron: 1900000 }, 
                time: "19d 05:15:00", 
                power: 266882, 
                prereqs: [{ building: "furnace", level: 28 }] 
            },
            29: { 
                cost: { meat: 49000000, wood: 49000000, coal: 9800000, iron: 2400000 }, 
                time: "22d 02:26:00", 
                power: 294712, 
                prereqs: [{ building: "furnace", level: 29 }] 
            },
            30: { 
                cost: { meat: 60000000, wood: 60000000, coal: 12000000, iron: 3000000 }, 
                time: "26d 12:32:00", 
                power: 335170, 
                prereqs: [{ building: "furnace", level: 30 }] 
            },
            "30-1": { 
                cost: { meat: 13000000, wood: 13000000, coal: 2700000, iron: 670000, fire_crystals: 33 }, 
                time: "4d 14:52:00", 
                power: 347798, 
                prereqs: [{ building: "furnace", level: "FC1" }] 
            },
            "30-2": { 
                cost: { meat: 13000000, wood: 13000000, coal: 2700000, iron: 670000, fire_crystals: 33 }, 
                time: "4d 14:52:00", 
                power: 360426, 
                prereqs: [{ building: "furnace", level: "FC1" }] 
            },
            "30-3": { 
                cost: { meat: 13000000, wood: 13000000, coal: 2700000, iron: 670000, fire_crystals: 33 }, 
                time: "4d 14:52:00", 
                power: 373054, 
                prereqs: [{ building: "furnace", level: "FC1" }] 
            },
            "30-4": { 
                cost: { meat: 13000000, wood: 13000000, coal: 2700000, iron: 670000, fire_crystals: 33 }, 
                time: "4d 14:52:00", 
                power: 385682, 
                prereqs: [{ building: "furnace", level: "FC1" }] 
            },
            "FC1": { 
                cost: { meat: 13000000, wood: 13000000, coal: 2700000, iron: 670000, fire_crystals: 33 }, 
                time: "4d 14:52:00", 
                power: 398310, 
                prereqs: [{ building: "furnace", level: "FC1" }] 
            },
            "FC1-1": { 
                cost: { meat: 14000000, wood: 14000000, coal: 2900000, iron: 720000, fire_crystals: 39 }, 
                time: "5d 22:33:00", 
                power: 410938, 
                prereqs: [{ building: "furnace", level: "FC2" }] 
            },
            "FC1-2": { 
                cost: { meat: 14000000, wood: 14000000, coal: 2900000, iron: 720000, fire_crystals: 39 }, 
                time: "5d 22:33:00", 
                power: 423566, 
                prereqs: [{ building: "furnace", level: "FC2" }] 
            },
            "FC1-3": { 
                cost: { meat: 14000000, wood: 14000000, coal: 2900000, iron: 720000, fire_crystals: 39 }, 
                time: "5d 22:33:00", 
                power: 436194, 
                prereqs: [{ building: "furnace", level: "FC2" }] 
            },
            "FC1-4": { 
                cost: { meat: 14000000, wood: 14000000, coal: 2900000, iron: 720000, fire_crystals: 39 }, 
                time: "5d 22:33:00", 
                power: 448822, 
                prereqs: [{ building: "furnace", level: "FC2" }] 
            },
            "FC2": { 
                cost: { meat: 14000000, wood: 14000000, coal: 2900000, iron: 1000000, fire_crystals: 39 }, 
                time: "5d 22:33:00", 
                power: 461450, 
                prereqs: [{ building: "furnace", level: "FC2" }] 
            },
            "FC2-1": { 
                cost: { meat: 15000000, wood: 15000000, coal: 3100000, iron: 790000, fire_crystals: 59 }, 
                time: "7d 06:14:00", 
                power: 474087, 
                prereqs: [{ building: "furnace", level: "FC3" }] 
            },
            "FC2-2": { 
                cost: { meat: 15000000, wood: 15000000, coal: 3100000, iron: 790000, fire_crystals: 59 }, 
                time: "7d 06:14:00", 
                power: 486706, 
                prereqs: [{ building: "furnace", level: "FC3" }] 
            },
            "FC2-3": { 
                cost: { meat: 15000000, wood: 15000000, coal: 3100000, iron: 790000, fire_crystals: 59 }, 
                time: "7d 06:14:00", 
                power: 499334, 
                prereqs: [{ building: "furnace", level: "FC3" }] 
            },
            "FC2-4": { 
                cost: { meat: 15000000, wood: 15000000, coal: 3100000, iron: 790000, fire_crystals: 59 }, 
                time: "7d 06:14:00", 
                power: 511962, 
                prereqs: [{ building: "furnace", level: "FC3" }] 
            },
            "FC3": { 
                cost: { meat: 15000000, wood: 15000000, coal: 3100000, iron: 790000, fire_crystals: 59 }, 
                time: "7d 06:14:00", 
                power: 524590, 
                prereqs: [{ building: "furnace", level: "FC3" }] 
            },
            "FC3-1": { 
                cost: { meat: 16000000, wood: 16000000, coal: 3200000, iron: 820000, fire_crystals: 70 }, 
                time: "7d 22:04:00", 
                power: 538494, 
                prereqs: [{ building: "furnace", level: "FC4" }] 
            },
            "FC3-2": { 
                cost: { meat: 16000000, wood: 16000000, coal: 3200000, iron: 820000, fire_crystals: 70 }, 
                time: "7d 22:04:00", 
                power: 552398, 
                prereqs: [{ building: "furnace", level: "FC4" }] 
            },
            "FC3-3": { 
                cost: { meat: 16000000, wood: 16000000, coal: 3200000, iron: 820000, fire_crystals: 70 }, 
                time: "7d 22:04:00", 
                power: 566302, 
                prereqs: [{ building: "furnace", level: "FC4" }] 
            },
            "FC3-4": { 
                cost: { meat: 16000000, wood: 16000000, coal: 3200000, iron: 820000, fire_crystals: 70 }, 
                time: "7d 22:04:00", 
                power: 580206, 
                prereqs: [{ building: "furnace", level: "FC4" }] 
            },
            "FC4": { 
                cost: { meat: 16000000, wood: 16000000, coal: 3200000, iron: 820000, fire_crystals: 70 }, 
                time: "7d 22:04:00", 
                power: 594110, 
                prereqs: [{ building: "furnace", level: "FC4" }] 
            },
            "FC4-1": { 
                cost: { meat: 16000000, wood: 16000000, coal: 3300000, iron: 840000, fire_crystals: 83 }, 
                time: "9d 05:45:00", 
                power: 608014, 
                prereqs: [{ building: "furnace", level: "FC5" }] 
            },
            "FC4-2": { 
                cost: { meat: 16000000, wood: 16000000, coal: 3300000, iron: 840000, fire_crystals: 83 }, 
                time: "9d 05:45:00", 
                power: 621918, 
                prereqs: [{ building: "furnace", level: "FC5" }] 
            },
            "FC4-3": { 
                cost: { meat: 16000000, wood: 16000000, coal: 3300000, iron: 840000, fire_crystals: 83 }, 
                time: "9d 05:45:00", 
                power: 635822, 
                prereqs: [{ building: "furnace", level: "FC5" }] 
            },
            "FC4-4": { 
                cost: { meat: 16000000, wood: 16000000, coal: 3300000, iron: 840000, fire_crystals: 83 }, 
                time: "9d 05:45:00", 
                power: 649726, 
                prereqs: [{ building: "furnace", level: "FC5" }] 
            },
            "FC5": { 
                cost: { meat: 16000000, wood: 16000000, coal: 3300000, iron: 840000, fire_crystals: 83 }, 
                time: "9d 05:45:00", 
                power: 663630, 
                prereqs: [{ building: "furnace", level: "FC5" }] 
            },
            "FC5-1": { 
                cost: { meat: 19000000, wood: 19000000, coal: 3800000, iron: 960000, fire_crystals: 50, refined_fire_crystals: 2 }, 
                time: "9d 21:36:00", 
                power: 678502, 
                prereqs: [{ building: "furnace", level: "FC6" }] 
            },
            "FC5-2": { 
                cost: { meat: 19000000, wood: 19000000, coal: 3800000, iron: 960000, fire_crystals: 50, refined_fire_crystals: 2 }, 
                time: "9d 21:36:00", 
                power: 693374, 
                prereqs: [{ building: "furnace", level: "FC6" }] 
            },
            "FC5-3": { 
                cost: { meat: 19000000, wood: 19000000, coal: 3800000, iron: 960000, fire_crystals: 50, refined_fire_crystals: 2 }, 
                time: "9d 21:36:00", 
                power: 708246, 
                prereqs: [{ building: "furnace", level: "FC6" }] 
            },
            "FC5-4": { 
                cost: { meat: 19000000, wood: 19000000, coal: 3800000, iron: 960000, fire_crystals: 50, refined_fire_crystals: 2 }, 
                time: "9d 21:36:00", 
                power: 723118, 
                prereqs: [{ building: "furnace", level: "FC6" }] 
            },
            "FC6": { 
                cost: { meat: 19000000, wood: 19000000, coal: 3800000, iron: 960000, fire_crystals: 25, refined_fire_crystals: 5 }, 
                time: "9d 21:36:00", 
                power: 737990, 
                prereqs: [{ building: "furnace", level: "FC6" }] 
            },
            "FC6-1": { 
                cost: { meat: 21000000, wood: 21000000, coal: 4300000, iron: 1000000, fire_crystals: 60, refined_fire_crystals: 3 }, 
                time: "11d 21:07:00", 
                power: 752862, 
                prereqs: [{ building: "furnace", level: "FC7" }] 
            },
            "FC6-2": { 
                cost: { meat: 21000000, wood: 21000000, coal: 4300000, iron: 1000000, fire_crystals: 60, refined_fire_crystals: 3 }, 
                time: "11d 21:07:00", 
                power: 767734, 
                prereqs: [{ building: "furnace", level: "FC7" }] 
            },
            "FC6-3": { 
                cost: { meat: 21000000, wood: 21000000, coal: 4300000, iron: 1000000, fire_crystals: 60, refined_fire_crystals: 3 }, 
                time: "11d 21:07:00", 
                power: 782606, 
                prereqs: [{ building: "furnace", level: "FC7" }] 
            },
            "FC6-4": { 
                cost: { meat: 21000000, wood: 21000000, coal: 4300000, iron: 1000000, fire_crystals: 60, refined_fire_crystals: 3 }, 
                time: "11d 21:07:00", 
                power: 797478, 
                prereqs: [{ building: "furnace", level: "FC7" }] 
            },
            "FC7": { 
                cost: { meat: 21000000, wood: 21000000, coal: 4300000, iron: 1000000, fire_crystals: 30, refined_fire_crystals: 7 }, 
                time: "11d 21:07:00", 
                power: 812350, 
                prereqs: [{ building: "furnace", level: "FC7" }] 
            },
            "FC7-1": { 
                cost: { meat: 26000000, wood: 26000000, coal: 5300000, iron: 1300000, fire_crystals: 60, refined_fire_crystals: 5 }, 
                time: "13d 04:48:00", 
                power: 827222, 
                prereqs: [{ building: "furnace", level: "FC8" }] 
            },
            "FC7-2": { 
                cost: { meat: 26000000, wood: 26000000, coal: 5300000, iron: 1300000, fire_crystals: 60, refined_fire_crystals: 5 }, 
                time: "13d 04:48:00", 
                power: 842094, 
                prereqs: [{ building: "furnace", level: "FC8" }] 
            },
            "FC7-3": { 
                cost: { meat: 26000000, wood: 26000000, coal: 5300000, iron: 1300000, fire_crystals: 60, refined_fire_crystals: 5 }, 
                time: "13d 04:48:00", 
                power: 856966, 
                prereqs: [{ building: "furnace", level: "FC8" }] 
            },
            "FC7-4": { 
                cost: { meat: 26000000, wood: 26000000, coal: 5300000, iron: 1300000, fire_crystals: 60, refined_fire_crystals: 5 }, 
                time: "13d 04:48:00", 
                power: 871838, 
                prereqs: [{ building: "furnace", level: "FC8" }] 
            },
            "FC8": { 
                cost: { meat: 26000000, wood: 26000000, coal: 5300000, iron: 1300000, fire_crystals: 30, refined_fire_crystals: 10 }, 
                time: "13d 04:48:00", 
                power: 886710, 
                prereqs: [{ building: "furnace", level: "FC8" }] 
            },
            "FC8-1": { 
                cost: { meat: 29000000, wood: 29000000, coal: 5800000, iron: 1400000, fire_crystals: 70, refined_fire_crystals: 7 }, 
                time: "8d 13:55:00", 
                power: 902638, 
                prereqs: [{ building: "furnace", level: "FC9" }] 
            },
            "FC8-2": { 
                cost: { meat: 29000000, wood: 29000000, coal: 5800000, iron: 1400000, fire_crystals: 70, refined_fire_crystals: 7 }, 
                time: "8d 13:55:00", 
                power: 918566, 
                prereqs: [{ building: "furnace", level: "FC9" }] 
            },
            "FC8-3": { 
                cost: { meat: 29000000, wood: 29000000, coal: 5800000, iron: 1400000, fire_crystals: 70, refined_fire_crystals: 7 }, 
                time: "8d 13:55:00", 
                power: 934494, 
                prereqs: [{ building: "furnace", level: "FC9" }] 
            },
            "FC8-4": { 
                cost: { meat: 29000000, wood: 29000000, coal: 5800000, iron: 1400000, fire_crystals: 70, refined_fire_crystals: 7 }, 
                time: "8d 13:55:00", 
                power: 950422, 
                prereqs: [{ building: "furnace", level: "FC9" }] 
            },
            "FC9": { 
                cost: { meat: 29000000, wood: 29000000, coal: 5800000, iron: 1400000, fire_crystals: 35, refined_fire_crystals: 15 }, 
                time: "8d 13:55:00", 
                power: 966350, 
                prereqs: [{ building: "furnace", level: "FC9" }] 
            },
            "FC9-1": { 
                cost: { meat: 33000000, wood: 33000000, coal: 6700000, iron: 1600000, fire_crystals: 87, refined_fire_crystals: 17 }, 
                time: "13d 04:48:00", 
                power: 982278, 
                prereqs: [{ building: "furnace", level: "FC10" }] 
            },
            "FC9-2": { 
                cost: { meat: 33000000, wood: 33000000, coal: 6700000, iron: 1600000, fire_crystals: 87, refined_fire_crystals: 17 }, 
                time: "13d 04:48:00", 
                power: 998206, 
                prereqs: [{ building: "furnace", level: "FC10" }] 
            },
            "FC9-3": { 
                cost: { meat: 33000000, wood: 33000000, coal: 6700000, iron: 1600000, fire_crystals: 87, refined_fire_crystals: 17 }, 
                time: "13d 04:48:00", 
                power: 1014134, 
                prereqs: [{ building: "furnace", level: "FC10" }] 
            },
            "FC9-4": { 
                cost: { meat: 33000000, wood: 33000000, coal: 6700000, iron: 1600000, fire_crystals: 87, refined_fire_crystals: 17 }, 
                time: "13d 04:48:00", 
                power: 1030062, 
                prereqs: [{ building: "furnace", level: "FC10" }] 
            },
            "FC10": { 
                cost: { meat: 33000000, wood: 33000000, coal: 6700000, iron: 1600000, fire_crystals: 43, refined_fire_crystals: 35 }, 
                time: "13d 04:48:00", 
                power: 1045990, 
                prereqs: [{ building: "furnace", level: "FC10" }] 
            }
        }
    },
    research_center: {
        name: "Research Center",
        levels: {
            1: { 
                cost: { wood: 105 }, 
                time: "00:00:02", 
                power: 440, 
                prereqs: [{ building: "furnace", level: 9 }] 
            },
            2: { 
                cost: { wood: 160 }, 
                time: "00:00:09", 
                power: 836, 
                prereqs: [{ building: "furnace", level: 9 }] 
            },
            3: { 
                cost: { wood: 725 }, 
                time: "00:00:45", 
                power: 1430, 
                prereqs: [{ building: "furnace", level: 9 }] 
            },
            4: { 
                cost: { wood: 1600, coal: 320 }, 
                time: "00:02:15", 
                power: 2222, 
                prereqs: [{ building: "furnace", level: 9 }] 
            },
            5: { 
                cost: { wood: 6800, coal: 1300 }, 
                time: "00:04:30", 
                power: 3410, 
                prereqs: [{ building: "furnace", level: 9 }] 
            },
            6: { 
                cost: { wood: 17000, coal: 3400, iron: 860 }, 
                time: "00:09:00", 
                power: 5192, 
                prereqs: [{ building: "furnace", level: 9 }] 
            },
            7: { 
                cost: { wood: 62000, coal: 12000, iron: 3100 }, 
                time: "00:18:00", 
                power: 7766, 
                prereqs: [{ building: "furnace", level: 9 }] 
            },
            8: { 
                cost: { wood: 110000, coal: 22000, iron: 5600 }, 
                time: "00:27:00", 
                power: 10340, 
                prereqs: [{ building: "furnace", level: 9 }] 
            },
            9: { 
                cost: { wood: 230000, coal: 47000, iron: 11000 }, 
                time: "00:40:30", 
                power: 12914, 
                prereqs: [{ building: "furnace", level: 9 }] 
            },
            10: { 
                cost: { wood: 410000, coal: 82000, iron: 20000 }, 
                time: "00:54:00", 
                power: 16654, 
                prereqs: [{ building: "furnace", level: 10 }] 
            },
            11: { 
                cost: { meat: 520000, wood: 520000, coal: 100000, iron: 26000 }, 
                time: "01:07:30", 
                power: 20394, 
                prereqs: [{ building: "furnace", level: 11 }] 
            },
            12: { 
                cost: { meat: 670000, wood: 670000, coal: 130000, iron: 33000 }, 
                time: "01:21:00", 
                power: 24134, 
                prereqs: [{ building: "furnace", level: 12 }] 
            },
            13: { 
                cost: { meat: 950000, wood: 950000, coal: 190000, iron: 47000 }, 
                time: "01:39:00", 
                power: 30448, 
                prereqs: [{ building: "furnace", level: 13 }] 
            },
            14: { 
                cost: { meat: 1200000, wood: 1200000, coal: 250000, iron: 63000 }, 
                time: "02:06:00", 
                power: 36762, 
                prereqs: [{ building: "furnace", level: 14 }] 
            },
            15: { 
                cost: { meat: 1800000, wood: 1800000, coal: 370000, iron: 93000 }, 
                time: "02:42:00", 
                power: 43076, 
                prereqs: [{ building: "furnace", level: 15 }] 
            },
            16: { 
                cost: { meat: 2300000, wood: 2300000, coal: 470000, iron: 110000 }, 
                time: "04:34:00", 
                power: 51964, 
                prereqs: [{ building: "furnace", level: 16 }] 
            },
            17: { 
                cost: { meat: 3700000, wood: 3700000, coal: 740000, iron: 180000 }, 
                time: "05:29:00", 
                power: 60852, 
                prereqs: [{ building: "furnace", level: 17 }] 
            },
            18: { 
                cost: { meat: 5000000, wood: 5000000, coal: 1000000, iron: 250000 }, 
                time: "06:35:00", 
                power: 69740, 
                prereqs: [{ building: "furnace", level: 18 }] 
            },
            19: { 
                cost: { meat: 6200000, wood: 6200000, coal: 1200000, iron: 310000 }, 
                time: "09:52:30", 
                power: 82368, 
                prereqs: [{ building: "furnace", level: 19 }] 
            },
            20: { 
                cost: { meat: 8600000, wood: 8600000, coal: 1700000, iron: 430000 }, 
                time: "12:20:30", 
                power: 94996, 
                prereqs: [{ building: "furnace", level: 20 }] 
            },
            21: { 
                cost: { meat: 10000000, wood: 10000000, coal: 2100000, iron: 540000 }, 
                time: "16:02:30", 
                power: 107624, 
                prereqs: [{ building: "furnace", level: 21 }] 
            },
            22: { 
                cost: { meat: 14000000, wood: 14000000, coal: 2800000, iron: 720000 }, 
                time: "1d 00:04:00", 
                power: 126566, 
                prereqs: [{ building: "furnace", level: 22 }] 
            },
            23: { 
                cost: { meat: 17000000, wood: 17000000, coal: 3500000, iron: 890000 }, 
                time: "1d 09:42:00", 
                power: 145508, 
                prereqs: [{ building: "furnace", level: 23 }] 
            },
            24: { 
                cost: { meat: 24000000, wood: 24000000, coal: 4800000, iron: 1200000 }, 
                time: "1d 23:11:00", 
                power: 164450, 
                prereqs: [{ building: "furnace", level: 24 }] 
            },
            25: { 
                cost: { meat: 32000000, wood: 32000000, coal: 6500000, iron: 1600000 }, 
                time: "2d 18:03:00", 
                power: 183392, 
                prereqs: [{ building: "furnace", level: 25 }] 
            },
            26: { 
                cost: { meat: 42000000, wood: 42000000, coal: 8400000, iron: 2100000 }, 
                time: "3d 03:57:00", 
                power: 211222, 
                prereqs: [{ building: "furnace", level: 26 }] 
            },
            27: { 
                cost: { meat: 59000000, wood: 59000000, coal: 11000000, iron: 2900000 }, 
                time: "3d 19:09:00", 
                power: 239052, 
                prereqs: [{ building: "furnace", level: 27 }] 
            },
            28: { 
                cost: { meat: 79000000, wood: 79000000, coal: 15000000, iron: 3900000 }, 
                time: "4d 08:49:00", 
                power: 266882, 
                prereqs: [{ building: "furnace", level: 28 }] 
            },
            29: { 
                cost: { meat: 98000000, wood: 98000000, coal: 19000000, iron: 4900000 }, 
                time: "5d 00:33:00", 
                power: 294712, 
                prereqs: [{ building: "furnace", level: 29 }] 
            },
            30: { 
                cost: { meat: 120000000, wood: 120000000, coal: 24000000, iron: 6000000 }, 
                time: "6d 00:40:00", 
                power: 335170, 
                prereqs: [{ building: "furnace", level: 30 }] 
            }
        }
    },
    infirmary: {
        name: "Infirmary",
        levels: {
            1: { 
                cost: {}, 
                time: "00:00:02", 
                power: 300, 
                prereqs: [{ building: "furnace", level: 8 }] 
            },
            2: { 
                cost: { wood: 100 }, 
                time: "00:00:09", 
                power: 570, 
                prereqs: [{ building: "furnace", level: 8 }] 
            },
            3: { 
                cost: { wood: 460 }, 
                time: "00:00:40", 
                power: 975, 
                prereqs: [{ building: "furnace", level: 8 }] 
            },
            4: { 
                cost: { wood: 1000, coal: 205 }, 
                time: "00:02:05", 
                power: 1515, 
                prereqs: [{ building: "furnace", level: 8 }] 
            },
            5: { 
                cost: { wood: 4300, coal: 865 }, 
                time: "00:04:10", 
                power: 2325, 
                prereqs: [{ building: "furnace", level: 8 }] 
            },
            6: { 
                cost: { wood: 10000, coal: 2100, iron: 545 }, 
                time: "00:08:20", 
                power: 3540, 
                prereqs: [{ building: "furnace", level: 8 }] 
            },
            7: { 
                cost: { wood: 39000, coal: 7800, iron: 1900 }, 
                time: "00:16:30", 
                power: 5295, 
                prereqs: [{ building: "furnace", level: 8 }] 
            },
            8: { 
                cost: { wood: 72000, coal: 14000, iron: 3600 }, 
                time: "00:25:00", 
                power: 7050, 
                prereqs: [{ building: "furnace", level: 8 }] 
            },
            9: { 
                cost: { wood: 140000, coal: 29000, iron: 7400 }, 
                time: "00:27:30", 
                power: 8805, 
                prereqs: [{ building: "furnace", level: 9 }] 
            },
            10: { 
                cost: { wood: 260000, coal: 52000, iron: 13000 }, 
                time: "00:50:00", 
                power: 11355, 
                prereqs: [{ building: "furnace", level: 10 }] 
            },
            11: { 
                cost: { meat: 320000, wood: 320000, coal: 65000, iron: 16000 }, 
                time: "01:03:00", 
                power: 13905, 
                prereqs: [{ building: "furnace", level: 11 }] 
            },
            12: { 
                cost: { meat: 420000, wood: 420000, coal: 54000, iron: 21000 }, 
                time: "01:15:30", 
                power: 16455, 
                prereqs: [{ building: "furnace", level: 12 }] 
            },
            13: { 
                cost: { meat: 590000, wood: 590000, coal: 110000, iron: 29000 }, 
                time: "01:32:00", 
                power: 20760, 
                prereqs: [{ building: "furnace", level: 13 }] 
            },
            14: { 
                cost: { meat: 780000, wood: 780000, coal: 150000, iron: 39000 }, 
                time: "01:57:30", 
                power: 25065, 
                prereqs: [{ building: "furnace", level: 14 }] 
            },
            15: { 
                cost: { meat: 1100000, wood: 1100000, coal: 230000, iron: 58000 }, 
                time: "02:31:00", 
                power: 29370, 
                prereqs: [{ building: "furnace", level: 15 }] 
            },
            16: { 
                cost: { meat: 1400000, wood: 1400000, coal: 290000, iron: 74000 }, 
                time: "04:16:00", 
                power: 35430, 
                prereqs: [{ building: "furnace", level: 16 }] 
            },
            17: { 
                cost: { meat: 2300000, wood: 2300000, coal: 460000, iron: 110000 }, 
                time: "05:07:00", 
                power: 41490, 
                prereqs: [{ building: "furnace", level: 17 }] 
            },
            18: { 
                cost: { meat: 3100000, wood: 3100000, coal: 620000, iron: 150000 }, 
                time: "06:08:30", 
                power: 47550, 
                prereqs: [{ building: "furnace", level: 18 }] 
            },
            19: { 
                cost: { meat: 3900000, wood: 3900000, coal: 780000, iron: 190000 }, 
                time: "09:13:00", 
                power: 56160, 
                prereqs: [{ building: "furnace", level: 19 }] 
            },
            20: { 
                cost: { meat: 5300000, wood: 5300000, coal: 1000000, iron: 260000 }, 
                time: "11:31:00", 
                power: 64770, 
                prereqs: [{ building: "furnace", level: 20 }] 
            },
            21: { 
                cost: { meat: 6800000, wood: 6800000, coal: 1300000, iron: 340000 }, 
                time: "14:58:30", 
                power: 73380, 
                prereqs: [{ building: "furnace", level: 21 }] 
            },
            22: { 
                cost: { meat: 9000000, wood: 9000000, coal: 1800000, iron: 450000 }, 
                time: "22:28:00", 
                power: 86295, 
                prereqs: [{ building: "furnace", level: 22 }] 
            },
            23: { 
                cost: { meat: 11000000, wood: 11000000, coal: 2200000, iron: 560000 }, 
                time: "1d 07:27:00", 
                power: 99210, 
                prereqs: [{ building: "furnace", level: 23 }] 
            },
            24: { 
                cost: { meat: 15000000, wood: 15000000, coal: 3000000, iron: 750000 }, 
                time: "1d 20:02:00", 
                power: 112125, 
                prereqs: [{ building: "furnace", level: 24 }] 
            },
            25: { 
                cost: { meat: 20000000, wood: 20000000, coal: 4000000, iron: 1000000 }, 
                time: "2d 13:39:00", 
                power: 125040, 
                prereqs: [{ building: "furnace", level: 25 }] 
            },
            26: { 
                cost: { meat: 26000000, wood: 26000000, coal: 5200000, iron: 1300000 }, 
                time: "2d 22:54:00", 
                power: 144015, 
                prereqs: [{ building: "furnace", level: 26 }] 
            },
            27: { 
                cost: { meat: 37000000, wood: 37000000, coal: 7400000, iron: 1800000 }, 
                time: "3d 13:04:00", 
                power: 162990, 
                prereqs: [{ building: "furnace", level: 27 }] 
            },
            28: { 
                cost: { meat: 49000000, wood: 49000000, coal: 9900000, iron: 2400000 }, 
                time: "4d 01:50:00", 
                power: 181965, 
                prereqs: [{ building: "furnace", level: 28 }] 
            },
            29: { 
                cost: { meat: 61000000, wood: 61000000, coal: 12000000, iron: 3000000 }, 
                time: "4d 16:31:00", 
                power: 200940, 
                prereqs: [{ building: "furnace", level: 29 }] 
            },
            30: { 
                cost: { meat: 75000000, wood: 75000000, coal: 15000000, iron: 3700000 }, 
                time: "5d 15:01:00", 
                power: 228525, 
                prereqs: [{ building: "furnace", level: 30 }] 
            },
            "30-1": { 
                cost: { meat: 16000000, wood: 16000000, coal: 3300000, iron: 840000, fire_crystals: 26 }, 
                time: "23:31:00", 
                power: 237135, 
                prereqs: [{ building: "furnace", level: "FC1" }] 
            },
            "30-2": { 
                cost: { meat: 16000000, wood: 16000000, coal: 3300000, iron: 840000, fire_crystals: 26 }, 
                time: "23:31:00", 
                power: 245745, 
                prereqs: [{ building: "furnace", level: "FC1" }] 
            },
            "30-3": { 
                cost: { meat: 16000000, wood: 16000000, coal: 3300000, iron: 840000, fire_crystals: 26 }, 
                time: "23:31:00", 
                power: 254355, 
                prereqs: [{ building: "furnace", level: "FC1" }] 
            },
            "30-4": { 
                cost: { meat: 16000000, wood: 16000000, coal: 3300000, iron: 840000, fire_crystals: 26 }, 
                time: "23:31:00", 
                power: 262965, 
                prereqs: [{ building: "furnace", level: "FC1" }] 
            },
            "FC1": { 
                cost: { meat: 16000000, wood: 16000000, coal: 3300000, iron: 840000, fire_crystals: 26 }, 
                time: "23:31:00", 
                power: 271575, 
                prereqs: [{ building: "furnace", level: "FC1" }] 
            },
            "FC1-1": { 
                cost: { meat: 18000000, wood: 18000000, coal: 3600000, iron: 900000, fire_crystals: 31 }, 
                time: "1d 06:14:00", 
                power: 280185, 
                prereqs: [{ building: "furnace", level: "FC2" }] 
            },
            "FC1-2": { 
                cost: { meat: 18000000, wood: 18000000, coal: 3600000, iron: 900000, fire_crystals: 31 }, 
                time: "1d 06:14:00", 
                power: 288795, 
                prereqs: [{ building: "furnace", level: "FC2" }] 
            },
            "FC1-3": { 
                cost: { meat: 18000000, wood: 18000000, coal: 3600000, iron: 900000, fire_crystals: 31 }, 
                time: "1d 06:14:00", 
                power: 297405, 
                prereqs: [{ building: "furnace", level: "FC2" }] 
            },
            "FC1-4": { 
                cost: { meat: 18000000, wood: 18000000, coal: 3600000, iron: 900000, fire_crystals: 31 }, 
                time: "1d 06:14:00", 
                power: 306015, 
                prereqs: [{ building: "furnace", level: "FC2" }] 
            },
            "FC2": { 
                cost: { meat: 18000000, wood: 18000000, coal: 3600000, iron: 900000, fire_crystals: 31 }, 
                time: "1d 06:14:00", 
                power: 314625, 
                prereqs: [{ building: "furnace", level: "FC2" }] 
            },
            "FC2-1": { 
                cost: { meat: 19000000, wood: 19000000, coal: 3900000, iron: 990000, fire_crystals: 47 }, 
                time: "1d 12:57:00", 
                power: 323235, 
                prereqs: [{ building: "furnace", level: "FC3" }] 
            },
            "FC2-2": { 
                cost: { meat: 19000000, wood: 19000000, coal: 3900000, iron: 990000, fire_crystals: 47 }, 
                time: "1d 12:57:00", 
                power: 331845, 
                prereqs: [{ building: "furnace", level: "FC3" }] 
            },
            "FC2-3": { 
                cost: { meat: 19000000, wood: 19000000, coal: 3900000, iron: 990000, fire_crystals: 47 }, 
                time: "1d 12:57:00", 
                power: 340455, 
                prereqs: [{ building: "furnace", level: "FC3" }] 
            },
            "FC2-4": { 
                cost: { meat: 19000000, wood: 19000000, coal: 3900000, iron: 990000, fire_crystals: 47 }, 
                time: "1d 12:57:00", 
                power: 349065, 
                prereqs: [{ building: "furnace", level: "FC3" }] 
            },
            "FC3": { 
                cost: { meat: 19000000, wood: 19000000, coal: 3900000, iron: 990000, fire_crystals: 47 }, 
                time: "1d 12:57:00", 
                power: 357675, 
                prereqs: [{ building: "furnace", level: "FC3" }] 
            },
            "FC3-1": { 
                cost: { meat: 20000000, wood: 20000000, coal: 4100000, iron: 1000000, fire_crystals: 56 }, 
                time: "1d 16:19:00", 
                power: 367155, 
                prereqs: [{ building: "furnace", level: "FC4" }] 
            },
            "FC3-2": { 
                cost: { meat: 20000000, wood: 20000000, coal: 4100000, iron: 1000000, fire_crystals: 56 }, 
                time: "1d 16:19:00", 
                power: 376635, 
                prereqs: [{ building: "furnace", level: "FC4" }] 
            },
            "FC3-3": { 
                cost: { meat: 20000000, wood: 20000000, coal: 4100000, iron: 1000000, fire_crystals: 56 }, 
                time: "1d 16:19:00", 
                power: 386115, 
                prereqs: [{ building: "furnace", level: "FC4" }] 
            },
            "FC3-4": { 
                cost: { meat: 20000000, wood: 20000000, coal: 4100000, iron: 1000000, fire_crystals: 56 }, 
                time: "1d 16:19:00", 
                power: 395595, 
                prereqs: [{ building: "furnace", level: "FC4" }] 
            },
            "FC4": { 
                cost: { meat: 20000000, wood: 20000000, coal: 4100000, iron: 1000000, fire_crystals: 56 }, 
                time: "1d 16:19:00", 
                power: 405075, 
                prereqs: [{ building: "furnace", level: "FC4" }] 
            },
            "FC4-1": { 
                cost: { meat: 21000000, wood: 21000000, coal: 4200000, iron: 1000000, fire_crystals: 67 }, 
                time: "1d 23:02:00", 
                power: 405075, 
                prereqs: [{ building: "furnace", level: "FC5" }] 
            },
            "FC4-2": { 
                cost: { meat: 21000000, wood: 21000000, coal: 4200000, iron: 1000000, fire_crystals: 67 }, 
                time: "1d 23:02:00", 
                power: 414555, 
                prereqs: [{ building: "furnace", level: "FC5" }] 
            },
            "FC4-3": { 
                cost: { meat: 21000000, wood: 21000000, coal: 4200000, iron: 1000000, fire_crystals: 67 }, 
                time: "1d 23:02:00", 
                power: 424035, 
                prereqs: [{ building: "furnace", level: "FC5" }] 
            },
            "FC4-4": { 
                cost: { meat: 21000000, wood: 21000000, coal: 4200000, iron: 1000000, fire_crystals: 67 }, 
                time: "1d 23:02:00", 
                power: 442995, 
                prereqs: [{ building: "furnace", level: "FC5" }] 
            },
            "FC5": { 
                cost: { meat: 21000000, wood: 21000000, coal: 4200000, iron: 1000000, fire_crystals: 67 }, 
                time: "1d 23:02:00", 
                power: 452475, 
                prereqs: [{ building: "furnace", level: "FC5" }] 
            },
            "FC5-1": { 
                cost: { meat: 24000000, wood: 24000000, coal: 4800000, iron: 1200000, fire_crystals: 40, refined_fire_crystals: 2 }, 
                time: "2d 02:24:00", 
                power: 462615, 
                prereqs: [{ building: "furnace", level: "FC6" }] 
            },
            "FC5-2": { 
                cost: { meat: 24000000, wood: 24000000, coal: 4800000, iron: 1200000, fire_crystals: 40, refined_fire_crystals: 2 }, 
                time: "2d 02:24:00", 
                power: 472755, 
                prereqs: [{ building: "furnace", level: "FC6" }] 
            },
            "FC5-3": { 
                cost: { meat: 24000000, wood: 24000000, coal: 4800000, iron: 1200000, fire_crystals: 40, refined_fire_crystals: 2 }, 
                time: "2d 02:24:00", 
                power: 482895, 
                prereqs: [{ building: "furnace", level: "FC6" }] 
            },
            "FC5-4": { 
                cost: { meat: 24000000, wood: 24000000, coal: 4800000, iron: 1200000, fire_crystals: 40, refined_fire_crystals: 2 }, 
                time: "2d 02:24:00", 
                power: 493035, 
                prereqs: [{ building: "furnace", level: "FC6" }] 
            },
            "FC6": { 
                cost: { meat: 24000000, wood: 24000000, coal: 4800000, iron: 1200000, fire_crystals: 20, refined_fire_crystals: 4 }, 
                time: "2d 02:24:00", 
                power: 503175, 
                prereqs: [{ building: "furnace", level: "FC6" }] 
            },
            "FC6-1": { 
                cost: { meat: 27000000, wood: 27000000, coal: 5400000, iron: 1300000, fire_crystals: 48, refined_fire_crystals: 3 }, 
                time: "2d 12:28:00", 
                power: 513315, 
                prereqs: [{ building: "furnace", level: "FC7" }] 
            },
            "FC6-2": { 
                cost: { meat: 27000000, wood: 27000000, coal: 5400000, iron: 1300000, fire_crystals: 48, refined_fire_crystals: 3 }, 
                time: "2d 12:28:00", 
                power: 523455, 
                prereqs: [{ building: "furnace", level: "FC7" }] 
            },
            "FC6-3": { 
                cost: { meat: 27000000, wood: 27000000, coal: 5400000, iron: 1300000, fire_crystals: 48, refined_fire_crystals: 3 }, 
                time: "2d 12:28:00", 
                power: 533595, 
                prereqs: [{ building: "furnace", level: "FC7" }] 
            },
            "FC6-4": { 
                cost: { meat: 27000000, wood: 27000000, coal: 5400000, iron: 1300000, fire_crystals: 48, refined_fire_crystals: 3 }, 
                time: "2d 12:28:00", 
                power: 543735, 
                prereqs: [{ building: "furnace", level: "FC7" }] 
            },
            "FC7": { 
                cost: { meat: 27000000, wood: 27000000, coal: 5400000, iron: 1300000, fire_crystals: 24, refined_fire_crystals: 6 }, 
                time: "2d 12:28:00", 
                power: 553875, 
                prereqs: [{ building: "furnace", level: "FC7" }] 
            },
            "FC7-1": { 
                cost: { meat: 33000000, wood: 33000000, coal: 6600000, iron: 1600000, fire_crystals: 48, refined_fire_crystals: 4 }, 
                time: "2d 19:12:00", 
                power: 564015, 
                prereqs: [{ building: "furnace", level: "FC8" }] 
            },
            "FC7-2": { 
                cost: { meat: 33000000, wood: 33000000, coal: 6600000, iron: 1600000, fire_crystals: 48, refined_fire_crystals: 4 }, 
                time: "2d 19:12:00", 
                power: 574155, 
                prereqs: [{ building: "furnace", level: "FC8" }] 
            },
            "FC7-3": { 
                cost: { meat: 33000000, wood: 33000000, coal: 6600000, iron: 1600000, fire_crystals: 48, refined_fire_crystals: 4 }, 
                time: "2d 19:12:00", 
                power: 584295, 
                prereqs: [{ building: "furnace", level: "FC8" }] 
            },
            "FC7-4": { 
                cost: { meat: 33000000, wood: 33000000, coal: 6600000, iron: 1600000, fire_crystals: 48, refined_fire_crystals: 4 }, 
                time: "2d 19:12:00", 
                power: 594435, 
                prereqs: [{ building: "furnace", level: "FC8" }] 
            },
            "FC8": { 
                cost: { meat: 33000000, wood: 33000000, coal: 6600000, iron: 1600000, fire_crystals: 24, refined_fire_crystals: 8 }, 
                time: "2d 19:12:00", 
                power: 604575, 
                prereqs: [{ building: "furnace", level: "FC8" }] 
            },
            "FC8-1": { 
                cost: { meat: 36000000, wood: 36000000, coal: 7200000, iron: 1800000, fire_crystals: 56, refined_fire_crystals: 6 }, 
                time: "1d 19:40:00", 
                power: 615435, 
                prereqs: [{ building: "furnace", level: "FC9" }] 
            },
            "FC8-2": { 
                cost: { meat: 36000000, wood: 36000000, coal: 7200000, iron: 1800000, fire_crystals: 56, refined_fire_crystals: 6 }, 
                time: "1d 19:40:00", 
                power: 626295, 
                prereqs: [{ building: "furnace", level: "FC9" }] 
            },
            "FC8-3": { 
                cost: { meat: 36000000, wood: 36000000, coal: 7200000, iron: 1800000, fire_crystals: 56, refined_fire_crystals: 6 }, 
                time: "1d 19:40:00", 
                power: 637155, 
                prereqs: [{ building: "furnace", level: "FC9" }] 
            },
            "FC8-4": { 
                cost: { meat: 36000000, wood: 36000000, coal: 7200000, iron: 1800000, fire_crystals: 56, refined_fire_crystals: 6 }, 
                time: "1d 19:40:00", 
                power: 648015, 
                prereqs: [{ building: "furnace", level: "FC9" }] 
            },
            "FC9": { 
                cost: { meat: 36000000, wood: 36000000, coal: 7200000, iron: 1800000, fire_crystals: 28, refined_fire_crystals: 12 }, 
                time: "1d 19:40:00", 
                power: 658875, 
                prereqs: [{ building: "furnace", level: "FC9" }] 
            },
            "FC9-1": { 
                cost: { meat: 42000000, wood: 42000000, coal: 8400000, iron: 2100000, fire_crystals: 70, refined_fire_crystals: 14 }, 
                time: "2d 19:12:00", 
                power: 669735, 
                prereqs: [{ building: "furnace", level: "FC10" }] 
            },
            "FC9-2": { 
                cost: { meat: 42000000, wood: 42000000, coal: 8400000, iron: 2100000, fire_crystals: 70, refined_fire_crystals: 14 }, 
                time: "2d 19:12:00", 
                power: 680595, 
                prereqs: [{ building: "furnace", level: "FC10" }] 
            },
            "FC9-3": { 
                cost: { meat: 42000000, wood: 42000000, coal: 8400000, iron: 2100000, fire_crystals: 70, refined_fire_crystals: 14 }, 
                time: "2d 19:12:00", 
                power: 691455, 
                prereqs: [{ building: "furnace", level: "FC10" }] 
            },
            "FC9-4": { 
                cost: { meat: 42000000, wood: 42000000, coal: 8400000, iron: 2100000, fire_crystals: 70, refined_fire_crystals: 14 }, 
                time: "2d 19:12:00", 
                power: 702315, 
                prereqs: [{ building: "furnace", level: "FC10" }] 
            },
            "FC10": { 
                cost: { meat: 42000000, wood: 42000000, coal: 8400000, iron: 2100000, fire_crystals: 35, refined_fire_crystals: 28 }, 
                time: "2d 19:12:00", 
                power: 713175, 
                prereqs: [{ building: "furnace", level: "FC10" }] 
            }
        }
    },
    academy: {
        name: "Academy",
        levels: {
            "FC1": { 
                cost: {}, 
                time: "00:00:02", 
                power: 217260, 
                prereqs: [{ building: "furnace", level: "FC1" }] 
            },
            "FC1-1": { 
                cost: { meat: 36000000, wood: 36000000, coal: 7200000, iron: 1800000, fire_crystals: 71 }, 
                time: "1d 19:12:00", 
                power: 224148, 
                prereqs: [{ building: "furnace", level: "FC2" }] 
            },
            "FC1-2": { 
                cost: { meat: 36000000, wood: 36000000, coal: 7200000, iron: 1800000, fire_crystals: 71 }, 
                time: "1d 19:12:00", 
                power: 231036, 
                prereqs: [{ building: "furnace", level: "FC2" }] 
            },
            "FC1-3": { 
                cost: { meat: 36000000, wood: 36000000, coal: 7200000, iron: 1800000, fire_crystals: 71 }, 
                time: "1d 19:12:00", 
                power: 237924, 
                prereqs: [{ building: "furnace", level: "FC2" }] 
            },
            "FC1-4": { 
                cost: { meat: 36000000, wood: 36000000, coal: 7200000, iron: 1800000, fire_crystals: 71 }, 
                time: "1d 19:12:00", 
                power: 244812, 
                prereqs: [{ building: "furnace", level: "FC2" }] 
            },
            "FC2": { 
                cost: { meat: 36000000, wood: 36000000, coal: 7200000, iron: 1800000, fire_crystals: 71 }, 
                time: "1d 19:12:00", 
                power: 251700, 
                prereqs: [{ building: "furnace", level: "FC2" }] 
            },
            "FC2-1": { 
                cost: { meat: 39000000, wood: 39000000, coal: 7900000, iron: 1900000, fire_crystals: 107 }, 
                time: "2d 04:48:00", 
                power: 258588, 
                prereqs: [{ building: "furnace", level: "FC3" }] 
            },
            "FC2-2": { 
                cost: { meat: 39000000, wood: 39000000, coal: 7900000, iron: 1900000, fire_crystals: 107 }, 
                time: "2d 04:48:00", 
                power: 265476, 
                prereqs: [{ building: "furnace", level: "FC3" }] 
            },
            "FC2-3": { 
                cost: { meat: 39000000, wood: 39000000, coal: 7900000, iron: 1900000, fire_crystals: 107 }, 
                time: "2d 04:48:00", 
                power: 272364, 
                prereqs: [{ building: "furnace", level: "FC3" }] 
            },
            "FC2-4": { 
                cost: { meat: 39000000, wood: 39000000, coal: 7900000, iron: 1900000, fire_crystals: 107 }, 
                time: "2d 04:48:00", 
                power: 279252, 
                prereqs: [{ building: "furnace", level: "FC3" }] 
            },
            "FC3": { 
                cost: { meat: 39000000, wood: 39000000, coal: 7900000, iron: 1900000, fire_crystals: 107 }, 
                time: "2d 04:48:00", 
                power: 286140, 
                prereqs: [{ building: "furnace", level: "FC3" }] 
            },
            "FC3-1": { 
                cost: { meat: 41000000, wood: 41000000, coal: 8200000, iron: 2000000, fire_crystals: 126 }, 
                time: "2d 09:36:00", 
                power: 293724, 
                prereqs: [{ building: "furnace", level: "FC4" }] 
            },
            "FC3-2": { 
                cost: { meat: 41000000, wood: 41000000, coal: 8200000, iron: 2000000, fire_crystals: 126 }, 
                time: "2d 09:36:00", 
                power: 301308, 
                prereqs: [{ building: "furnace", level: "FC4" }] 
            },
            "FC3-3": { 
                cost: { meat: 41000000, wood: 41000000, coal: 8200000, iron: 2000000, fire_crystals: 126 }, 
                time: "2d 09:36:00", 
                power: 308892, 
                prereqs: [{ building: "furnace", level: "FC4" }] 
            },
            "FC3-4": { 
                cost: { meat: 41000000, wood: 41000000, coal: 8200000, iron: 2000000, fire_crystals: 126 }, 
                time: "2d 09:36:00", 
                power: 316476, 
                prereqs: [{ building: "furnace", level: "FC4" }] 
            },
            "FC4": { 
                cost: { meat: 41000000, wood: 41000000, coal: 8200000, iron: 2000000, fire_crystals: 126 }, 
                time: "2d 09:36:00", 
                power: 324060, 
                prereqs: [{ building: "furnace", level: "FC4" }] 
            },
            "FC4-1": { 
                cost: { meat: 42000000, wood: 42000000, coal: 8200000, iron: 2100000, fire_crystals: 150 }, 
                time: "2d 19:12:00", 
                power: 331644, 
                prereqs: [{ building: "furnace", level: "FC5" }] 
            },
            "FC4-2": { 
                cost: { meat: 42000000, wood: 42000000, coal: 8200000, iron: 2100000, fire_crystals: 150 }, 
                time: "2d 19:12:00", 
                power: 339228, 
                prereqs: [{ building: "furnace", level: "FC5" }] 
            },
            "FC4-3": { 
                cost: { meat: 42000000, wood: 42000000, coal: 8200000, iron: 2100000, fire_crystals: 150 }, 
                time: "2d 19:12:00", 
                power: 346812, 
                prereqs: [{ building: "furnace", level: "FC5" }] 
            },
            "FC4-4": { 
                cost: { meat: 42000000, wood: 42000000, coal: 8200000, iron: 2100000, fire_crystals: 150 }, 
                time: "2d 19:12:00", 
                power: 354396, 
                prereqs: [{ building: "furnace", level: "FC5" }] 
            },
            "FC5": { 
                cost: { meat: 42000000, wood: 42000000, coal: 8200000, iron: 2100000, fire_crystals: 150 }, 
                time: "2d 19:12:00", 
                power: 361980, 
                prereqs: [{ building: "furnace", level: "FC5" }] 
            },
            "FC5-1": { 
                cost: { meat: 48000000, wood: 48000000, coal: 9600000, iron: 2400000, fire_crystals: 90, refined_fire_crystals: 4 }, 
                time: "3d 00:00:00", 
                power: 370092, 
                prereqs: [{ building: "furnace", level: "FC6" }] 
            },
            "FC5-2": { 
                cost: { meat: 48000000, wood: 48000000, coal: 9600000, iron: 2400000, fire_crystals: 90, refined_fire_crystals: 4 }, 
                time: "3d 00:00:00", 
                power: 378204, 
                prereqs: [{ building: "furnace", level: "FC6" }] 
            },
            "FC5-3": { 
                cost: { meat: 48000000, wood: 48000000, coal: 9600000, iron: 2400000, fire_crystals: 90, refined_fire_crystals: 4 }, 
                time: "3d 00:00:00", 
                power: 386316, 
                prereqs: [{ building: "furnace", level: "FC6" }] 
            },
            "FC5-4": { 
                cost: { meat: 48000000, wood: 48000000, coal: 9600000, iron: 2400000, fire_crystals: 90, refined_fire_crystals: 4 }, 
                time: "3d 00:00:00", 
                power: 394428, 
                prereqs: [{ building: "furnace", level: "FC6" }] 
            },
            "FC6": { 
                cost: { meat: 48000000, wood: 48000000, coal: 9600000, iron: 2400000, fire_crystals: 45, refined_fire_crystals: 9 }, 
                time: "3d 00:00:00", 
                power: 402540, 
                prereqs: [{ building: "furnace", level: "FC6" }] 
            },
            "FC6-1": { 
                cost: { meat: 54000000, wood: 54000000, coal: 10000000, iron: 2700000, fire_crystals: 108, refined_fire_crystals: 6 }, 
                time: "3d 14:24:00", 
                power: 410652, 
                prereqs: [{ building: "furnace", level: "FC7" }] 
            },
            "FC6-2": { 
                cost: { meat: 54000000, wood: 54000000, coal: 10000000, iron: 2700000, fire_crystals: 108, refined_fire_crystals: 6 }, 
                time: "3d 14:24:00", 
                power: 418764, 
                prereqs: [{ building: "furnace", level: "FC7" }] 
            },
            "FC6-3": { 
                cost: { meat: 54000000, wood: 54000000, coal: 10000000, iron: 2700000, fire_crystals: 108, refined_fire_crystals: 6 }, 
                time: "3d 14:24:00", 
                power: 426876, 
                prereqs: [{ building: "furnace", level: "FC7" }] 
            },
            "FC6-4": { 
                cost: { meat: 54000000, wood: 54000000, coal: 10000000, iron: 2700000, fire_crystals: 108, refined_fire_crystals: 6 }, 
                time: "3d 14:24:00", 
                power: 434988, 
                prereqs: [{ building: "furnace", level: "FC7" }] 
            },
            "FC7": { 
                cost: { meat: 54000000, wood: 54000000, coal: 10000000, iron: 2700000, fire_crystals: 54, refined_fire_crystals: 13 }, 
                time: "3d 14:24:00", 
                power: 443100, 
                prereqs: [{ building: "furnace", level: "FC7" }] 
            },
            "FC7-1": { 
                cost: { meat: 66000000, wood: 66000000, coal: 13000000, iron: 3300000, fire_crystals: 108, refined_fire_crystals: 9 }, 
                time: "4d 00:00:00", 
                power: 451212, 
                prereqs: [{ building: "furnace", level: "FC8" }] 
            },
            "FC7-2": { 
                cost: { meat: 66000000, wood: 66000000, coal: 13000000, iron: 3300000, fire_crystals: 108, refined_fire_crystals: 9 }, 
                time: "4d 00:00:00", 
                power: 459324, 
                prereqs: [{ building: "furnace", level: "FC8" }] 
            },
            "FC7-3": { 
                cost: { meat: 66000000, wood: 66000000, coal: 13000000, iron: 3300000, fire_crystals: 108, refined_fire_crystals: 9 }, 
                time: "4d 00:00:00", 
                power: 467436, 
                prereqs: [{ building: "furnace", level: "FC8" }] 
            },
            "FC7-4": { 
                cost: { meat: 66000000, wood: 66000000, coal: 13000000, iron: 3300000, fire_crystals: 108, refined_fire_crystals: 9 }, 
                time: "4d 00:00:00", 
                power: 475548, 
                prereqs: [{ building: "furnace", level: "FC8" }] 
            },
            "FC8": { 
                cost: { meat: 66000000, wood: 66000000, coal: 13000000, iron: 3300000, fire_crystals: 108, refined_fire_crystals: 9 }, 
                time: "4d 00:00:00", 
                power: 483660, 
                prereqs: [{ building: "furnace", level: "FC8" }] 
            },
            "FC8-1": { 
                cost: { meat: 72000000, wood: 72000000, coal: 14000000, iron: 3600000, fire_crystals: 126, refined_fire_crystals: 13 }, 
                time: "2d 14:24:00", 
                power: 492348, 
                prereqs: [{ building: "furnace", level: "FC9" }] 
            },
            "FC8-2": { 
                cost: { meat: 72000000, wood: 72000000, coal: 14000000, iron: 3600000, fire_crystals: 126, refined_fire_crystals: 13 }, 
                time: "2d 14:24:00", 
                power: 501036, 
                prereqs: [{ building: "furnace", level: "FC9" }] 
            },
            "FC8-3": { 
                cost: { meat: 72000000, wood: 72000000, coal: 14000000, iron: 3600000, fire_crystals: 126, refined_fire_crystals: 13 }, 
                time: "2d 14:24:00", 
                power: 509724, 
                prereqs: [{ building: "furnace", level: "FC9" }] 
            },
            "FC8-4": { 
                cost: { meat: 72000000, wood: 72000000, coal: 14000000, iron: 3600000, fire_crystals: 126, refined_fire_crystals: 13 }, 
                time: "2d 14:24:00", 
                power: 518412, 
                prereqs: [{ building: "furnace", level: "FC9" }] 
            },
            "FC9": { 
                cost: { meat: 72000000, wood: 72000000, coal: 14000000, iron: 3600000, fire_crystals: 63, refined_fire_crystals: 27 }, 
                time: "2d 14:24:00", 
                power: 527100, 
                prereqs: [{ building: "furnace", level: "FC9" }] 
            },
            "FC9-1": { 
                cost: { meat: 84000000, wood: 84000000, coal: 16000000, iron: 7200000, fire_crystals: 157, refined_fire_crystals: 31 }, 
                time: "4d 00:00:00", 
                power: 535788, 
                prereqs: [{ building: "furnace", level: "FC10" }] 
            },
            "FC9-2": { 
                cost: { meat: 84000000, wood: 84000000, coal: 16000000, iron: 7200000, fire_crystals: 157, refined_fire_crystals: 31 }, 
                time: "4d 00:00:00", 
                power: 544476, 
                prereqs: [{ building: "furnace", level: "FC10" }] 
            },
            "FC9-3": { 
                cost: { meat: 84000000, wood: 84000000, coal: 16000000, iron: 7200000, fire_crystals: 157, refined_fire_crystals: 31 }, 
                time: "4d 00:00:00", 
                power: 553164, 
                prereqs: [{ building: "furnace", level: "FC10" }] 
            },
            "FC9-4": { 
                cost: { meat: 84000000, wood: 84000000, coal: 16000000, iron: 7200000, fire_crystals: 157, refined_fire_crystals: 31 }, 
                time: "4d 00:00:00", 
                power: 561852, 
                prereqs: [{ building: "furnace", level: "FC10" }] 
            },
            "FC10": { 
                cost: { meat: 84000000, wood: 84000000, coal: 16000000, iron: 7200000, fire_crystals: 78, refined_fire_crystals: 63 }, 
                time: "4d 00:00:00", 
                power: 570540, 
                prereqs: [{ building: "furnace", level: "FC10" }] 
            }
        }
    },
    command_center: {
        name: "Command Center",
        levels: {
            1: { 
                cost: { wood: 80 }, 
                time: "00:00:02", 
                power: 280, 
                prereqs: [{ building: "furnace", level: 10 }, { building: "embassy", level: 1 }] 
            },
            2: { 
                cost: { wood: 125 }, 
                time: "00:00:08", 
                power: 532, 
                prereqs: [{ building: "furnace", level: 10 }, { building: "embassy", level: 2 }] 
            },
            3: { 
                cost: { wood: 565 }, 
                time: "00:00:35", 
                power: 910, 
                prereqs: [{ building: "furnace", level: 10 }, { building: "embassy", level: 3 }] 
            },
            4: { 
                cost: { wood: 1200, coal: 250 }, 
                time: "00:01:45", 
                power: 1414, 
                prereqs: [{ building: "furnace", level: 10 }, { building: "embassy", level: 4 }] 
            },
            5: { 
                cost: { wood: 5300, coal: 1000 }, 
                time: "00:03:35", 
                power: 2170, 
                prereqs: [{ building: "furnace", level: 10 }, { building: "embassy", level: 5 }] 
            },
            6: { 
                cost: { wood: 13000, coal: 2600, iron: 670 }, 
                time: "00:07:10", 
                power: 3304, 
                prereqs: [{ building: "furnace", level: 10 }, { building: "embassy", level: 6 }] 
            },
            7: { 
                cost: { wood: 48000, coal: 9600, iron: 2400 }, 
                time: "00:14:00", 
                power: 4942, 
                prereqs: [{ building: "furnace", level: 10 }, { building: "embassy", level: 7 }] 
            },
            8: { 
                cost: { wood: 88000, coal: 17000, iron: 4400 }, 
                time: "00:21:00", 
                power: 6580, 
                prereqs: [{ building: "furnace", level: 10 }, { building: "embassy", level: 8 }] 
            },
            9: { 
                cost: { wood: 180000, coal: 36000, iron: 9100 }, 
                time: "00:32:00", 
                power: 8218, 
                prereqs: [{ building: "furnace", level: 10 }, { building: "embassy", level: 9 }] 
            },
            10: { 
                cost: { wood: 320000, coal: 64000, iron: 16000 }, 
                time: "00:43:00", 
                power: 10598, 
                prereqs: [{ building: "furnace", level: 10 }, { building: "embassy", level: 10 }] 
            },
            11: { 
                cost: { meat: 390000, wood: 390000, coal: 79000, iron: 19000 }, 
                time: "00:54:00", 
                power: 12978, 
                prereqs: [{ building: "furnace", level: 11 }, { building: "embassy", level: 11 }] 
            },
            12: { 
                cost: { meat: 500000, wood: 500000, coal: 100000, iron: 25000 }, 
                time: "01:04:30", 
                power: 15358, 
                prereqs: [{ building: "furnace", level: 12 }, { building: "embassy", level: 12 }] 
            },
            13: { 
                cost: { meat: 710000, wood: 710000, coal: 140000, iron: 35000 }, 
                time: "01:19:00", 
                power: 19376, 
                prereqs: [{ building: "furnace", level: 13 }, { building: "embassy", level: 13 }] 
            },
            14: { 
                cost: { meat: 940000, wood: 940000, coal: 180000, iron: 47000 }, 
                time: "01:40:30", 
                power: 23394, 
                prereqs: [{ building: "furnace", level: 14 }, { building: "embassy", level: 14 }] 
            },
            15: { 
                cost: { meat: 1300000, wood: 1300000, coal: 270000, iron: 69000 }, 
                time: "02:09:30", 
                power: 27412, 
                prereqs: [{ building: "furnace", level: 15 }, { building: "embassy", level: 15 }] 
            },
            16: { 
                cost: { meat: 1700000, wood: 1700000, coal: 350000, iron: 89000 }, 
                time: "03:39:00", 
                power: 33068, 
                prereqs: [{ building: "furnace", level: 16 }, { building: "embassy", level: 16 }] 
            },
            17: { 
                cost: { meat: 2700000, wood: 2700000, coal: 550000, iron: 130000 }, 
                time: "04:23:00", 
                power: 38724, 
                prereqs: [{ building: "furnace", level: 17 }, { building: "embassy", level: 17 }] 
            },
            18: { 
                cost: { meat: 3700000, wood: 3700000, coal: 750000, iron: 180000 }, 
                time: "05:16:00", 
                power: 44380, 
                prereqs: [{ building: "furnace", level: 18 }, { building: "embassy", level: 18 }] 
            },
            19: { 
                cost: { meat: 4700000, wood: 4700000, coal: 940000, iron: 230000 }, 
                time: "07:54:00", 
                power: 52416, 
                prereqs: [{ building: "furnace", level: 19 }, { building: "embassy", level: 19 }] 
            },
            20: { 
                cost: { meat: 6400000, wood: 6400000, coal: 1200000, iron: 320000 }, 
                time: "09:52:30", 
                power: 60452, 
                prereqs: [{ building: "furnace", level: 20 }, { building: "embassy", level: 20 }] 
            },
            21: { 
                cost: { meat: 8100000, wood: 8100000, coal: 1600000, iron: 400000 }, 
                time: "12:50:00", 
                power: 68488, 
                prereqs: [{ building: "furnace", level: 21 }, { building: "embassy", level: 21 }] 
            },
            22: { 
                cost: { meat: 10000000, wood: 10000000, coal: 2100000, iron: 540000 }, 
                time: "19:15:30", 
                power: 80542, 
                prereqs: [{ building: "furnace", level: 22 }, { building: "embassy", level: 22 }] 
            },
            23: { 
                cost: { meat: 13000000, wood: 13000000, coal: 2600000, iron: 670000 }, 
                time: "1d 02:57:00", 
                power: 92596, 
                prereqs: [{ building: "furnace", level: 23 }, { building: "embassy", level: 23 }] 
            },
            24: { 
                cost: { meat: 18000000, wood: 18000000, coal: 3600000, iron: 900000 }, 
                time: "1d 13:44:00", 
                power: 104650, 
                prereqs: [{ building: "furnace", level: 24 }, { building: "embassy", level: 24 }] 
            },
            25: { 
                cost: { meat: 24000000, wood: 24000000, coal: 4900000, iron: 1200000 }, 
                time: "2d 04:50:00", 
                power: 116704, 
                prereqs: [{ building: "furnace", level: 25 }, { building: "embassy", level: 25 }] 
            },
            26: { 
                cost: { meat: 31000000, wood: 31000000, coal: 6300000, iron: 1500000 }, 
                time: "2d 12:46:00", 
                power: 134414, 
                prereqs: [{ building: "furnace", level: 26 }, { building: "embassy", level: 26 }] 
            },
            27: { 
                cost: { meat: 44000000, wood: 44000000, coal: 8900000, iron: 2200000 }, 
                time: "3d 00:55:00", 
                power: 152124, 
                prereqs: [{ building: "furnace", level: 27 }, { building: "embassy", level: 27 }] 
            },
            28: { 
                cost: { meat: 59000000, wood: 59000000, coal: 11000000, iron: 2900000 }, 
                time: "3d 11:51:00", 
                power: 169834, 
                prereqs: [{ building: "furnace", level: 28 }, { building: "embassy", level: 28 }] 
            },
            29: { 
                cost: { meat: 73000000, wood: 73000000, coal: 18000000, iron: 4500000 }, 
                time: "4d 00:26:00", 
                power: 187544, 
                prereqs: [{ building: "furnace", level: 29 }, { building: "embassy", level: 29 }] 
            },
            30: { 
                cost: { meat: 90000000, wood: 90000000, coal: 18000000, iron: 4500000 }, 
                time: "4d 19:44:00", 
                power: 213290, 
                prereqs: [{ building: "furnace", level: 30 }, { building: "embassy", level: 30 }] 
            },
            "30-1": { 
                cost: { meat: 20000000, wood: 20000000, coal: 4000000, iron: 1000000, fire_crystals: 26 }, 
                time: "20:09:30", 
                power: 221326, 
                prereqs: [{ building: "embassy", level: "FC1" }, { building: "furnace", level: "FC1" }] 
            },
            "30-2": { 
                cost: { meat: 20000000, wood: 20000000, coal: 4000000, iron: 1000000, fire_crystals: 26 }, 
                time: "20:09:30", 
                power: 229362, 
                prereqs: [{ building: "embassy", level: "FC1" }, { building: "furnace", level: "FC1" }] 
            },
            "30-3": { 
                cost: { meat: 20000000, wood: 20000000, coal: 4000000, iron: 1000000, fire_crystals: 26 }, 
                time: "20:09:30", 
                power: 237398, 
                prereqs: [{ building: "embassy", level: "FC1" }, { building: "furnace", level: "FC1" }] 
            },
            "30-4": { 
                cost: { meat: 20000000, wood: 20000000, coal: 4000000, iron: 1000000, fire_crystals: 26 }, 
                time: "20:09:30", 
                power: 245434, 
                prereqs: [{ building: "embassy", level: "FC1" }, { building: "furnace", level: "FC1" }] 
            },
            "FC1": { 
                cost: { meat: 20000000, wood: 20000000, coal: 4000000, iron: 1000000, fire_crystals: 26 }, 
                time: "20:09:30", 
                power: 253470, 
                prereqs: [{ building: "embassy", level: "FC1" }, { building: "furnace", level: "FC1" }] 
            },
            "FC1-1": { 
                cost: { meat: 21000000, wood: 21000000, coal: 4300000, iron: 1000000, fire_crystals: 31 }, 
                time: "1d 01:55:00", 
                power: 261506, 
                prereqs: [{ building: "embassy", level: "FC2" }, { building: "furnace", level: "FC2" }] 
            },
            "FC1-2": { 
                cost: { meat: 21000000, wood: 21000000, coal: 4300000, iron: 1000000, fire_crystals: 31 }, 
                time: "1d 01:55:00", 
                power: 269542, 
                prereqs: [{ building: "embassy", level: "FC2" }, { building: "furnace", level: "FC2" }] 
            },
            "FC1-3": { 
                cost: { meat: 21000000, wood: 21000000, coal: 4300000, iron: 1000000, fire_crystals: 31 }, 
                time: "1d 01:55:00", 
                power: 277578, 
                prereqs: [{ building: "embassy", level: "FC2" }, { building: "furnace", level: "FC2" }] 
            },
            "FC1-4": { 
                cost: { meat: 21000000, wood: 21000000, coal: 4300000, iron: 1000000, fire_crystals: 31 }, 
                time: "1d 01:55:00", 
                power: 285614, 
                prereqs: [{ building: "embassy", level: "FC2" }, { building: "furnace", level: "FC2" }] 
            },
            "FC2": { 
                cost: { meat: 21000000, wood: 21000000, coal: 4300000, iron: 1000000, fire_crystals: 31 }, 
                time: "1d 01:55:00", 
                power: 293650, 
                prereqs: [{ building: "embassy", level: "FC2" }, { building: "furnace", level: "FC2" }] 
            },
            "FC2-1": { 
                cost: { meat: 23000000, wood: 23000000, coal: 4700000, iron: 1100000, fire_crystals: 47 }, 
                time: "1d 07:40:00", 
                power: 301686, 
                prereqs: [{ building: "embassy", level: "FC3" }, { building: "furnace", level: "FC3" }] 
            },
            "FC2-2": { 
                cost: { meat: 23000000, wood: 23000000, coal: 4700000, iron: 1100000, fire_crystals: 47 }, 
                time: "1d 07:40:00", 
                power: 309722, 
                prereqs: [{ building: "embassy", level: "FC3" }, { building: "furnace", level: "FC3" }] 
            },
            "FC2-3": { 
                cost: { meat: 23000000, wood: 23000000, coal: 4700000, iron: 1100000, fire_crystals: 47 }, 
                time: "1d 07:40:00", 
                power: 317758, 
                prereqs: [{ building: "embassy", level: "FC3" }, { building: "furnace", level: "FC3" }] 
            },
            "FC2-4": { 
                cost: { meat: 23000000, wood: 23000000, coal: 4700000, iron: 1100000, fire_crystals: 47 }, 
                time: "1d 07:40:00", 
                power: 325794, 
                prereqs: [{ building: "embassy", level: "FC3" }, { building: "furnace", level: "FC3" }] 
            },
            "FC3": { 
                cost: { meat: 23000000, wood: 23000000, coal: 4700000, iron: 1100000, fire_crystals: 47 }, 
                time: "1d 07:40:00", 
                power: 333830, 
                prereqs: [{ building: "embassy", level: "FC3" }, { building: "furnace", level: "FC3" }] 
            },
            "FC3-1": { 
                cost: { meat: 24000000, wood: 24000000, coal: 4900000, iron: 1200000, fire_crystals: 56 }, 
                time: "1d 10:33:00", 
                power: 342678, 
                prereqs: [{ building: "embassy", level: "FC4" }, { building: "furnace", level: "FC4" }] 
            },
            "FC3-2": { 
                cost: { meat: 24000000, wood: 24000000, coal: 4900000, iron: 1200000, fire_crystals: 56 }, 
                time: "1d 10:33:00", 
                power: 351526, 
                prereqs: [{ building: "embassy", level: "FC4" }, { building: "furnace", level: "FC3" }] 
            },
            "FC3-3": { 
                cost: { meat: 24000000, wood: 24000000, coal: 4900000, iron: 1200000, fire_crystals: 56 }, 
                time: "1d 10:33:00", 
                power: 360374, 
                prereqs: [{ building: "embassy", level: "FC4" }, { building: "furnace", level: "FC3" }] 
            },
            "FC3-4": { 
                cost: { meat: 24000000, wood: 24000000, coal: 4900000, iron: 1200000, fire_crystals: 56 }, 
                time: "1d 10:33:00", 
                power: 369222, 
                prereqs: [{ building: "embassy", level: "FC4" }, { building: "furnace", level: "FC3" }] 
            },
            "FC4": { 
                cost: { meat: 24000000, wood: 24000000, coal: 4900000, iron: 1200000, fire_crystals: 56 }, 
                time: "1d 10:33:00", 
                power: 378070, 
                prereqs: [{ building: "embassy", level: "FC4" }, { building: "furnace", level: "FC3" }] 
            },
            "FC4-1": { 
                cost: { meat: 25000000, wood: 25000000, coal: 5000000, iron: 1200000, fire_crystals: 67 }, 
                time: "1d 16:31:00", 
                power: 386918, 
                prereqs: [{ building: "embassy", level: "FC5" }, { building: "furnace", level: "FC5" }] 
            },
            "FC4-2": { 
                cost: { meat: 25000000, wood: 25000000, coal: 5000000, iron: 1200000, fire_crystals: 67 }, 
                time: "1d 16:31:00", 
                power: 395766, 
                prereqs: [{ building: "embassy", level: "FC5" }, { building: "furnace", level: "FC5" }] 
            },
            "FC4-3": { 
                cost: { meat: 25000000, wood: 25000000, coal: 5000000, iron: 1200000, fire_crystals: 67 }, 
                time: "1d 16:31:00", 
                power: 404614, 
                prereqs: [{ building: "embassy", level: "FC5" }, { building: "furnace", level: "FC5" }] 
            },
            "FC4-4": { 
                cost: { meat: 25000000, wood: 25000000, coal: 5000000, iron: 1200000, fire_crystals: 67 }, 
                time: "1d 16:31:00", 
                power: 413462, 
                prereqs: [{ building: "embassy", level: "FC5" }, { building: "furnace", level: "FC5" }] 
            },
            "FC5": { 
                cost: { meat: 25000000, wood: 25000000, coal: 5000000, iron: 1200000, fire_crystals: 67 }, 
                time: "1d 16:31:00", 
                power: 422310, 
                prereqs: [{ building: "embassy", level: "FC5" }, { building: "furnace", level: "FC5" }] 
            },
            "FC5-1": { 
                cost: { meat: 29000000, wood: 29000000, coal: 5800000, iron: 1400000, fire_crystals: 40, refined_fire_crystals: 2 }, 
                time: "1d 19:12:00", 
                power: 431774, 
                prereqs: [{ building: "embassy", level: "FC6" }, { building: "furnace", level: "FC6" }] 
            },
            "FC5-2": { 
                cost: { meat: 29000000, wood: 29000000, coal: 5800000, iron: 1400000, fire_crystals: 40, refined_fire_crystals: 2 }, 
                time: "1d 19:12:00", 
                power: 441238, 
                prereqs: [{ building: "embassy", level: "FC6" }, { building: "furnace", level: "FC6" }] 
            },
            "FC5-3": { 
                cost: { meat: 29000000, wood: 29000000, coal: 5800000, iron: 1400000, fire_crystals: 40, refined_fire_crystals: 2 }, 
                time: "1d 19:12:00", 
                power: 450702, 
                prereqs: [{ building: "embassy", level: "FC6" }, { building: "furnace", level: "FC6" }] 
            },
            "FC5-4": { 
                cost: { meat: 29000000, wood: 29000000, coal: 5800000, iron: 1400000, fire_crystals: 40, refined_fire_crystals: 2 }, 
                time: "1d 19:12:00", 
                power: 460166, 
                prereqs: [{ building: "embassy", level: "FC6" }, { building: "furnace", level: "FC6" }] 
            },
            "FC6": { 
                cost: { meat: 29000000, wood: 29000000, coal: 5800000, iron: 1400000, fire_crystals: 20, refined_fire_crystals: 4 }, 
                time: "1d 19:12:00", 
                power: 469630, 
                prereqs: [{ building: "embassy", level: "FC6" }, { building: "furnace", level: "FC6" }] 
            },
            "FC6-1": { 
                cost: { meat: 32000000, wood: 32000000, coal: 6500000, iron: 1500000, fire_crystals: 48, refined_fire_crystals: 3 }, 
                time: "2d 01:30:00", 
                power: 479094, 
                prereqs: [{ building: "embassy", level: "FC7" }, { building: "furnace", level: "FC7" }] 
            },
            "FC6-2": { 
                cost: { meat: 32000000, wood: 32000000, coal: 6500000, iron: 1500000, fire_crystals: 48, refined_fire_crystals: 3 }, 
                time: "2d 01:30:00", 
                power: 488558, 
                prereqs: [{ building: "embassy", level: "FC7" }, { building: "furnace", level: "FC7" }] 
            },
            "FC6-3": { 
                cost: { meat: 32000000, wood: 32000000, coal: 6500000, iron: 1500000, fire_crystals: 48, refined_fire_crystals: 3 }, 
                time: "2d 01:30:00", 
                power: 498022, 
                prereqs: [{ building: "embassy", level: "FC7" }, { building: "furnace", level: "FC7" }] 
            },
            "FC6-4": { 
                cost: { meat: 32000000, wood: 32000000, coal: 6500000, iron: 1500000, fire_crystals: 48, refined_fire_crystals: 3 }, 
                time: "2d 01:30:00", 
                power: 507486, 
                prereqs: [{ building: "embassy", level: "FC7" }, { building: "furnace", level: "FC7" }] 
            },
            "FC7": { 
                cost: { meat: 32000000, wood: 32000000, coal: 6500000, iron: 1500000, fire_crystals: 24, refined_fire_crystals: 6 }, 
                time: "2d 01:30:00", 
                power: 516950, 
                prereqs: [{ building: "embassy", level: "FC7" }, { building: "furnace", level: "FC7" }] 
            },
            "FC7-1": { 
                cost: { meat: 39000000, wood: 39000000, coal: 7900000, iron: 1900000, fire_crystals: 48, refined_fire_crystals: 4 }, 
                time: "2d 09:36:00", 
                power: 526414, 
                prereqs: [{ building: "embassy", level: "FC8" }, { building: "furnace", level: "FC8" }] 
            },
            "FC7-2": { 
                cost: { meat: 39000000, wood: 39000000, coal: 7900000, iron: 1900000, fire_crystals: 48, refined_fire_crystals: 4 }, 
                time: "2d 09:36:00", 
                power: 535878, 
                prereqs: [{ building: "embassy", level: "FC8" }, { building: "furnace", level: "FC8" }] 
            },
            "FC7-3": { 
                cost: { meat: 39000000, wood: 39000000, coal: 7900000, iron: 1900000, fire_crystals: 48, refined_fire_crystals: 4 }, 
                time: "2d 09:36:00", 
                power: 545342, 
                prereqs: [{ building: "embassy", level: "FC8" }, { building: "furnace", level: "FC8" }] 
            },
            "FC7-4": { 
                cost: { meat: 39000000, wood: 39000000, coal: 7900000, iron: 1900000, fire_crystals: 48, refined_fire_crystals: 4 }, 
                time: "2d 09:36:00", 
                power: 554806, 
                prereqs: [{ building: "embassy", level: "FC8" }, { building: "furnace", level: "FC8" }] 
            },
            "FC8": { 
                cost: { meat: 39000000, wood: 39000000, coal: 7900000, iron: 1900000, fire_crystals: 24, refined_fire_crystals: 8 }, 
                time: "2d 09:36:00", 
                power: 564270, 
                prereqs: [{ building: "embassy", level: "FC8" }, { building: "furnace", level: "FC8" }] 
            },
            "FC8-1": { 
                cost: { meat: 43000000, wood: 43000000, coal: 8700000, iron: 2100000, fire_crystals: 56, refined_fire_crystals: 6 }, 
                time: "1d 13:26:00", 
                power: 574406, 
                prereqs: [{ building: "embassy", level: "FC9" }, { building: "furnace", level: "FC9" }] 
            },
            "FC8-2": { 
                cost: { meat: 43000000, wood: 43000000, coal: 8700000, iron: 2100000, fire_crystals: 56, refined_fire_crystals: 6 }, 
                time: "1d 13:26:00", 
                power: 574406, 
                prereqs: [{ building: "embassy", level: "FC9" }, { building: "furnace", level: "FC9" }] 
            },
            "FC8-3": { 
                cost: { meat: 43000000, wood: 43000000, coal: 8700000, iron: 2100000, fire_crystals: 56, refined_fire_crystals: 6 }, 
                time: "1d 13:26:00", 
                power: 574406, 
                prereqs: [{ building: "embassy", level: "FC9" }, { building: "furnace", level: "FC9" }] 
            },
            "FC8-4": { 
                cost: { meat: 43000000, wood: 43000000, coal: 8700000, iron: 2100000, fire_crystals: 56, refined_fire_crystals: 6 }, 
                time: "1d 13:26:00", 
                power: 574406, 
                prereqs: [{ building: "embassy", level: "FC9" }, { building: "furnace", level: "FC9" }] 
            },
            "FC9": { 
                cost: { meat: 43000000, wood: 43000000, coal: 8700000, iron: 2100000, fire_crystals: 28, refined_fire_crystals: 12 }, 
                time: "1d 13:26:00", 
                power: 574406, 
                prereqs: [{ building: "embassy", level: "FC9" }, { building: "furnace", level: "FC9" }] 
            },
            "FC9-1": { 
                cost: { meat: 50000000, wood: 50000000, coal: 10000000, iron: 2500000, fire_crystals: 70, refined_fire_crystals: 14 }, 
                time: "2d 09:36:00", 
                power: 614950, 
                prereqs: [{ building: "embassy", level: "FC10" }, { building: "furnace", level: "FC10" }] 
            },
            "FC9-2": { 
                cost: { meat: 50000000, wood: 50000000, coal: 10000000, iron: 2500000, fire_crystals: 70, refined_fire_crystals: 14 }, 
                time: "2d 09:36:00", 
                power: 614950, 
                prereqs: [{ building: "embassy", level: "FC10" }, { building: "furnace", level: "FC10" }] 
            },
            "FC9-3": { 
                cost: { meat: 50000000, wood: 50000000, coal: 10000000, iron: 2500000, fire_crystals: 70, refined_fire_crystals: 14 }, 
                time: "2d 09:36:00", 
                power: 614950, 
                prereqs: [{ building: "embassy", level: "FC10" }, { building: "furnace", level: "FC10" }] 
            },
            "FC9-4": { 
                cost: { meat: 50000000, wood: 50000000, coal: 10000000, iron: 2500000, fire_crystals: 70, refined_fire_crystals: 14 }, 
                time: "2d 09:36:00", 
                power: 614950, 
                prereqs: [{ building: "embassy", level: "FC10" }, { building: "furnace", level: "FC10" }] 
            },
            "FC10": { 
                cost: { meat: 50000000, wood: 50000000, coal: 10000000, iron: 2500000, fire_crystals: 35, refined_fire_crystals: 28 }, 
                time: "2d 09:36:00", 
                power: 614950, 
                prereqs: [{ building: "embassy", level: "FC10" }, { building: "furnace", level: "FC10" }] 
            }
        }
    },
    infantry_camp: {
        name: "Infantry Camp",
        levels: {
            1: { 
                cost: {}, 
                time: "00:00:02", 
                power: 400, 
                prereqs: [{ building: "furnace", level: 7 }] 
            },
            2: { 
                cost: { wood: 140 }, 
                time: "00:00:09", 
                power: 760, 
                prereqs: [{ building: "furnace", level: 7 }] 
            },
            3: { 
                cost: { wood: 645 }, 
                time: "00:00:45", 
                power: 1300, 
                prereqs: [{ building: "furnace", level: 7 }] 
            },
            4: { 
                cost: { wood: 1400, coal: 285 }, 
                time: "00:02:15", 
                power: 2020, 
                prereqs: [{ building: "furnace", level: 7 }] 
            },
            5: { 
                cost: { wood: 6000, coal: 1200 }, 
                time: "00:04:30", 
                power: 3100, 
                prereqs: [{ building: "furnace", level: 7 }] 
            },
            6: { 
                cost: { wood: 15000, coal: 3000, iron: 765 }, 
                time: "00:09:00", 
                power: 4720, 
                prereqs: [{ building: "furnace", level: 7 }] 
            },
            7: { 
                cost: { wood: 55000, coal: 11000, iron: 2700 }, 
                time: "00:18:00", 
                power: 7060, 
                prereqs: [{ building: "furnace", level: 7 }] 
            },
            8: { 
                cost: { wood: 100000, coal: 20000, iron: 5000 }, 
                time: "00:27:00", 
                power: 9400, 
                prereqs: [{ building: "furnace", level: 8 }] 
            },
            9: { 
                cost: { wood: 200000, coal: 41000, iron: 10000 }, 
                time: "00:40:30", 
                power: 11740, 
                prereqs: [{ building: "furnace", level: 9 }] 
            },
            10: { 
                cost: { wood: 360000, coal: 73000, iron: 18000 }, 
                time: "00:54:00", 
                power: 15140, 
                prereqs: [{ building: "furnace", level: 10 }] 
            },
            11: { 
                cost: { meat: 460000, wood: 460000, coal: 92000, iron: 23000 }, 
                time: "01:07:30", 
                power: 18540, 
                prereqs: [{ building: "furnace", level: 11 }] 
            },
            12: { 
                cost: { meat: 580000, wood: 580000, coal: 110000, iron: 29000 }, 
                time: "01:21:00", 
                power: 21940, 
                prereqs: [{ building: "furnace", level: 12 }] 
            },
            13: { 
                cost: { meat: 830000, wood: 830000, coal: 160000, iron: 41000 }, 
                time: "01:39:00", 
                power: 27680, 
                prereqs: [{ building: "furnace", level: 13 }] 
            },
            14: { 
                cost: { meat: 1100000, wood: 1100000, coal: 220000, iron: 55000 }, 
                time: "02:06:00", 
                power: 33420, 
                prereqs: [{ building: "furnace", level: 14 }] 
            },
            15: { 
                cost: { meat: 1600000, wood: 1600000, coal: 320000, iron: 81000 }, 
                time: "02:42:00", 
                power: 39160, 
                prereqs: [{ building: "furnace", level: 15 }] 
            },
            16: { 
                cost: { meat: 2000000, wood: 2000000, coal: 410000, iron: 100000 }, 
                time: "04:34:00", 
                power: 47240, 
                prereqs: [{ building: "furnace", level: 16 }] 
            },
            17: { 
                cost: { meat: 3200000, wood: 3200000, coal: 650000, iron: 160000 }, 
                time: "05:29:00", 
                power: 55320, 
                prereqs: [{ building: "furnace", level: 17 }] 
            },
            18: { 
                cost: { meat: 4300000, wood: 4300000, coal: 870000, iron: 210000 }, 
                time: "06:35:00", 
                power: 63400, 
                prereqs: [{ building: "furnace", level: 18 }] 
            },
            19: { 
                cost: { meat: 5400000, wood: 5400000, coal: 1000000, iron: 270000 }, 
                time: "09:52:30", 
                power: 74880, 
                prereqs: [{ building: "furnace", level: 19 }] 
            },
            20: { 
                cost: { meat: 7500000, wood: 7500000, coal: 1500000, iron: 370000 }, 
                time: "12:20:30", 
                power: 86360, 
                prereqs: [{ building: "furnace", level: 20 }] 
            },
            21: { 
                cost: { meat: 9500000, wood: 9500000, coal: 1900000, iron: 470000 }, 
                time: "16:02:30", 
                power: 97840, 
                prereqs: [{ building: "furnace", level: 21 }] 
            },
            22: { 
                cost: { meat: 12000000, wood: 12000000, coal: 2500000, iron: 630000 }, 
                time: "1d 00:04:00", 
                power: 115060, 
                prereqs: [{ building: "furnace", level: 22 }] 
            },
            23: { 
                cost: { meat: 15000000, wood: 15000000, coal: 3100000, iron: 490000 }, 
                time: "1d 09:42:00", 
                power: 132280, 
                prereqs: [{ building: "furnace", level: 23 }] 
            },
            24: { 
                cost: { meat: 21000000, wood: 21000000, coal: 4200000, iron: 1000000 }, 
                time: "1d 23:11:00", 
                power: 149500, 
                prereqs: [{ building: "furnace", level: 24 }] 
            },
            25: { 
                cost: { meat: 28000000, wood: 28000000, coal: 5700000, iron: 1400000 }, 
                time: "2d 18:03:00", 
                power: 166720, 
                prereqs: [{ building: "furnace", level: 25 }] 
            },
            26: { 
                cost: { meat: 36000000, wood: 36000000, coal: 7300000, iron: 1800000 }, 
                time: "3d 03:57:00", 
                power: 192020, 
                prereqs: [{ building: "furnace", level: 26 }] 
            },
            27: { 
                cost: { meat: 52000000, wood: 52000000, coal: 10000000, iron: 2600000 }, 
                time: "3d 19:09:00", 
                power: 217320, 
                prereqs: [{ building: "furnace", level: 27 }] 
            },
            28: { 
                cost: { meat: 69000000, wood: 69000000, coal: 13000000, iron: 3400000 }, 
                time: "4d 08:49:00", 
                power: 242620, 
                prereqs: [{ building: "furnace", level: 28 }] 
            },
            29: { 
                cost: { meat: 86000000, wood: 86000000, coal: 17000000, iron: 4300000 }, 
                time: "5d 00:33:00", 
                power: 267920, 
                prereqs: [{ building: "furnace", level: 29 }] 
            },
            30: { 
                cost: { meat: 100000000, wood: 100000000, coal: 21000000, iron: 5200000 }, 
                time: "6d 00:40:00", 
                power: 304700, 
                prereqs: [{ building: "furnace", level: 30 }] 
            },
            "30-1": { 
                cost: { meat: 23000000, wood: 23000000, coal: 4700000, iron: 1100000, fire_crystals: 59 }, 
                time: "1d 01:12:00", 
                power: 316180, 
                prereqs: [{ building: "furnace", level: "FC1" }] 
            },
            "30-2": { 
                cost: { meat: 23000000, wood: 23000000, coal: 4700000, iron: 1100000, fire_crystals: 59 }, 
                time: "1d 01:12:00", 
                power: 327660, 
                prereqs: [{ building: "furnace", level: "FC1" }] 
            },
            "30-3": { 
                cost: { meat: 23000000, wood: 23000000, coal: 4700000, iron: 1100000, fire_crystals: 59 }, 
                time: "1d 01:12:00", 
                power: 339140, 
                prereqs: [{ building: "furnace", level: "FC1" }] 
            },
            "30-4": { 
                cost: { meat: 23000000, wood: 23000000, coal: 4700000, iron: 1100000, fire_crystals: 59 }, 
                time: "1d 01:12:00", 
                power: 350620, 
                prereqs: [{ building: "furnace", level: "FC1" }] 
            },
            "FC1": { 
                cost: { meat: 23000000, wood: 23000000, coal: 4700000, iron: 1100000, fire_crystals: 59 }, 
                time: "1d 01:12:00", 
                power: 362100, 
                prereqs: [{ building: "furnace", level: "FC1" }] 
            },
            "FC1-1": { 
                cost: { meat: 25000000, wood: 25000000, coal: 5000000, iron: 1200000, fire_crystals: 71 }, 
                time: "1d 08:24:00", 
                power: 373580, 
                prereqs: [{ building: "furnace", level: "FC2" }] 
            },
            "FC1-2": { 
                cost: { meat: 25000000, wood: 21000000, coal: 5000000, iron: 1200000, fire_crystals: 71 }, 
                time: "1d 08:24:00", 
                power: 385060, 
                prereqs: [{ building: "furnace", level: "FC2" }] 
            },
            "FC1-3": { 
                cost: { meat: 25000000, wood: 25000000, coal: 5000000, iron: 1200000, fire_crystals: 71 }, 
                time: "1d 08:24:00", 
                power: 396540, 
                prereqs: [{ building: "furnace", level: "FC2" }] 
            },
            "FC1-4": { 
                cost: { meat: 25000000, wood: 25000000, coal: 5000000, iron: 1200000, fire_crystals: 71 }, 
                time: "1d 08:24:00", 
                power: 408020, 
                prereqs: [{ building: "furnace", level: "FC2" }] 
            },
            "FC2": { 
                cost: { meat: 25000000, wood: 25000000, coal: 5000000, iron: 1200000, fire_crystals: 71 }, 
                time: "1d 08:24:00", 
                power: 419500, 
                prereqs: [{ building: "furnace", level: "FC2" }] 
            },
            "FC2-1": { 
                cost: { meat: 27000000, wood: 27000000, coal: 5500000, iron: 1300000, fire_crystals: 107 }, 
                time: "1d 15:36:00", 
                power: 430980, 
                prereqs: [{ building: "furnace", level: "FC3" }] 
            },
            "FC2-2": { 
                cost: { meat: 27000000, wood: 27000000, coal: 5500000, iron: 1300000, fire_crystals: 107 }, 
                time: "1d 15:36:00", 
                power: 442460, 
                prereqs: [{ building: "furnace", level: "FC3" }] 
            },
            "FC2-3": { 
                cost: { meat: 27000000, wood: 27000000, coal: 5500000, iron: 1300000, fire_crystals: 107 }, 
                time: "1d 15:36:00", 
                power: 453940, 
                prereqs: [{ building: "furnace", level: "FC3" }] 
            },
            "FC2-4": { 
                cost: { meat: 27000000, wood: 27000000, coal: 5500000, iron: 1300000, fire_crystals: 107 }, 
                time: "1d 15:36:00", 
                power: 465420, 
                prereqs: [{ building: "furnace", level: "FC3" }] 
            },
            "FC3": { 
                cost: { meat: 27000000, wood: 27000000, coal: 5500000, iron: 1300000, fire_crystals: 107 }, 
                time: "1d 15:36:00", 
                power: 476900, 
                prereqs: [{ building: "furnace", level: "FC3" }] 
            },
            "FC3-1": { 
                cost: { meat: 28000000, wood: 28000000, coal: 5700000, iron: 1400000, fire_crystals: 126 }, 
                time: "1d 19:12:00", 
                power: 489540, 
                prereqs: [{ building: "furnace", level: "FC4" }] 
            },
            "FC3-2": { 
                cost: { meat: 28000000, wood: 28000000, coal: 5700000, iron: 1400000, fire_crystals: 126 }, 
                time: "1d 19:12:00", 
                power: 502180, 
                prereqs: [{ building: "furnace", level: "FC4" }] 
            },
            "FC3-3": { 
                cost: { meat: 28000000, wood: 28000000, coal: 5700000, iron: 1400000, fire_crystals: 126 }, 
                time: "1d 19:12:00", 
                power: 514820, 
                prereqs: [{ building: "furnace", level: "FC4" }] 
            },
            "FC3-4": { 
                cost: { meat: 28000000, wood: 28000000, coal: 5700000, iron: 1400000, fire_crystals: 126 }, 
                time: "1d 19:12:00", 
                power: 527460, 
                prereqs: [{ building: "furnace", level: "FC4" }] 
            },
            "FC4": { 
                cost: { meat: 28000000, wood: 28000000, coal: 5700000, iron: 1400000, fire_crystals: 126 }, 
                time: "1d 19:12:00", 
                power: 540100, 
                prereqs: [{ building: "furnace", level: "FC4" }] 
            },
            "FC4-1": { 
                cost: { meat: 29000000, wood: 29000000, coal: 5900000, iron: 1400000, fire_crystals: 150 }, 
                time: "2d 02:24:00", 
                power: 552740, 
                prereqs: [{ building: "furnace", level: "FC5" }] 
            },
            "FC4-2": { 
                cost: { meat: 29000000, wood: 29000000, coal: 5900000, iron: 1400000, fire_crystals: 150 }, 
                time: "2d 02:24:00", 
                power: 565380, 
                prereqs: [{ building: "furnace", level: "FC5" }] 
            },
            "FC4-3": { 
                cost: { meat: 29000000, wood: 29000000, coal: 5900000, iron: 1400000, fire_crystals: 150 }, 
                time: "2d 02:24:00", 
                power: 578020, 
                prereqs: [{ building: "furnace", level: "FC5" }] 
            },
            "FC4-4": { 
                cost: { meat: 29000000, wood: 29000000, coal: 5900000, iron: 1400000, fire_crystals: 150 }, 
                time: "2d 02:24:00", 
                power: 590660, 
                prereqs: [{ building: "furnace", level: "FC5" }] 
            },
            "FC5": { 
                cost: { meat: 29000000, wood: 29000000, coal: 5900000, iron: 1400000, fire_crystals: 150 }, 
                time: "2d 02:24:00", 
                power: 603300, 
                prereqs: [{ building: "furnace", level: "FC5" }] 
            },
            "FC5-1": { 
                cost: { meat: 33000000, wood: 33000000, coal: 6700000, iron: 1600000, fire_crystals: 90, refined_fire_crystals: 4 }, 
                time: "2d 06:00:00", 
                power: 616820, 
                prereqs: [{ building: "furnace", level: "FC6" }] 
            },
            "FC5-2": { 
                cost: { meat: 33000000, wood: 33000000, coal: 6700000, iron: 1600000, fire_crystals: 90, refined_fire_crystals: 4 }, 
                time: "2d 06:00:00", 
                power: 630340, 
                prereqs: [{ building: "furnace", level: "FC6" }] 
            },
            "FC5-3": { 
                cost: { meat: 33000000, wood: 33000000, coal: 6700000, iron: 1600000, fire_crystals: 90, refined_fire_crystals: 4 }, 
                time: "2d 06:00:00", 
                power: 643860, 
                prereqs: [{ building: "furnace", level: "FC6" }] 
            },
            "FC5-4": { 
                cost: { meat: 33000000, wood: 33000000, coal: 6700000, iron: 1600000, fire_crystals: 90, refined_fire_crystals: 4 }, 
                time: "2d 06:00:00", 
                power: 657380, 
                prereqs: [{ building: "furnace", level: "FC6" }] 
            },
            "FC6": { 
                cost: { meat: 33000000, wood: 33000000, coal: 6700000, iron: 1600000, fire_crystals: 45, refined_fire_crystals: 9 }, 
                time: "2d 06:00:00", 
                power: 670990, 
                prereqs: [{ building: "furnace", level: "FC6" }] 
            },
            "FC6-1": { 
                cost: { meat: 38000000, wood: 38000000, coal: 7600000, iron: 1900000, fire_crystals: 108, refined_fire_crystals: 6 }, 
                time: "2d 16:48:00", 
                power: 684420, 
                prereqs: [{ building: "furnace", level: "FC7" }] 
            },
            "FC6-2": { 
                cost: { meat: 38000000, wood: 38000000, coal: 7600000, iron: 1900000, fire_crystals: 108, refined_fire_crystals: 6 }, 
                time: "2d 16:48:00", 
                power: 697940, 
                prereqs: [{ building: "furnace", level: "FC7" }] 
            },
            "FC6-3": { 
                cost: { meat: 38000000, wood: 38000000, coal: 7600000, iron: 1900000, fire_crystals: 108, refined_fire_crystals: 6 }, 
                time: "2d 16:48:00", 
                power: 711460, 
                prereqs: [{ building: "furnace", level: "FC7" }] 
            },
            "FC6-4": { 
                cost: { meat: 38000000, wood: 38000000, coal: 7600000, iron: 1900000, fire_crystals: 108, refined_fire_crystals: 6 }, 
                time: "2d 16:48:00", 
                power: 724980, 
                prereqs: [{ building: "furnace", level: "FC7" }] 
            },
            "FC7": { 
                cost: { meat: 38000000, wood: 38000000, coal: 7600000, iron: 1900000, fire_crystals: 54, refined_fire_crystals: 13 }, 
                time: "2d 16:48:00", 
                power: 738500, 
                prereqs: [{ building: "furnace", level: "FC7" }] 
            },
            "FC7-1": { 
                cost: { meat: 46000000, wood: 46000000, coal: 9300000, iron: 2300000, fire_crystals: 108, refined_fire_crystals: 9 }, 
                time: "3d 00:00:00", 
                power: 752020, 
                prereqs: [{ building: "furnace", level: "FC8" }] 
            },
            "FC7-2": { 
                cost: { meat: 46000000, wood: 46000000, coal: 9300000, iron: 2300000, fire_crystals: 108, refined_fire_crystals: 9 }, 
                time: "3d 00:00:00", 
                power: 765540, 
                prereqs: [{ building: "furnace", level: "FC8" }] 
            },
            "FC7-3": { 
                cost: { meat: 46000000, wood: 46000000, coal: 9300000, iron: 2300000, fire_crystals: 108, refined_fire_crystals: 9 }, 
                time: "3d 00:00:00", 
                power: 779060, 
                prereqs: [{ building: "furnace", level: "FC8" }] 
            },
            "FC7-4": { 
                cost: { meat: 46000000, wood: 46000000, coal: 9300000, iron: 2300000, fire_crystals: 108, refined_fire_crystals: 9 }, 
                time: "3d 00:00:00", 
                power: 792580, 
                prereqs: [{ building: "furnace", level: "FC8" }] 
            },
            "FC8": { 
                cost: { meat: 46000000, wood: 46000000, coal: 9300000, iron: 2300000, fire_crystals: 54, refined_fire_crystals: 19 }, 
                time: "3d 00:00:00", 
                power: 806100, 
                prereqs: [{ building: "furnace", level: "FC8" }] 
            },
            "FC8-1": { 
                cost: { meat: 50000000, wood: 50000000, coal: 10000000, iron: 2500000, fire_crystals: 126, refined_fire_crystals: 13 }, 
                time: "1d 22:48:00", 
                power: 820580, 
                prereqs: [{ building: "furnace", level: "FC9" }] 
            },
            "FC8-2": { 
                cost: { meat: 50000000, wood: 50000000, coal: 10000000, iron: 2500000, fire_crystals: 126, refined_fire_crystals: 13 }, 
                time: "1d 22:48:00", 
                power: 835060, 
                prereqs: [{ building: "furnace", level: "FC9" }] 
            },
            "FC8-3": { 
                cost: { meat: 50000000, wood: 50000000, coal: 10000000, iron: 2500000, fire_crystals: 126, refined_fire_crystals: 13 }, 
                time: "1d 22:48:00", 
                power: 849540, 
                prereqs: [{ building: "furnace", level: "FC9" }] 
            },
            "FC8-4": { 
                cost: { meat: 50000000, wood: 50000000, coal: 10000000, iron: 2500000, fire_crystals: 126, refined_fire_crystals: 13 }, 
                time: "1d 22:48:00", 
                power: 864020, 
                prereqs: [{ building: "furnace", level: "FC9" }] 
            },
            "FC9": { 
                cost: { meat: 50000000, wood: 50000000, coal: 10000000, iron: 2500000, fire_crystals: 63, refined_fire_crystals: 27 }, 
                time: "1d 22:48:00", 
                power: 878500, 
                prereqs: [{ building: "furnace", level: "FC9" }] 
            },
            "FC9-1": { 
                cost: { meat: 59000000, wood: 59000000, coal: 11000000, iron: 2900000, fire_crystals: 157, refined_fire_crystals: 31 }, 
                time: "3d 00:00:00", 
                power: 892980, 
                prereqs: [{ building: "furnace", level: "FC10" }] 
            },
            "FC9-2": { 
                cost: { meat: 59000000, wood: 59000000, coal: 11000000, iron: 2900000, fire_crystals: 157, refined_fire_crystals: 31 }, 
                time: "3d 00:00:00", 
                power: 907460, 
                prereqs: [{ building: "furnace", level: "FC10" }] 
            },
            "FC9-3": { 
                cost: { meat: 59000000, wood: 59000000, coal: 11000000, iron: 2900000, fire_crystals: 157, refined_fire_crystals: 31 }, 
                time: "3d 00:00:00", 
                power: 921940, 
                prereqs: [{ building: "furnace", level: "FC10" }] 
            },
            "FC9-4": { 
                cost: { meat: 59000000, wood: 59000000, coal: 11000000, iron: 2900000, fire_crystals: 157, refined_fire_crystals: 31 }, 
                time: "3d 00:00:00", 
                power: 936420, 
                prereqs: [{ building: "furnace", level: "FC10" }] 
            },
            "FC10": { 
                cost: { meat: 59000000, wood: 59000000, coal: 11000000, iron: 2900000, fire_crystals: 78, refined_fire_crystals: 63 }, 
                time: "3d 00:00:00", 
                power: 950900, 
                prereqs: [{ building: "furnace", level: "FC10" }] 
            }
        }
    },
    lancer_camp: {
        name: "Lancer Camp",
        levels: {
            1: { 
                cost: { wood: 95 }, 
                time: "00:00:02", 
                power: 400, 
                prereqs: [{ building: "furnace", level: 9 }] 
            },
            2: { 
                cost: { wood: 140 }, 
                time: "00:00:09", 
                power: 760, 
                prereqs: [{ building: "furnace", level: 9 }] 
            },
            3: { 
                cost: { wood: 645 }, 
                time: "00:00:45", 
                power: 1300, 
                prereqs: [{ building: "furnace", level: 9 }] 
            },
            4: { 
                cost: { wood: 1400, coal: 285 }, 
                time: "00:02:15", 
                power: 2020, 
                prereqs: [{ building: "furnace", level: 9 }] 
            },
            5: { 
                cost: { wood: 6000, coal: 1200 }, 
                time: "00:04:30", 
                power: 3100, 
                prereqs: [{ building: "furnace", level: 9 }] 
            },
            6: { 
                cost: { wood: 15000, coal: 3000, iron: 765 }, 
                time: "00:09:00", 
                power: 4720, 
                prereqs: [{ building: "furnace", level: 9 }] 
            },
            7: { 
                cost: { wood: 55000, coal: 11000, iron: 2700 }, 
                time: "00:18:00", 
                power: 7060, 
                prereqs: [{ building: "furnace", level: 9 }] 
            },
            8: { 
                cost: { wood: 100000, coal: 20000, iron: 5000 }, 
                time: "00:27:00", 
                power: 9400, 
                prereqs: [{ building: "furnace", level: 9 }] 
            },
            9: { 
                cost: { wood: 200000, coal: 41000, iron: 10000 }, 
                time: "00:40:30", 
                power: 11740, 
                prereqs: [{ building: "furnace", level: 9 }] 
            },
            10: { 
                cost: { wood: 360000, coal: 73000, iron: 18000 }, 
                time: "00:54:00", 
                power: 15140, 
                prereqs: [{ building: "furnace", level: 10 }] 
            },
            11: { 
                cost: { meat: 460000, wood: 460000, coal: 92000, iron: 23000 }, 
                time: "01:07:30", 
                power: 18540, 
                prereqs: [{ building: "furnace", level: 11 }] 
            },
            12: { 
                cost: { meat: 580000, wood: 580000, coal: 110000, iron: 29000 }, 
                time: "01:21:00", 
                power: 21940, 
                prereqs: [{ building: "furnace", level: 12 }] 
            },
            13: { 
                cost: { meat: 830000, wood: 830000, coal: 160000, iron: 41000 }, 
                time: "01:39:00", 
                power: 27680, 
                prereqs: [{ building: "furnace", level: 13 }] 
            },
            14: { 
                cost: { meat: 1100000, wood: 1100000, coal: 220000, iron: 55000 }, 
                time: "02:06:00", 
                power: 33420, 
                prereqs: [{ building: "furnace", level: 14 }] 
            },
            15: { 
                cost: { meat: 1600000, wood: 1600000, coal: 320000, iron: 81000 }, 
                time: "02:42:00", 
                power: 39160, 
                prereqs: [{ building: "furnace", level: 15 }] 
            },
            16: { 
                cost: { meat: 2000000, wood: 2000000, coal: 410000, iron: 100000 }, 
                time: "04:34:00", 
                power: 47240, 
                prereqs: [{ building: "furnace", level: 16 }] 
            },
            17: { 
                cost: { meat: 3200000, wood: 3200000, coal: 650000, iron: 160000 }, 
                time: "05:29:00", 
                power: 55320, 
                prereqs: [{ building: "furnace", level: 17 }] 
            },
            18: { 
                cost: { meat: 4300000, wood: 4300000, coal: 870000, iron: 210000 }, 
                time: "06:35:00", 
                power: 63400, 
                prereqs: [{ building: "furnace", level: 18 }] 
            },
            19: { 
                cost: { meat: 5400000, wood: 5400000, coal: 1000000, iron: 270000 }, 
                time: "09:52:30", 
                power: 74880, 
                prereqs: [{ building: "furnace", level: 19 }] 
            },
            20: { 
                cost: { meat: 7500000, wood: 7500000, coal: 1500000, iron: 370000 }, 
                time: "12:20:30", 
                power: 86360, 
                prereqs: [{ building: "furnace", level: 20 }] 
            },
            21: { 
                cost: { meat: 9500000, wood: 9500000, coal: 1900000, iron: 470000 }, 
                time: "16:02:30", 
                power: 97840, 
                prereqs: [{ building: "furnace", level: 21 }] 
            },
            22: { 
                cost: { meat: 12000000, wood: 12000000, coal: 2500000, iron: 630000 }, 
                time: "1d 00:04:00", 
                power: 115060, 
                prereqs: [{ building: "furnace", level: 22 }] 
            },
            23: { 
                cost: { meat: 15000000, wood: 15000000, coal: 3100000, iron: 490000 }, 
                time: "1d 09:42:00", 
                power: 132280, 
                prereqs: [{ building: "furnace", level: 23 }] 
            },
            24: { 
                cost: { meat: 21000000, wood: 21000000, coal: 4200000, iron: 1000000 }, 
                time: "1d 23:11:00", 
                power: 149500, 
                prereqs: [{ building: "furnace", level: 24 }] 
            },
            25: { 
                cost: { meat: 28000000, wood: 28000000, coal: 5700000, iron: 1400000 }, 
                time: "2d 18:03:00", 
                power: 166720, 
                prereqs: [{ building: "furnace", level: 25 }] 
            },
            26: { 
                cost: { meat: 36000000, wood: 36000000, coal: 7300000, iron: 1800000 }, 
                time: "3d 03:57:00", 
                power: 192020, 
                prereqs: [{ building: "furnace", level: 26 }] 
            },
            27: { 
                cost: { meat: 52000000, wood: 52000000, coal: 10000000, iron: 2600000 }, 
                time: "3d 19:09:00", 
                power: 217320, 
                prereqs: [{ building: "furnace", level: 27 }] 
            },
            28: { 
                cost: { meat: 69000000, wood: 69000000, coal: 13000000, iron: 3400000 }, 
                time: "4d 08:49:00", 
                power: 242620, 
                prereqs: [{ building: "furnace", level: 28 }] 
            },
            29: { 
                cost: { meat: 86000000, wood: 86000000, coal: 17000000, iron: 4300000 }, 
                time: "5d 00:33:00", 
                power: 267920, 
                prereqs: [{ building: "furnace", level: 29 }] 
            },
            30: { 
                cost: { meat: 100000000, wood: 100000000, coal: 21000000, iron: 5200000 }, 
                time: "6d 00:40:00", 
                power: 304700, 
                prereqs: [{ building: "furnace", level: 30 }] 
            },
            "30-1": { 
                cost: { meat: 23000000, wood: 23000000, coal: 4700000, iron: 1100000, fire_crystals: 59 }, 
                time: "1d 01:12:00", 
                power: 316180, 
                prereqs: [{ building: "furnace", level: "FC1" }] 
            },
            "30-2": { 
                cost: { meat: 23000000, wood: 23000000, coal: 4700000, iron: 1100000, fire_crystals: 59 }, 
                time: "1d 01:12:00", 
                power: 327660, 
                prereqs: [{ building: "furnace", level: "FC1" }] 
            },
            "30-3": { 
                cost: { meat: 23000000, wood: 23000000, coal: 4700000, iron: 1100000, fire_crystals: 59 }, 
                time: "1d 01:12:00", 
                power: 339140, 
                prereqs: [{ building: "furnace", level: "FC1" }] 
            },
            "30-4": { 
                cost: { meat: 23000000, wood: 23000000, coal: 4700000, iron: 1100000, fire_crystals: 59 }, 
                time: "1d 01:12:00", 
                power: 350620, 
                prereqs: [{ building: "furnace", level: "FC1" }] 
            },
            "FC1": { 
                cost: { meat: 23000000, wood: 23000000, coal: 4700000, iron: 1100000, fire_crystals: 59 }, 
                time: "1d 01:12:00", 
                power: 362100, 
                prereqs: [{ building: "furnace", level: "FC1" }] 
            },
            "FC1-1": { 
                cost: { meat: 25000000, wood: 25000000, coal: 5000000, iron: 1200000, fire_crystals: 71 }, 
                time: "1d 08:24:00", 
                power: 373580, 
                prereqs: [{ building: "furnace", level: "FC2" }] 
            },
            "FC1-2": { 
                cost: { meat: 25000000, wood: 21000000, coal: 5000000, iron: 1200000, fire_crystals: 71 }, 
                time: "1d 08:24:00", 
                power: 385060, 
                prereqs: [{ building: "furnace", level: "FC2" }] 
            },
            "FC1-3": { 
                cost: { meat: 25000000, wood: 25000000, coal: 5000000, iron: 1200000, fire_crystals: 71 }, 
                time: "1d 08:24:00", 
                power: 396540, 
                prereqs: [{ building: "furnace", level: "FC2" }] 
            },
            "FC1-4": { 
                cost: { meat: 25000000, wood: 25000000, coal: 5000000, iron: 1200000, fire_crystals: 71 }, 
                time: "1d 08:24:00", 
                power: 408020, 
                prereqs: [{ building: "furnace", level: "FC2" }] 
            },
            "FC2": { 
                cost: { meat: 25000000, wood: 25000000, coal: 5000000, iron: 1200000, fire_crystals: 71 }, 
                time: "1d 08:24:00", 
                power: 419500, 
                prereqs: [{ building: "furnace", level: "FC2" }] 
            },
            "FC2-1": { 
                cost: { meat: 27000000, wood: 27000000, coal: 5500000, iron: 1300000, fire_crystals: 107 }, 
                time: "1d 15:36:00", 
                power: 430980, 
                prereqs: [{ building: "furnace", level: "FC3" }] 
            },
            "FC2-2": { 
                cost: { meat: 27000000, wood: 27000000, coal: 5500000, iron: 1300000, fire_crystals: 107 }, 
                time: "1d 15:36:00", 
                power: 442460, 
                prereqs: [{ building: "furnace", level: "FC3" }] 
            },
            "FC2-3": { 
                cost: { meat: 27000000, wood: 27000000, coal: 5500000, iron: 1300000, fire_crystals: 107 }, 
                time: "1d 15:36:00", 
                power: 453940, 
                prereqs: [{ building: "furnace", level: "FC3" }] 
            },
            "FC2-4": { 
                cost: { meat: 27000000, wood: 27000000, coal: 5500000, iron: 1300000, fire_crystals: 107 }, 
                time: "1d 15:36:00", 
                power: 465420, 
                prereqs: [{ building: "furnace", level: "FC3" }] 
            },
            "FC3": { 
                cost: { meat: 27000000, wood: 27000000, coal: 5500000, iron: 1300000, fire_crystals: 107 }, 
                time: "1d 15:36:00", 
                power: 476900, 
                prereqs: [{ building: "furnace", level: "FC3" }] 
            },
            "FC3-1": { 
                cost: { meat: 28000000, wood: 28000000, coal: 5700000, iron: 1400000, fire_crystals: 126 }, 
                time: "1d 19:12:00", 
                power: 489540, 
                prereqs: [{ building: "furnace", level: "FC4" }] 
            },
            "FC3-2": { 
                cost: { meat: 28000000, wood: 28000000, coal: 5700000, iron: 1400000, fire_crystals: 126 }, 
                time: "1d 19:12:00", 
                power: 502180, 
                prereqs: [{ building: "furnace", level: "FC4" }] 
            },
            "FC3-3": { 
                cost: { meat: 28000000, wood: 28000000, coal: 5700000, iron: 1400000, fire_crystals: 126 }, 
                time: "1d 19:12:00", 
                power: 514820, 
                prereqs: [{ building: "furnace", level: "FC4" }] 
            },
            "FC3-4": { 
                cost: { meat: 28000000, wood: 28000000, coal: 5700000, iron: 1400000, fire_crystals: 126 }, 
                time: "1d 19:12:00", 
                power: 527460, 
                prereqs: [{ building: "furnace", level: "FC4" }] 
            },
            "FC4": { 
                cost: { meat: 28000000, wood: 28000000, coal: 5700000, iron: 1400000, fire_crystals: 126 }, 
                time: "1d 19:12:00", 
                power: 540100, 
                prereqs: [{ building: "furnace", level: "FC4" }] 
            },
            "FC4-1": { 
                cost: { meat: 29000000, wood: 29000000, coal: 5900000, iron: 1400000, fire_crystals: 150 }, 
                time: "2d 02:24:00", 
                power: 552740, 
                prereqs: [{ building: "furnace", level: "FC5" }] 
            },
            "FC4-2": { 
                cost: { meat: 29000000, wood: 29000000, coal: 5900000, iron: 1400000, fire_crystals: 150 }, 
                time: "2d 02:24:00", 
                power: 565380, 
                prereqs: [{ building: "furnace", level: "FC5" }] 
            },
            "FC4-3": { 
                cost: { meat: 29000000, wood: 29000000, coal: 5900000, iron: 1400000, fire_crystals: 150 }, 
                time: "2d 02:24:00", 
                power: 578020, 
                prereqs: [{ building: "furnace", level: "FC5" }] 
            },
            "FC4-4": { 
                cost: { meat: 29000000, wood: 29000000, coal: 5900000, iron: 1400000, fire_crystals: 150 }, 
                time: "2d 02:24:00", 
                power: 590660, 
                prereqs: [{ building: "furnace", level: "FC5" }] 
            },
            "FC5": { 
                cost: { meat: 29000000, wood: 29000000, coal: 5900000, iron: 1400000, fire_crystals: 150 }, 
                time: "2d 02:24:00", 
                power: 603300, 
                prereqs: [{ building: "furnace", level: "FC5" }] 
            },
            "FC5-1": { 
                cost: { meat: 33000000, wood: 33000000, coal: 6700000, iron: 1600000, fire_crystals: 90, refined_fire_crystals: 4 }, 
                time: "2d 06:00:00", 
                power: 616820, 
                prereqs: [{ building: "furnace", level: "FC6" }] 
            },
            "FC5-2": { 
                cost: { meat: 33000000, wood: 33000000, coal: 6700000, iron: 1600000, fire_crystals: 90, refined_fire_crystals: 4 }, 
                time: "2d 06:00:00", 
                power: 630340, 
                prereqs: [{ building: "furnace", level: "FC6" }] 
            },
            "FC5-3": { 
                cost: { meat: 33000000, wood: 33000000, coal: 6700000, iron: 1600000, fire_crystals: 90, refined_fire_crystals: 4 }, 
                time: "2d 06:00:00", 
                power: 643860, 
                prereqs: [{ building: "furnace", level: "FC6" }] 
            },
            "FC5-4": { 
                cost: { meat: 33000000, wood: 33000000, coal: 6700000, iron: 1600000, fire_crystals: 90, refined_fire_crystals: 4 }, 
                time: "2d 06:00:00", 
                power: 657380, 
                prereqs: [{ building: "furnace", level: "FC6" }] 
            },
            "FC6": { 
                cost: { meat: 33000000, wood: 33000000, coal: 6700000, iron: 1600000, fire_crystals: 45, refined_fire_crystals: 9 }, 
                time: "2d 06:00:00", 
                power: 670990, 
                prereqs: [{ building: "furnace", level: "FC6" }] 
            },
            "FC6-1": { 
                cost: { meat: 38000000, wood: 38000000, coal: 7600000, iron: 1900000, fire_crystals: 108, refined_fire_crystals: 6 }, 
                time: "2d 16:48:00", 
                power: 684420, 
                prereqs: [{ building: "furnace", level: "FC7" }] 
            },
            "FC6-2": { 
                cost: { meat: 38000000, wood: 38000000, coal: 7600000, iron: 1900000, fire_crystals: 108, refined_fire_crystals: 6 }, 
                time: "2d 16:48:00", 
                power: 697940, 
                prereqs: [{ building: "furnace", level: "FC7" }] 
            },
            "FC6-3": { 
                cost: { meat: 38000000, wood: 38000000, coal: 7600000, iron: 1900000, fire_crystals: 108, refined_fire_crystals: 6 }, 
                time: "2d 16:48:00", 
                power: 711460, 
                prereqs: [{ building: "furnace", level: "FC7" }] 
            },
            "FC6-4": { 
                cost: { meat: 38000000, wood: 38000000, coal: 7600000, iron: 1900000, fire_crystals: 108, refined_fire_crystals: 6 }, 
                time: "2d 16:48:00", 
                power: 724980, 
                prereqs: [{ building: "furnace", level: "FC7" }] 
            },
            "FC7": { 
                cost: { meat: 38000000, wood: 38000000, coal: 7600000, iron: 1900000, fire_crystals: 54, refined_fire_crystals: 13 }, 
                time: "2d 16:48:00", 
                power: 738500, 
                prereqs: [{ building: "furnace", level: "FC7" }] 
            },
            "FC7-1": { 
                cost: { meat: 46000000, wood: 46000000, coal: 9300000, iron: 2300000, fire_crystals: 108, refined_fire_crystals: 9 }, 
                time: "3d 00:00:00", 
                power: 752020, 
                prereqs: [{ building: "furnace", level: "FC8" }] 
            },
            "FC7-2": { 
                cost: { meat: 46000000, wood: 46000000, coal: 9300000, iron: 2300000, fire_crystals: 108, refined_fire_crystals: 9 }, 
                time: "3d 00:00:00", 
                power: 765540, 
                prereqs: [{ building: "furnace", level: "FC8" }] 
            },
            "FC7-3": { 
                cost: { meat: 46000000, wood: 46000000, coal: 9300000, iron: 2300000, fire_crystals: 108, refined_fire_crystals: 9 }, 
                time: "3d 00:00:00", 
                power: 779060, 
                prereqs: [{ building: "furnace", level: "FC8" }] 
            },
            "FC7-4": { 
                cost: { meat: 46000000, wood: 46000000, coal: 9300000, iron: 2300000, fire_crystals: 108, refined_fire_crystals: 9 }, 
                time: "3d 00:00:00", 
                power: 792580, 
                prereqs: [{ building: "furnace", level: "FC8" }] 
            },
            "FC8": { 
                cost: { meat: 46000000, wood: 46000000, coal: 9300000, iron: 2300000, fire_crystals: 54, refined_fire_crystals: 18 }, 
                time: "3d 00:00:00", 
                power: 806100, 
                prereqs: [{ building: "furnace", level: "FC8" }] 
            },
            "FC8-1": { 
                cost: { meat: 50000000, wood: 50000000, coal: 10000000, iron: 2500000, fire_crystals: 126, refined_fire_crystals: 13 }, 
                time: "1d 22:48:00", 
                power: 820580, 
                prereqs: [{ building: "furnace", level: "FC9" }] 
            },
            "FC8-2": { 
                cost: { meat: 50000000, wood: 50000000, coal: 10000000, iron: 2500000, fire_crystals: 126, refined_fire_crystals: 13 }, 
                time: "1d 22:48:00", 
                power: 835060, 
                prereqs: [{ building: "furnace", level: "FC9" }] 
            },
            "FC8-3": { 
                cost: { meat: 50000000, wood: 50000000, coal: 10000000, iron: 2500000, fire_crystals: 126, refined_fire_crystals: 13 }, 
                time: "1d 22:48:00", 
                power: 849540, 
                prereqs: [{ building: "furnace", level: "FC9" }] 
            },
            "FC8-4": { 
                cost: { meat: 50000000, wood: 50000000, coal: 10000000, iron: 2500000, fire_crystals: 126, refined_fire_crystals: 13 }, 
                time: "1d 22:48:00", 
                power: 864020, 
                prereqs: [{ building: "furnace", level: "FC9" }] 
            },
            "FC9": { 
                cost: { meat: 50000000, wood: 50000000, coal: 10000000, iron: 2500000, fire_crystals: 63, refined_fire_crystals: 27 }, 
                time: "1d 22:48:00", 
                power: 878500, 
                prereqs: [{ building: "furnace", level: "FC9" }] 
            },
            "FC9-1": { 
                cost: { meat: 59000000, wood: 59000000, coal: 11000000, iron: 2900000, fire_crystals: 157, refined_fire_crystals: 31 }, 
                time: "3d 00:00:00", 
                power: 892980, 
                prereqs: [{ building: "furnace", level: "FC10" }] 
            },
            "FC9-2": { 
                cost: { meat: 59000000, wood: 59000000, coal: 11000000, iron: 2900000, fire_crystals: 157, refined_fire_crystals: 31 }, 
                time: "3d 00:00:00", 
                power: 907460, 
                prereqs: [{ building: "furnace", level: "FC10" }] 
            },
            "FC9-3": { 
                cost: { meat: 59000000, wood: 59000000, coal: 11000000, iron: 2900000, fire_crystals: 157, refined_fire_crystals: 31 }, 
                time: "3d 00:00:00", 
                power: 921940, 
                prereqs: [{ building: "furnace", level: "FC10" }] 
            },
            "FC9-4": { 
                cost: { meat: 59000000, wood: 59000000, coal: 11000000, iron: 2900000, fire_crystals: 157, refined_fire_crystals: 31 }, 
                time: "3d 00:00:00", 
                power: 936420, 
                prereqs: [{ building: "furnace", level: "FC10" }] 
            },
            "FC10": { 
                cost: { meat: 59000000, wood: 59000000, coal: 11000000, iron: 2900000, fire_crystals: 78, refined_fire_crystals: 63 }, 
                time: "3d 00:00:00", 
                power: 950900, 
                prereqs: [{ building: "furnace", level: "FC10" }] 
            }
        }
    },
    marksman_camp: {
        name: "Marksman Camp",
        levels: {
            1: { 
                cost: { wood: 95 }, 
                time: "00:00:02", 
                power: 400, 
                prereqs: [{ building: "furnace", level: 8 }] 
            },
            2: { 
                cost: { wood: 140 }, 
                time: "00:00:09", 
                power: 760, 
                prereqs: [{ building: "furnace", level: 8 }] 
            },
            3: { 
                cost: { wood: 645 }, 
                time: "00:00:45", 
                power: 1300, 
                prereqs: [{ building: "furnace", level: 8 }] 
            },
            4: { 
                cost: { wood: 1400, coal: 285 }, 
                time: "00:00:21:00", 
                power: 2020, 
                prereqs: [{ building: "furnace", level: 8 }] 
            },
            5: { 
                cost: { wood: 6000, coal: 1200 }, 
                time: "00:00:04:30", 
                power: 3100, 
                prereqs: [{ building: "furnace", level: 8 }] 
            },
            6: { 
                cost: { wood: 15000, coal: 3000, iron: 765 }, 
                time: "00:00:09:00", 
                power: 4720, 
                prereqs: [{ building: "furnace", level: 8 }] 
            },
            7: { 
                cost: { wood: 55000, coal: 11000, iron: 2700 }, 
                time: "00:00:18:00", 
                power: 7060, 
                prereqs: [{ building: "furnace", level: 8 }] 
            },
            8: { 
                cost: { wood: 100000, coal: 20000, iron: 5000 }, 
                time: "00:00:27:00", 
                power: 9400, 
                prereqs: [{ building: "furnace", level: 8 }] 
            },
            9: { 
                cost: { wood: 200000, coal: 41000, iron: 10000 }, 
                time: "00:00:40:30", 
                power: 11740, 
                prereqs: [{ building: "furnace", level: 9 }] 
            },
            10: { 
                cost: { wood: 360000, coal: 73000, iron: 18000 }, 
                time: "00:00:54:00", 
                power: 15140, 
                prereqs: [{ building: "furnace", level: 10 }] 
            },
            11: { 
                cost: { meat: 460000, wood: 460000, coal: 92000, iron: 23000 }, 
                time: "00:01:07:30", 
                power: 18540, 
                prereqs: [{ building: "furnace", level: 11 }] 
            },
            12: { 
                cost: { meat: 580000, wood: 580000, coal: 110000, iron: 29000 }, 
                time: "00:01:21:00", 
                power: 21940, 
                prereqs: [{ building: "furnace", level: 12 }] 
            },
            13: { 
                cost: { meat: 830000, wood: 830000, coal: 160000, iron: 41000 }, 
                time: "00:01:39:00", 
                power: 27680, 
                prereqs: [{ building: "furnace", level: 13 }] 
            },
            14: { 
                cost: { meat: 1100000, wood: 1100000, coal: 220000, iron: 55000 }, 
                time: "00:02:06:00", 
                power: 33420, 
                prereqs: [{ building: "furnace", level: 14 }] 
            },
            15: { 
                cost: { meat: 1600000, wood: 1600000, coal: 320000, iron: 81000 }, 
                time: "00:02:42:00", 
                power: 39160, 
                prereqs: [{ building: "furnace", level: 15 }] 
            },
            16: { 
                cost: { meat: 2000000, wood: 2000000, coal: 410000, iron: 100000 }, 
                time: "00:04:34:00", 
                power: 47240, 
                prereqs: [{ building: "furnace", level: 16 }] 
            },
            17: { 
                cost: { meat: 3200000, wood: 3200000, coal: 650000, iron: 160000 }, 
                time: "00:05:29:00", 
                power: 55320, 
                prereqs: [{ building: "furnace", level: 17 }] 
            },
            18: { 
                cost: { meat: 4300000, wood: 4300000, coal: 870000, iron: 210000 }, 
                time: "00:06:35:00", 
                power: 63400, 
                prereqs: [{ building: "furnace", level: 18 }] 
            },
            19: { 
                cost: { meat: 5400000, wood: 5400000, coal: 1000000, iron: 270000 }, 
                time: "00:09:52:30", 
                power: 74880, 
                prereqs: [{ building: "furnace", level: 19 }] 
            },
            20: { 
                cost: { meat: 7500000, wood: 7500000, coal: 1500000, iron: 370000 }, 
                time: "00:12:20:30", 
                power: 86360, 
                prereqs: [{ building: "furnace", level: 20 }] 
            },
            21: { 
                cost: { meat: 9500000, wood: 9500000, coal: 1900000, iron: 470000 }, 
                time: "00:16:02:30", 
                power: 97840, 
                prereqs: [{ building: "furnace", level: 21 }] 
            },
            22: { 
                cost: { meat: 12000000, wood: 12000000, coal: 2500000, iron: 630000 }, 
                time: "01:00:04:00", 
                power: 115060, 
                prereqs: [{ building: "furnace", level: 22 }] 
            },
            23: { 
                cost: { meat: 15000000, wood: 15000000, coal: 3100000, iron: 490000 }, 
                time: "01:09:42:00", 
                power: 132280, 
                prereqs: [{ building: "furnace", level: 23 }] 
            },
            24: { 
                cost: { meat: 21000000, wood: 21000000, coal: 4200000, iron: 1000000 }, 
                time: "01:23:11:00", 
                power: 149500, 
                prereqs: [{ building: "furnace", level: 24 }] 
            },
            25: { 
                cost: { meat: 28000000, wood: 28000000, coal: 5700000, iron: 1400000 }, 
                time: "02:18:03:00", 
                power: 166720, 
                prereqs: [{ building: "furnace", level: 25 }] 
            },
            26: { 
                cost: { meat: 36000000, wood: 36000000, coal: 7300000, iron: 1800000 }, 
                time: "03:03:57:00", 
                power: 192020, 
                prereqs: [{ building: "furnace", level: 26 }] 
            },
            27: { 
                cost: { meat: 52000000, wood: 52000000, coal: 10000000, iron: 2600000 }, 
                time: "03:19:09:00", 
                power: 217320, 
                prereqs: [{ building: "furnace", level: 27 }] 
            },
            28: { 
                cost: { meat: 69000000, wood: 69000000, coal: 13000000, iron: 3400000 }, 
                time: "04:08:49:00", 
                power: 242620, 
                prereqs: [{ building: "furnace", level: 28 }] 
            },
            29: { 
                cost: { meat: 86000000, wood: 86000000, coal: 17000000, iron: 4300000 }, 
                time: "05:00:33:00", 
                power: 267920, 
                prereqs: [{ building: "furnace", level: 29 }] 
            },
            30: { 
                cost: { meat: 100000000, wood: 100000000, coal: 21000000, iron: 5200000 }, 
                time: "06:00:40:00", 
                power: 304700, 
                prereqs: [{ building: "furnace", level: 30 }] 
            },
            "30-1": { 
                cost: { meat: 23000000, wood: 23000000, coal: 4700000, iron: 1100000, fire_crystals: 59 }, 
                time: "01:01:12:00", 
                power: 316180, 
                prereqs: [{ building: "furnace", level: "FC1" }] 
            },
            "30-2": { 
                cost: { meat: 23000000, wood: 23000000, coal: 4700000, iron: 1100000, fire_crystals: 59 }, 
                time: "01:01:12:00", 
                power: 327660, 
                prereqs: [{ building: "furnace", level: "FC1" }] 
            },
            "30-3": { 
                cost: { meat: 23000000, wood: 23000000, coal: 4700000, iron: 1100000, fire_crystals: 59 }, 
                time: "01:01:12:00", 
                power: 339140, 
                prereqs: [{ building: "furnace", level: "FC1" }] 
            },
            "30-4": { 
                cost: { meat: 23000000, wood: 23000000, coal: 4700000, iron: 1100000, fire_crystals: 59 }, 
                time: "01:01:12:00", 
                power: 350620, 
                prereqs: [{ building: "furnace", level: "FC1" }] 
            },
            "FC1": { 
                cost: { meat: 23000000, wood: 23000000, coal: 4700000, iron: 1100000, fire_crystals: 59 }, 
                time: "01:01:12:00", 
                power: 362100, 
                prereqs: [{ building: "furnace", level: "FC1" }] 
            },
            "FC1-1": { 
                cost: { meat: 25000000, wood: 25000000, coal: 5000000, iron: 1200000, fire_crystals: 71 }, 
                time: "01:08:24:00", 
                power: 373580, 
                prereqs: [{ building: "furnace", level: "FC2" }] 
            },
            "FC1-2": { 
                cost: { meat: 25000000, wood: 25000000, coal: 5000000, iron: 1200000, fire_crystals: 71 }, 
                time: "01:08:24:00", 
                power: 385060, 
                prereqs: [{ building: "furnace", level: "FC2" }] 
            },
            "FC1-3": { 
                cost: { meat: 25000000, wood: 25000000, coal: 5000000, iron: 1200000, fire_crystals: 71 }, 
                time: "01:08:24:00", 
                power: 396540, 
                prereqs: [{ building: "furnace", level: "FC2" }] 
            },
            "FC1-4": { 
                cost: { meat: 25000000, wood: 25000000, coal: 5000000, iron: 1200000, fire_crystals: 71 }, 
                time: "01:08:24:00", 
                power: 408020, 
                prereqs: [{ building: "furnace", level: "FC2" }] 
            },
            "FC2": { 
                cost: { meat: 25000000, wood: 25000000, coal: 5000000, iron: 1200000, fire_crystals: 71 }, 
                time: "01:08:24:00", 
                power: 419500, 
                prereqs: [{ building: "furnace", level: "FC2" }] 
            },
            "FC2-1": { 
                cost: { meat: 27000000, wood: 27000000, coal: 5500000, iron: 1300000, fire_crystals: 107 }, 
                time: "01:15:36:00", 
                power: 430980, 
                prereqs: [{ building: "furnace", level: "FC3" }] 
            },
            "FC2-2": { 
                cost: { meat: 27000000, wood: 27000000, coal: 5500000, iron: 1300000, fire_crystals: 107 }, 
                time: "01:15:36:00", 
                power: 442460, 
                prereqs: [{ building: "furnace", level: "FC3" }] 
            },
            "FC2-3": { 
                cost: { meat: 27000000, wood: 27000000, coal: 5500000, iron: 1300000, fire_crystals: 107 }, 
                time: "01:15:36:00", 
                power: 453940, 
                prereqs: [{ building: "furnace", level: "FC3" }] 
            },
            "FC2-4": { 
                cost: { meat: 27000000, wood: 27000000, coal: 5500000, iron: 1300000, fire_crystals: 107 }, 
                time: "01:15:36:00", 
                power: 465420, 
                prereqs: [{ building: "furnace", level: "FC3" }] 
            },
            "FC3": { 
                cost: { meat: 27000000, wood: 27000000, coal: 5500000, iron: 1300000, fire_crystals: 107 }, 
                time: "01:15:36:00", 
                power: 476900, 
                prereqs: [{ building: "furnace", level: "FC3" }] 
            },
            "FC3-1": { 
                cost: { meat: 28000000, wood: 28000000, coal: 5700000, iron: 1400000, fire_crystals: 126 }, 
                time: "01:19:12:00", 
                power: 489540, 
                prereqs: [{ building: "furnace", level: "FC4" }] 
            },
            "FC3-2": { 
                cost: { meat: 28000000, wood: 28000000, coal: 5700000, iron: 1400000, fire_crystals: 126 }, 
                time: "01:19:12:00", 
                power: 502180, 
                prereqs: [{ building: "furnace", level: "FC4" }] 
            },
            "FC3-3": { 
                cost: { meat: 28000000, wood: 28000000, coal: 5700000, iron: 1400000, fire_crystals: 126 }, 
                time: "01:19:12:00", 
                power: 514820, 
                prereqs: [{ building: "furnace", level: "FC4" }] 
            },
            "FC3-4": { 
                cost: { meat: 28000000, wood: 28000000, coal: 5700000, iron: 1400000, fire_crystals: 126 }, 
                time: "01:19:12:00", 
                power: 527460, 
                prereqs: [{ building: "furnace", level: "FC4" }] 
            },
            "FC4": { 
                cost: { meat: 28000000, wood: 28000000, coal: 5700000, iron: 1400000, fire_crystals: 126 }, 
                time: "01:19:12:00", 
                power: 540100, 
                prereqs: [{ building: "furnace", level: "FC4" }] 
            },
            "FC4-1": { 
                cost: { meat: 29000000, wood: 29000000, coal: 5900000, iron: 1400000, fire_crystals: 150 }, 
                time: "02:02:24:00", 
                power: 552740, 
                prereqs: [{ building: "furnace", level: "FC5" }] 
            },
            "FC4-2": { 
                cost: { meat: 29000000, wood: 29000000, coal: 5900000, iron: 1400000, fire_crystals: 150 }, 
                time: "02:02:24:00", 
                power: 565380, 
                prereqs: [{ building: "furnace", level: "FC5" }] 
            },
            "FC4-3": { 
                cost: { meat: 29000000, wood: 29000000, coal: 5900000, iron: 1400000, fire_crystals: 150 }, 
                time: "02:02:24:00", 
                power: 578020, 
                prereqs: [{ building: "furnace", level: "FC5" }] 
            },
            "FC4-4": { 
                cost: { meat: 29000000, wood: 29000000, coal: 5900000, iron: 1400000, fire_crystals: 150 }, 
                time: "02:02:24:00", 
                power: 590660, 
                prereqs: [{ building: "furnace", level: "FC5" }] 
            },
            "FC5": { 
                cost: { meat: 29000000, wood: 29000000, coal: 5900000, iron: 1400000, fire_crystals: 150 }, 
                time: "02:02:24:00", 
                power: 603300, 
                prereqs: [{ building: "furnace", level: "FC5" }] 
            },
            "FC5-1": { 
                cost: { meat: 33000000, wood: 33000000, coal: 6700000, iron: 1600000, fire_crystals: 90, refined_fire_crystals: 4 }, 
                time: "02:06:00:00", 
                power: 616820, 
                prereqs: [{ building: "furnace", level: "FC6" }] 
            },
            "FC5-2": { 
                cost: { meat: 33000000, wood: 33000000, coal: 6700000, iron: 1600000, fire_crystals: 90, refined_fire_crystals: 4 }, 
                time: "02:06:00:00", 
                power: 630340, 
                prereqs: [{ building: "furnace", level: "FC6" }] 
            },
            "FC5-3": { 
                cost: { meat: 33000000, wood: 33000000, coal: 6700000, iron: 1600000, fire_crystals: 90, refined_fire_crystals: 4 }, 
                time: "02:06:00:00", 
                power: 643860, 
                prereqs: [{ building: "furnace", level: "FC6" }] 
            },
            "FC5-4": { 
                cost: { meat: 33000000, wood: 33000000, coal: 6700000, iron: 1600000, fire_crystals: 90, refined_fire_crystals: 4 }, 
                time: "02:06:00:00", 
                power: 657380, 
                prereqs: [{ building: "furnace", level: "FC6" }] 
            },
            "FC6": { 
                cost: { meat: 33000000, wood: 33000000, coal: 6700000, iron: 1600000, fire_crystals: 45, refined_fire_crystals: 9 }, 
                time: "02:06:00:00", 
                power: 670990, 
                prereqs: [{ building: "furnace", level: "FC6" }] 
            },
            "FC6-1": { 
                cost: { meat: 38000000, wood: 38000000, coal: 7600000, iron: 1900000, fire_crystals: 108, refined_fire_crystals: 6 }, 
                time: "02:16:48:00", 
                power: 684420, 
                prereqs: [{ building: "furnace", level: "FC7" }] 
            },
            "FC6-2": { 
                cost: { meat: 38000000, wood: 38000000, coal: 7600000, iron: 1900000, fire_crystals: 108, refined_fire_crystals: 6 }, 
                time: "02:16:48:00", 
                power: 697940, 
                prereqs: [{ building: "furnace", level: "FC7" }] 
            },
            "FC6-3": { 
                cost: { meat: 38000000, wood: 38000000, coal: 7600000, iron: 1900000, fire_crystals: 108, refined_fire_crystals: 6 }, 
                time: "02:16:48:00", 
                power: 711460, 
                prereqs: [{ building: "furnace", level: "FC7" }] 
            },
            "FC6-4": { 
                cost: { meat: 38000000, wood: 38000000, coal: 7600000, iron: 1900000, fire_crystals: 108, refined_fire_crystals: 6 }, 
                time: "02:16:48:00", 
                power: 724980, 
                prereqs: [{ building: "furnace", level: "FC7" }] 
            },
            "FC7": { 
                cost: { meat: 38000000, wood: 38000000, coal: 7600000, iron: 1900000, fire_crystals: 54, refined_fire_crystals: 9 }, 
                time: "02:16:48:00", 
                power: 738500, 
                prereqs: [{ building: "furnace", level: "FC7" }] 
            },
            "FC7-1": { 
                cost: { meat: 46000000, wood: 46000000, coal: 9300000, iron: 2300000, fire_crystals: 108, refined_fire_crystals: 9 }, 
                time: "03:00:00:00", 
                power: 752020, 
                prereqs: [{ building: "furnace", level: "FC8" }] 
            },
            "FC7-2": { 
                cost: { meat: 46000000, wood: 46000000, coal: 9300000, iron: 2300000, fire_crystals: 108, refined_fire_crystals: 9 }, 
                time: "03:00:00:00", 
                power: 765540, 
                prereqs: [{ building: "furnace", level: "FC8" }] 
            },
            "FC7-3": { 
                cost: { meat: 46000000, wood: 46000000, coal: 9300000, iron: 2300000, fire_crystals: 108, refined_fire_crystals: 9 }, 
                time: "03:00:00:00", 
                power: 779060, 
                prereqs: [{ building: "furnace", level: "FC8" }] 
            },
            "FC7-4": { 
                cost: { meat: 46000000, wood: 46000000, coal: 9300000, iron: 2300000, fire_crystals: 108, refined_fire_crystals: 9 }, 
                time: "03:00:00:00", 
                power: 792580, 
                prereqs: [{ building: "furnace", level: "FC8" }] 
            },
            "FC8": { 
                cost: { meat: 46000000, wood: 46000000, coal: 9300000, iron: 2300000, fire_crystals: 54, refined_fire_crystals: 19 }, 
                time: "03:00:00:00", 
                power: 806100, 
                prereqs: [{ building: "furnace", level: "FC8" }] 
            },
            "FC8-1": { 
                cost: { meat: 50000000, wood: 50000000, coal: 10000000, iron: 2500000, fire_crystals: 126, refined_fire_crystals: 13 }, 
                time: "01:22:48:00", 
                power: 820580, 
                prereqs: [{ building: "furnace", level: "FC9" }] 
            },
            "FC8-2": { 
                cost: { meat: 50000000, wood: 50000000, coal: 10000000, iron: 2500000, fire_crystals: 126, refined_fire_crystals: 13 }, 
                time: "01:22:48:00", 
                power: 835060, 
                prereqs: [{ building: "furnace", level: "FC9" }] 
            },
            "FC8-3": { 
                cost: { meat: 50000000, wood: 50000000, coal: 10000000, iron: 2500000, fire_crystals: 126, refined_fire_crystals: 13 }, 
                time: "01:22:48:00", 
                power: 849540, 
                prereqs: [{ building: "furnace", level: "FC9" }] 
            },
            "FC8-4": { 
                cost: { meat: 50000000, wood: 50000000, coal: 10000000, iron: 2500000, fire_crystals: 126, refined_fire_crystals: 13 }, 
                time: "01:22:48:00", 
                power: 864020, 
                prereqs: [{ building: "furnace", level: "FC9" }] 
            },
            "FC9": { 
                cost: { meat: 50000000, wood: 50000000, coal: 10000000, iron: 2500000, fire_crystals: 63, refined_fire_crystals: 27 }, 
                time: "01:22:48:00", 
                power: 878500, 
                prereqs: [{ building: "furnace", level: "FC9" }] 
            },
            "FC9-1": { 
                cost: { meat: 59000000, wood: 59000000, coal: 11000000, iron: 2900000, fire_crystals: 157, refined_fire_crystals: 31 }, 
                time: "03:00:00:00", 
                power: 892980, 
                prereqs: [{ building: "furnace", level: "FC10" }] 
            },
            "FC9-2": { 
                cost: { meat: 59000000, wood: 59000000, coal: 11000000, iron: 2900000, fire_crystals: 157, refined_fire_crystals: 31 }, 
                time: "03:00:00:00", 
                power: 907460, 
                prereqs: [{ building: "furnace", level: "FC10" }] 
            },
            "FC9-3": { 
                cost: { meat: 59000000, wood: 59000000, coal: 11000000, iron: 2900000, fire_crystals: 157, refined_fire_crystals: 31 }, 
                time: "03:00:00:00", 
                power: 921940, 
                prereqs: [{ building: "furnace", level: "FC10" }] 
            },
            "FC9-4": { 
                cost: { meat: 59000000, wood: 59000000, coal: 11000000, iron: 2900000, fire_crystals: 157, refined_fire_crystals: 31 }, 
                time: "03:00:00:00", 
                power: 936420, 
                prereqs: [{ building: "furnace", level: "FC10" }] 
            },
            "FC10": { 
                cost: { meat: 59000000, wood: 59000000, coal: 11000000, iron: 2900000, fire_crystals: 78, refined_fire_crystals: 63 }, 
                time: "03:00:00:00", 
                power: 950900, 
                prereqs: [{ building: "furnace", level: "FC10" }] 
            }
        }
    },
    barricade: {
        name: "Barricade",
        levels: {
            1: { 
                cost: {}, 
                time: "", 
                power: 400, 
                prereqs: [] 
            },
            2: { 
                cost: { wood: 5300, coal: 1000 }, 
                time: "00:00:10", 
                power: 3100, 
                prereqs: [{ building: "furnace", level: 7 }] 
            },
            3: { 
                cost: { wood: 88000, coal: 17000, iron: 4400 }, 
                time: "00:21:30", 
                power: 9400, 
                prereqs: [{ building: "furnace", level: 10 }] 
            },
            4: { 
                cost: { meat: 420000, wood: 420000, coal: 84000, iron: 21000 }, 
                time: "01:04:30", 
                power: 21940, 
                prereqs: [{ building: "furnace", level: 13 }] 
            },
            5: { 
                cost: { meat: 1400000, wood: 1400000, coal: 290000, iron: 74000 }, 
                time: "03:39:00", 
                power: 47240, 
                prereqs: [{ building: "furnace", level: 16 }] 
            },
            6: { 
                cost: { meat: 5300000, wood: 5300000, coal: 1000000, iron: 260000 }, 
                time: "09:52:30", 
                power: 86360, 
                prereqs: [{ building: "furnace", level: 20 }] 
            },
            7: { 
                cost: { meat: 15000000, wood: 15000000, coal: 3000000, iron: 750000 }, 
                time: "1d 13:44:00", 
                power: 149500, 
                prereqs: [{ building: "furnace", level: 24 }] 
            },
            8: { 
                cost: { meat: 37000000, wood: 37000000, coal: 7400000, iron: 1800000 }, 
                time: "3d 00:55:00", 
                power: 217320, 
                prereqs: [{ building: "furnace", level: 27 }] 
            },
            9: { 
                cost: { meat: 61000000, wood: 61000000, coal: 12000000, iron: 3000000 }, 
                time: "4d 00:26:00", 
                power: 267920, 
                prereqs: [{ building: "furnace", level: 29 }] 
            },
            10: { 
                cost: { meat: 75000000, wood: 75000000, coal: 15000000, iron: 3700000 }, 
                time: "4d 19:44:00", 
                power: 304700, 
                prereqs: [{ building: "furnace", level: 30 }] 
            }
        }
    },
    storehouse: {
        name: "Storehouse",
        levels: {
            1: { 
                cost: { wood: 60 }, 
                time: "00:00:02", 
                power: 440, 
                prereqs: [{ building: "furnace", level: 9 }] 
            },
            2: { 
                cost: { wood: 90 }, 
                time: "00:00:09", 
                power: 836, 
                prereqs: [{ building: "furnace", level: 9 }] 
            },
            3: { 
                cost: { wood: 400 }, 
                time: "00:00:45", 
                power: 1430, 
                prereqs: [{ building: "furnace", level: 9 }] 
            },
            4: { 
                cost: { wood: 900, coal: 180 }, 
                time: "00:02:15", 
                power: 2222, 
                prereqs: [{ building: "furnace", level: 9 }] 
            },
            5: { 
                cost: { wood: 3800, coal: 760 }, 
                time: "00:04:30", 
                power: 3410, 
                prereqs: [{ building: "furnace", level: 9 }] 
            },
            6: { 
                cost: { wood: 9600, coal: 1900, iron: 480 }, 
                time: "00:09:00", 
                power: 5192, 
                prereqs: [{ building: "furnace", level: 9 }] 
            },
            7: { 
                cost: { wood: 34000, coal: 6900, iron: 1700 }, 
                time: "00:18:00", 
                power: 7766, 
                prereqs: [{ building: "furnace", level: 9 }] 
            },
            8: { 
                cost: { wood: 63000, coal: 12000, iron: 3100 }, 
                time: "00:27:00", 
                power: 10340, 
                prereqs: [{ building: "furnace", level: 9 }] 
            },
            9: { 
                cost: { wood: 130000, coal: 26000, iron: 6500 }, 
                time: "00:40:30", 
                power: 12914, 
                prereqs: [{ building: "furnace", level: 9 }] 
            },
            10: { 
                cost: { wood: 230000, coal: 46000, iron: 11000 }, 
                time: "00:54:00", 
                power: 16654, 
                prereqs: [{ building: "furnace", level: 10 }] 
            },
            11: { 
                cost: { meat: 280000, wood: 280000, coal: 57000, iron: 14000 }, 
                time: "01:07:30", 
                power: 20394, 
                prereqs: [{ building: "furnace", level: 11 }] 
            },
            12: { 
                cost: { meat: 370000, wood: 370000, coal: 74000, iron: 18000 }, 
                time: "01:21:00", 
                power: 24134, 
                prereqs: [{ building: "furnace", level: 12 }] 
            },
            13: { 
                cost: { meat: 520000, wood: 520000, coal: 100000, iron: 26000 }, 
                time: "01:39:00", 
                power: 30448, 
                prereqs: [{ building: "furnace", level: 13 }] 
            },
            14: { 
                cost: { meat: 690000, wood: 690000, coal: 130000, iron: 34000 }, 
                time: "02:06:00", 
                power: 36762, 
                prereqs: [{ building: "furnace", level: 14 }] 
            },
            15: { 
                cost: { meat: 1000000, wood: 1000000, coal: 200000, iron: 51000 }, 
                time: "02:42:00", 
                power: 43076, 
                prereqs: [{ building: "furnace", level: 15 }] 
            },
            16: { 
                cost: { meat: 1300000, wood: 1300000, coal: 260000, iron: 65000 }, 
                time: "04:34:00", 
                power: 51964, 
                prereqs: [{ building: "furnace", level: 16 }] 
            },
            17: { 
                cost: { meat: 2000000, wood: 2000000, coal: 400000, iron: 100000 }, 
                time: "05:29:00", 
                power: 60852, 
                prereqs: [{ building: "furnace", level: 17 }] 
            },
            18: { 
                cost: { meat: 2700000, wood: 2700000, coal: 550000, iron: 130000 }, 
                time: "06:35:00", 
                power: 69740, 
                prereqs: [{ building: "furnace", level: 18 }] 
            },
            19: { 
                cost: { meat: 3400000, wood: 3400000, coal: 690000, iron: 170000 }, 
                time: "09:52:30", 
                power: 82368, 
                prereqs: [{ building: "furnace", level: 19 }] 
            },
            20: { 
                cost: { meat: 4700000, wood: 4700000, coal: 940000, iron: 230000 }, 
                time: "12:20:30", 
                power: 94996, 
                prereqs: [{ building: "furnace", level: 20 }] 
            },
            21: { 
                cost: { meat: 6000000, wood: 6000000, coal: 1200000, iron: 300000 }, 
                time: "16:02:30", 
                power: 107624, 
                prereqs: [{ building: "furnace", level: 21 }] 
            },
            22: { 
                cost: { meat: 7900000, wood: 7900000, coal: 1500000, iron: 390000 }, 
                time: "1d 00:04:00", 
                power: 126566, 
                prereqs: [{ building: "furnace", level: 22 }] 
            },
            23: { 
                cost: { meat: 9800000, wood: 9800000, coal: 1900000, iron: 490000 }, 
                time: "1d 09:42:00", 
                power: 145508, 
                prereqs: [{ building: "furnace", level: 23 }] 
            },
            24: { 
                cost: { meat: 13000000, wood: 13000000, coal: 2600000, iron: 660000 }, 
                time: "1d 23:11:00", 
                power: 164450, 
                prereqs: [{ building: "furnace", level: 24 }] 
            },
            25: { 
                cost: { meat: 17000000, wood: 17000000, coal: 3500000, iron: 890000 }, 
                time: "2d 18:03:00", 
                power: 183392, 
                prereqs: [{ building: "furnace", level: 25 }] 
            },
            26: { 
                cost: { meat: 23000000, wood: 23000000, coal: 4600000, iron: 1100000 }, 
                time: "3d 03:57:00", 
                power: 211222, 
                prereqs: [{ building: "furnace", level: 26 }] 
            },
            27: { 
                cost: { meat: 32000000, wood: 32000000, coal: 6500000, iron: 1600000 }, 
                time: "3d 19:09:00", 
                power: 239052, 
                prereqs: [{ building: "furnace", level: 27 }] 
            },
            28: { 
                cost: { meat: 43000000, wood: 43000000, coal: 8700000, iron: 2100000 }, 
                time: "4d 08:49:00", 
                power: 266882, 
                prereqs: [{ building: "furnace", level: 28 }] 
            },
            29: { 
                cost: { meat: 54000000, wood: 54000000, coal: 10000000, iron: 2700000 }, 
                time: "5d 00:33:00", 
                power: 294712, 
                prereqs: [{ building: "furnace", level: 29 }] 
            },
            30: { 
                cost: { meat: 66000000, wood: 66000000, coal: 13000000, iron: 3300000 }, 
                time: "6d 00:40:00", 
                power: 335170, 
                prereqs: [{ building: "furnace", level: 30 }] 
            }
        }
    }
};
        // Improved levelToComparable function that handles Furnace/Embassy FC level ordering correctly
        function levelToComparable(levelKey) {
            if (typeof levelKey === 'string') {
                // Handle "30-x" levels (e.g., "30-1", "30-2", etc.)
                const thirtyDashMatch = levelKey.match(/^30-(\d+)$/);
                if (thirtyDashMatch) {
                    const subLevel = parseInt(thirtyDashMatch[1]);
                    // Return a value that places 30-x levels between 30 and FC1
                    // e.g., "30-1" -> 3001, "30-4" -> 3004
                    return 3000 + subLevel;
                }

                // Handle FC levels (e.g., "FC1", "FC1-1", etc.)
                const fcMatch = levelKey.match(/^FC(\d+)(?:-(\d+))?$/);
                if (fcMatch) {
                    const fcNumber = parseInt(fcMatch[1]);
                    const fcSubLevel = fcMatch[2] ? parseInt(fcMatch[2]) : 0;
                    // Return a value that places FC levels after 30-x levels
                    // e.g., "FC1" -> 4001, "FC1-1" -> 4001.1, "FC2" -> 4002
                    return 4000 + fcNumber + (fcSubLevel / 10.0);
                }

                // Handle regular numeric levels with optional decimal sub-levels (e.g., "1", "2", ..., "30")
                const numericMatch = levelKey.match(/^(\d+)(?:\.(\d+))?$/);
                if (numericMatch) {
                    const mainLevel = parseInt(numericMatch[1]);
                    return mainLevel;
                }

                // Default for any other unrecognized string levels (should not happen with correct data)
                return parseInt(levelKey) || 0;
            }

            // Handle numeric levels
            return parseInt(levelKey) || 0;
        }

        // Helper function to parse time string to seconds
        function parseTimeString(timeString) {
            if (!timeString) return 0;

            // Handle days format "Xd HH:MM:SS"
            const daysMatch = timeString.match(/^(\d+)d\s+(\d+):(\d+):(\d+)$/);
            if (daysMatch) {
                const days = parseInt(daysMatch[1]);
                const hours = parseInt(daysMatch[2]);
                const minutes = parseInt(daysMatch[3]);
                const seconds = parseInt(daysMatch[4]);
                return days * 86400 + hours * 3600 + minutes * 60 + seconds;
            }

            // Handle regular time format "HH:MM:SS" or "DD:HH:MM:SS"
            const timeParts = timeString.split(":");
            if (timeParts.length === 3) {
                const hours = parseInt(timeParts[0]);
                const minutes = parseInt(timeParts[1]);
                const seconds = parseInt(timeParts[2]);
                return hours * 3600 + minutes * 60 + seconds;
            } else if (timeParts.length === 4) {
                const days = parseInt(timeParts[0]);
                const hours = parseInt(timeParts[1]);
                const minutes = parseInt(timeParts[2]);
                const seconds = parseInt(timeParts[3]);
                return days * 86400 + hours * 3600 + minutes * 60 + seconds;
            }

            return 0;
        }

        // Helper function to format seconds back to time string
        function formatTime(seconds) {
            if (isNaN(seconds) || seconds < 0) return "00:00:00";

            const days = Math.floor(seconds / 86400);
            seconds %= 86400;

            const hours = Math.floor(seconds / 3600);
            seconds %= 3600;

            const minutes = Math.floor(seconds / 60);
            seconds %= 60;

            if (days > 0) {
                return `${days}d ${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
            } else {
                return `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
            }
        }

        // Function to get the current level of a building from the UI
        function getCurrentLevel(buildingKey) {
            const select = document.querySelector(`select.current-level.${buildingKey}`);
            return select ? select.value : "0";
        }

        // Function to check if a prerequisite is met
        function isPrerequisiteMet(prereq, currentLevels) {
            const prereqCurrent = currentLevels[prereq.building] || getCurrentLevel(prereq.building);
            return levelToComparable(prereqCurrent) >= levelToComparable(prereq.level);
        }

        // - Enhanced Calculation Logic -
        // Function to calculate costs including prerequisites
        function calculateBuildingCostsWithPrerequisites(targetLevels, currentLevels) {
            let totalResources = {
                meat: 0,
                wood: 0,
                coal: 0,
                iron: 0,
                fire_crystals: 0,
                refined_fire_crystals: 0,
                time_seconds: 0,
                power: 0 // Will hold the power of the final level reached
            };

            let upgradeSteps = [];
            let calculatedUpgrades = {}; // Track upgrades we've already calculated

            // Helper function for recursive calculation
            function calculateUpgradePath(buildingKey, targetLevel, fromPrerequisite = false) {
                const building = buildingData[buildingKey];
                if (!building) {
                    console.warn(`Building data not found for: ${buildingKey}`);
                    return;
                }

                const currentLevel = currentLevels[buildingKey] || getCurrentLevel(buildingKey);
                const currentComparable = levelToComparable(currentLevel);
                const targetComparable = levelToComparable(targetLevel);

                // If already at or above target level, skip
                if (currentComparable >= targetComparable) {
                    return;
                }

                // Create a unique key for this upgrade path to avoid infinite loops
                const upgradeKey = `${buildingKey}_${currentLevel}_to_${targetLevel}_${fromPrerequisite}`;
                if (calculatedUpgrades[upgradeKey]) {
                    return;
                }
                calculatedUpgrades[upgradeKey] = true;

                // Get all level keys sorted numerically
                const levelKeys = Object.keys(building.levels)
                    .sort((a, b) => levelToComparable(a) - levelToComparable(b));

                // Find the indices for current and target levels
                const currentIndex = levelKeys.findIndex(k => levelToComparable(k) > currentComparable);
                const targetIndex = levelKeys.findIndex(k => levelToComparable(k) >= targetComparable);

                // Validate indices
                if (currentIndex === -1 || targetIndex === -1 || targetIndex < currentIndex) {
                    console.warn(`Invalid level range for ${buildingKey}: ${currentLevel} to ${targetLevel}`);
                    return;
                }

                // Process each level in the upgrade path
                for (let i = currentIndex; i <= targetIndex && i < levelKeys.length; i++) {
                    const levelKey = levelKeys[i];
                    const levelData = building.levels[levelKey];

                    // - Prerequisite Check -
                    if (levelData.prereqs && levelData.prereqs.length > 0) {
                        for (const prereq of levelData.prereqs) {
                            // Only calculate if prerequisite is not met
                            if (!isPrerequisiteMet(prereq, currentLevels)) {
                                calculateUpgradePath(prereq.building, prereq.level, true);
                            }
                        }
                    }
                    // - End Prerequisite Check -

                    // Add resources for this level
                    totalResources.meat += levelData.cost.meat || 0;
                    totalResources.wood += levelData.cost.wood || 0;
                    totalResources.coal += levelData.cost.coal || 0;
                    totalResources.iron += levelData.cost.iron || 0;
                    totalResources.fire_crystals += levelData.cost.fire_crystals || 0;
                    totalResources.refined_fire_crystals += levelData.cost.refined_fire_crystals || 0;
                    totalResources.time_seconds += parseTimeString(levelData.time);
                    totalResources.power = levelData.power || 0; // Update power to the level we just reached

                    // Add to upgrade steps
                    upgradeSteps.push({
                        building: building.name,
                        level: levelKey,
                        cost: { ...levelData.cost },
                        time: levelData.time,
                        power: levelData.power || 0,
                        prereq: levelData.prereqs.length > 0 ?
                            levelData.prereqs.map(p => `${p.building.replace(/_/g, ' ')} ${p.level}`).join(', ') : "None",
                        fromPrereq: fromPrerequisite
                    });

                    // Update current level in our working copy
                    currentLevels[buildingKey] = levelKey;
                }
            }

            // Main Calculation Loop
            let workingCurrentLevels = { ...currentLevels };
            for (const buildingKey in targetLevels) {
                const targetLevel = targetLevels[buildingKey];
                calculateUpgradePath(buildingKey, targetLevel, false);
            }

            return { totalResources, upgradeSteps };
        }

        // Function to calculate costs without prerequisites
        function calculateBuildingCostsWithoutPrerequisites(targetLevels, currentLevels) {
            let totalResources = {
                meat: 0,
                wood: 0,
                coal: 0,
                iron: 0,
                fire_crystals: 0,
                refined_fire_crystals: 0,
                time_seconds: 0,
                power: 0
            };

            let upgradeSteps = [];

            for (const buildingKey in targetLevels) {
                const targetLevel = targetLevels[buildingKey];
                const currentLevel = currentLevels[buildingKey] || getCurrentLevel(buildingKey);
                const building = buildingData[buildingKey];

                if (!building) continue;

                const levelKeys = Object.keys(building.levels)
                    .sort((a, b) => levelToComparable(a) - levelToComparable(b));

                const currentIndex = levelKeys.findIndex(k => levelToComparable(k) > levelToComparable(currentLevel));
                const targetIndex = levelKeys.findIndex(k => levelToComparable(k) >= levelToComparable(targetLevel));

                if (currentIndex !== -1 && targetIndex !== -1 && targetIndex >= currentIndex) {
                    for (let i = currentIndex; i <= targetIndex && i < levelKeys.length; i++) {
                        const levelKey = levelKeys[i];
                        const levelData = building.levels[levelKey];

                        totalResources.meat += levelData.cost.meat || 0;
                        totalResources.wood += levelData.cost.wood || 0;
                        totalResources.coal += levelData.cost.coal || 0;
                        totalResources.iron += levelData.cost.iron || 0;
                        totalResources.fire_crystals += levelData.cost.fire_crystals || 0;
                        totalResources.refined_fire_crystals += levelData.cost.refined_fire_crystals || 0;
                        totalResources.time_seconds += parseTimeString(levelData.time);

                        if (i === targetIndex) {
                            totalResources.power = levelData.power || 0;
                        }

                        upgradeSteps.push({
                            building: building.name,
                            level: levelKey,
                            cost: { ...levelData.cost },
                            time: levelData.time,
                            power: levelData.power || 0,
                            prereq: "Ignored (No Prerequisites Mode)",
                            fromPrereq: false
                        });
                    }
                }
            }

            return { totalResources, upgradeSteps };
        }

        // Main calculation function
        function calculateBuildingCosts() {
            const mode = document.getElementById('building-mode').value;
            let targetLevels = {};
            let currentLevels = {};

            // Get current and target levels from UI
            for (const buildingKey in buildingData) {
                if (buildingData.hasOwnProperty(buildingKey)) {
                    const currentSelect = document.querySelector(`select.current-level.${buildingKey}`);
                    const targetSelect = document.querySelector(`select.target-level.${buildingKey}`);

                    if (currentSelect && targetSelect) {
                        const currentLevel = currentSelect.value;
                        const targetLevel = targetSelect.value;
                        currentLevels[buildingKey] = currentLevel;

                        // Only include in targetLevels if target is higher than current
                        if (levelToComparable(targetLevel) > levelToComparable(currentLevel)) {
                            targetLevels[buildingKey] = targetLevel;
                        }
                    }
                }
            }

            let result;
            if (mode === "with") {
                result = calculateBuildingCostsWithPrerequisites(targetLevels, { ...currentLevels });
            } else {
                result = calculateBuildingCostsWithoutPrerequisites(targetLevels, currentLevels);
            }

            const { totalResources, upgradeSteps } = result;

            // Get owned resources
            const ownedResources = {
                meat: parseInt(document.getElementById('owned-meat').value) || 0,
                wood: parseInt(document.getElementById('owned-wood').value) || 0,
                coal: parseInt(document.getElementById('owned-coal').value) || 0,
                iron: parseInt(document.getElementById('owned-iron').value) || 0,
                fire_crystals: parseInt(document.getElementById('owned-fire-crystals').value) || 0,
                refined_fire_crystals: parseInt(document.getElementById('owned-refined-fire-crystals').value) || 0
            };

            // --- Get Construction Time Reduction Bonuses ---
            const constructionSpeedPercent = parseFloat(document.getElementById('construction-speed').value) || 0;
            const hyenaPetPercent = parseFloat(document.getElementById('hyena-pet').value) || 0;
            const doubleTimeChiefChecked = document.getElementById('double-time-chief').checked;
            const vicePresidentChecked = document.getElementById('vice-president').checked;
            const mercantilismChecked = document.getElementById('mercantilism').checked;

            const doubleTimeChiefPercent = doubleTimeChiefChecked ? 20 : 0;
            const vicePresidentPercent = vicePresidentChecked ? 10 : 0;
            const mercantilismPercent = mercantilismChecked ? 10 : 0;

            const timeReductionBonuses = {
                constructionSpeed: constructionSpeedPercent,
                hyenaPet: hyenaPetPercent,
                doubleTimeChief: doubleTimeChiefPercent,
                vicePresident: vicePresidentPercent,
                mercantilism: mercantilismPercent
            };

            // --- Get Speedups ---
            const speedupsMinutes = parseInt(document.getElementById('building-speedups').value) || 0;
            const speedupsSeconds = speedupsMinutes * 60;
            // --- End Get Speedups ---
            // --- End Get Bonuses ---

            // Calculate final resources needed
            const finalResources = {};
            for (const resource in totalResources) {
                if (resource !== 'time_seconds' && resource !== 'power') {
                    finalResources[resource] = Math.max(0, totalResources[resource] - (ownedResources[resource] || 0));
                }
            }

            displayBuildingResults(totalResources, finalResources, upgradeSteps, mode, timeReductionBonuses, speedupsSeconds); // Pass bonuses
        }

        // Function to display results with improved table styling and scrollable container
                // Add timeReductionBonuses parameter
                // Function to display results with improved table styling, scrollable container, and speedups integration
        function displayBuildingResults(total, final, steps, mode, timeReductionBonuses, speedupsSeconds) {
            const resultDiv = document.getElementById('building-result');
            const summaryDiv = document.getElementById('building-resources-summary');
            const pathDiv = document.getElementById('building-upgrade-path');

            if (steps.length === 0) {
                summaryDiv.innerHTML = '<p>No upgrades selected or required.</p>';
                pathDiv.innerHTML = '';
                resultDiv.classList.add('active');
                return;
            }

            let summaryHTML = '<h4 style="margin-top: 0;">Total Resources Required</h4>';
            summaryHTML += `<p>Total Meat: <span>${total.meat.toLocaleString()}</span></p>`;
            summaryHTML += `<p>Total Wood: <span>${total.wood.toLocaleString()}</span></p>`;
            summaryHTML += `<p>Total Coal: <span>${total.coal.toLocaleString()}</span></p>`;
            summaryHTML += `<p>Total Iron: <span>${total.iron.toLocaleString()}</span></p>`;
            summaryHTML += `<p>Total Fire Crystals: <span>${total.fire_crystals.toLocaleString()}</span></p>`;
            summaryHTML += `<p>Total Refined Fire Crystals: <span>${total.refined_fire_crystals.toLocaleString()}</span></p>`;
            
            // --- Time Reduction Calculation and Summary (Corrected Multiplicative Speed Logic) ---
            const baseTimeSeconds = total.time_seconds;
            
            // Calculate total speed bonus percentage (additive from all sources)
            let totalSpeedBonusPercent = 0;
            totalSpeedBonusPercent += timeReductionBonuses.constructionSpeed || 0;
            totalSpeedBonusPercent += timeReductionBonuses.hyenaPet || 0;
            totalSpeedBonusPercent += timeReductionBonuses.doubleTimeChief || 0;
            totalSpeedBonusPercent += timeReductionBonuses.vicePresident || 0;
            totalSpeedBonusPercent += timeReductionBonuses.mercantilism || 0;
            
            // Convert total speed bonus to a multiplier (e.g., 60.7% bonus -> multiplier 1.607)
            const speedMultiplier = 1 + (totalSpeedBonusPercent / 100);
            
            // Calculate reduced time using the multiplier
            // Ensure we don't divide by zero or negative values (though speedMultiplier should always be >= 1)
            const reducedTimeSeconds = speedMultiplier > 0 ? baseTimeSeconds / speedMultiplier : baseTimeSeconds;
            
            // --- Speedups Calculations ---
            // Time after speedups (no bonus)
            const timeAfterSpeedupsNoBonus = Math.max(0, baseTimeSeconds - speedupsSeconds);
            
            // Time after speedups (with bonus)
            const timeAfterSpeedupsWithBonus = Math.max(0, reducedTimeSeconds - speedupsSeconds);
            
            // Number of "instant" upgrades possible (approximation based on average time per step)
            let instantUpgradesNoBonus = 0;
            let instantUpgradesWithBonus = 0;
            if (steps.length > 0) {
                // Calculate average time per step for a rough estimate
                const avgTimePerStepBase = baseTimeSeconds / steps.length;
                const avgTimePerStepReduced = reducedTimeSeconds / steps.length;
                
                if (avgTimePerStepBase > 0) {
                    instantUpgradesNoBonus = Math.floor(speedupsSeconds / avgTimePerStepBase);
                }
                if (avgTimePerStepReduced > 0) {
                    instantUpgradesWithBonus = Math.floor(speedupsSeconds / avgTimePerStepReduced);
                }
            }
            // --- End Speedups Calculations ---
            
            summaryHTML += `<p>Total Construction Time (Base): <span>${formatTime(baseTimeSeconds)}</span></p>`;
            summaryHTML += `<p>Total Construction Time (With Bonus): <span>${formatTime(reducedTimeSeconds)}</span></p>`;
            
            // Add time reduction summary box
            summaryHTML += '<div class="time-reduction-summary">';
            summaryHTML += '<p><strong>Time Reduction Summary:</strong></p>';
            if (timeReductionBonuses.constructionSpeed > 0) {
                summaryHTML += `<p>Construction Speed: <span>+${timeReductionBonuses.constructionSpeed.toFixed(1)}%</span></p>`;
            }
            if (timeReductionBonuses.hyenaPet > 0) {
                summaryHTML += `<p>Hyena Pet: <span>+${timeReductionBonuses.hyenaPet.toFixed(1)}%</span></p>`;
            }
            if (timeReductionBonuses.doubleTimeChief > 0) {
                summaryHTML += `<p>Double Time Chief: <span>+${timeReductionBonuses.doubleTimeChief.toFixed(1)}%</span></p>`;
            }
            if (timeReductionBonuses.vicePresident > 0) {
                summaryHTML += `<p>Vice President: <span>+${timeReductionBonuses.vicePresident.toFixed(1)}%</span></p>`;
            }
            if (timeReductionBonuses.mercantilism > 0) {
                summaryHTML += `<p>Mercantilism: <span>+${timeReductionBonuses.mercantilism.toFixed(1)}%</span></p>`;
            }
            summaryHTML += `<p style="border-top: 1px solid #ccc; margin-top: 5px; padding-top: 5px;"><strong>Total Speed Bonus: <span>+${totalSpeedBonusPercent.toFixed(1)}%</span></strong></p>`;
            summaryHTML += `<p><strong>Speed Multiplier: <span>x${speedMultiplier.toFixed(2)}</span></strong></p>`;
            summaryHTML += `<p><strong>Reduced Time: <span>${formatTime(Math.floor(reducedTimeSeconds))}</span></strong></p>`; // Floor to avoid decimal seconds
            summaryHTML += '</div>';
            // --- End Time Reduction Summary ---
            
            // --- Add Speedups Summary Box ---
            summaryHTML += '<hr />';
            summaryHTML += '<h4>Speedups Impact</h4>';
            summaryHTML += '<div class="time-reduction-summary">';
            summaryHTML += `<p>Speedups Available: <span>${formatTime(speedupsSeconds)}</span></p>`;
            summaryHTML += `<p>Time Remaining (Base): <span>${formatTime(timeAfterSpeedupsNoBonus)}</span></p>`;
            summaryHTML += `<p>Time Remaining (With Bonus): <span>${formatTime(timeAfterSpeedupsWithBonus)}</span></p>`;
            summaryHTML += `<p style="margin-top: 10px;">Approx. Instant Upgrades (Base): <span>${instantUpgradesNoBonus.toLocaleString()}</span></p>`;
            summaryHTML += `<p>Approx. Instant Upgrades (With Bonus): <span>${instantUpgradesWithBonus.toLocaleString()}</span></p>`;
            summaryHTML += '</div>';
            // --- End Speedups Summary Box ---
            
            summaryHTML += `<p style="font-weight: bold; margin-top: 15px;"><i class="fas fa-bolt"></i> Final Building Power: <span>${total.power.toLocaleString()}</span></p>`;

            summaryHTML += '<hr />';
            summaryHTML += '<h4>Resources Needed After Deducting Owned</h4>';
            summaryHTML += `<p>Meat Needed: <span>${final.meat.toLocaleString()}</span></p>`;
            summaryHTML += `<p>Wood Needed: <span>${final.wood.toLocaleString()}</span></p>`;
            summaryHTML += `<p>Coal Needed: <span>${final.coal.toLocaleString()}</span></p>`;
            summaryHTML += `<p>Iron Needed: <span>${final.iron.toLocaleString()}</span></p>`;
            summaryHTML += `<p>Fire Crystals Needed: <span>${final.fire_crystals.toLocaleString()}</span></p>`;
            summaryHTML += `<p>Refined Fire Crystals Needed: <span>${final.refined_fire_crystals.toLocaleString()}</span></p>`;

            // Create the scrollable table container and table with new styling
            let pathHTML = '<div class="results-table-container">'; // Ensure this container handles overflow
            pathHTML += '<table class="results-table">';
            pathHTML += '<thead><tr>';
            pathHTML += '<th class="col-building-name">Building</th>';
            pathHTML += '<th class="col-building-prereq-flag">Type</th>'; // Updated column header
            pathHTML += '<th class="col-level">Level</th>';
            pathHTML += '<th class="col-meat">Meat</th>';
            pathHTML += '<th class="col-wood">Wood</th>';
            pathHTML += '<th class="col-coal">Coal</th>';
            pathHTML += '<th class="col-iron">Iron</th>';
            pathHTML += '<th class="col-fc">Fire Crystals</th>';
            pathHTML += '<th class="col-refined">Refined FC</th>';
            pathHTML += '<th class="col-time">Time</th>';
            pathHTML += '<th class="col-power">Power</th>';
            pathHTML += '<th class="col-prereq">Prerequisites</th>';
            pathHTML += '</tr></thead>';
            pathHTML += '<tbody>';

            steps.forEach(step => {
                // Determine row class and prereq flag based on whether it's a prerequisite or selected upgrade
                const rowClass = step.fromPrereq ? 'prereq-row' : 'selected-row';
                const prereqFlagText = step.fromPrereq ? '(Prereq)' : '';

                pathHTML += `<tr class="${rowClass}">`; // Apply row class
                
                // Building Name cell
                pathHTML += `<td class="col-building-name">${step.building}</td>`;
                
                // Prereq Flag cell
                pathHTML += `<td class="col-building-prereq-flag">${prereqFlagText}</td>`;
                
                pathHTML += `<td class="col-level">${step.level}</td>`;
                pathHTML += `<td class="col-meat">${(step.cost.meat || 0).toLocaleString()}</td>`;
                pathHTML += `<td class="col-wood">${(step.cost.wood || 0).toLocaleString()}</td>`;
                pathHTML += `<td class="col-coal">${(step.cost.coal || 0).toLocaleString()}</td>`;
                pathHTML += `<td class="col-iron">${(step.cost.iron || 0).toLocaleString()}</td>`;
                pathHTML += `<td class="col-fc">${(step.cost.fire_crystals || 0).toLocaleString()}</td>`;
                pathHTML += `<td class="col-refined">${(step.cost.refined_fire_crystals || 0).toLocaleString()}</td>`;
                pathHTML += `<td class="col-time">${step.time}</td>`;
                pathHTML += `<td class="col-power">${(step.power || 0).toLocaleString()}</td>`;
                pathHTML += `<td class="col-prereq">${step.prereq}</td>`;
                pathHTML += '</tr>';
            });

            pathHTML += '</tbody></table></div>';

            summaryDiv.innerHTML = summaryHTML;
            pathDiv.innerHTML = pathHTML;
            resultDiv.classList.add('active');
        }


        // Function to populate building inputs with correctly sorted levels
                // Function to populate building inputs with correctly sorted levels
        function populateBuildingInputs() {
            const container = document.getElementById('building-inputs');
            container.innerHTML = '';

            // Define the order of buildings to display - Include ALL buildings
            const buildingOrder = [
                'furnace', 'embassy', 'command_center', 'infantry_camp',
                'research_center', 'infirmary', 'academy', 'barricade',
                'lancer_camp', 'marksman_camp', 'storehouse'
            ];

            // Populate inputs for each building in the defined order
            buildingOrder.forEach(buildingKey => {
                if (buildingData.hasOwnProperty(buildingKey)) {
                    const building = buildingData[buildingKey];

                    const buildingDiv = document.createElement('div');
                    buildingDiv.className = 'building-block';

                    const header = document.createElement('h4');
                    header.textContent = building.name;
                    buildingDiv.appendChild(header);

                    const levelSelectorDiv = document.createElement('div');
                    levelSelectorDiv.className = 'building-level-selector';

                    const currentLabel = document.createElement('label');
                    currentLabel.textContent = 'Current Level';
                    const currentSelect = document.createElement('select');
                    currentSelect.className = `current-level ${buildingKey}`;
                    currentSelect.innerHTML = '<option value="0">0</option>';

                    // Add options for current levels, sorted correctly using the improved levelToComparable
                    const levelKeys = Object.keys(building.levels)
                        .sort((a, b) => levelToComparable(a) - levelToComparable(b));

                    levelKeys.forEach(level => {
                        const option = document.createElement('option');
                        option.value = level;
                        option.textContent = level;
                        currentSelect.appendChild(option);
                    });

                    const targetLabel = document.createElement('label');
                    targetLabel.textContent = 'Target Level';
                    const targetSelect = document.createElement('select');
                    targetSelect.className = `target-level ${buildingKey}`;
                    targetSelect.innerHTML = '<option value="0">Select Level</option>';

                    // Add options for target levels, sorted correctly using the improved levelToComparable
                    levelKeys.forEach(level => {
                        const option = document.createElement('option');
                        option.value = level;
                        option.textContent = level;
                        targetSelect.appendChild(option);
                    });

                    levelSelectorDiv.appendChild(currentLabel);
                    levelSelectorDiv.appendChild(currentSelect);
                    levelSelectorDiv.appendChild(targetLabel);
                    levelSelectorDiv.appendChild(targetSelect);

                    buildingDiv.appendChild(levelSelectorDiv);
                    container.appendChild(buildingDiv);
                }
            });
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function () {
            // Only populate building inputs if buildingData exists
            if (typeof buildingData !== 'undefined' && buildingData) {
                populateBuildingInputs();

                // Set up calculate button
                document.getElementById('calculate-buildings').addEventListener('click', calculateBuildingCosts);
            } else {
                console.error("buildingData is not defined. Please provide the building data.");
                document.getElementById('building-inputs').innerHTML = '<p style="color: red;">Error: Building data not found. Please ensure the buildingData object is defined.</p>';
            }
        });
    </script>
</body>
</html>
